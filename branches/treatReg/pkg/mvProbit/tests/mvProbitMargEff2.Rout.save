
R version 3.2.2 (2015-08-14) -- "Fire Safety"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # I thank Mohit Batham for providing this R script that demonstrated
> # a bug in mvProbitMargEff() when called with 2 dependent variables
> library( "mvProbit" )
Loading required package: mvtnorm
Loading required package: maxLik
Loading required package: miscTools

Please cite the 'maxLik' package as:
Henningsen, Arne and Toomet, Ott (2011). maxLik: A package for maximum likelihood estimation in R. Computational Statistics 26(3), 443-458. DOI 10.1007/s00180-010-0217-1.

If you have questions, suggestions, or comments regarding the 'maxLik' package, please use a forum or 'tracker' at maxLik's R-Forge site:
https://r-forge.r-project.org/projects/maxlik/
Loading required package: abind
> nObs <- 100
> set.seed( 123 )
> xData <- data.frame(
+   const = rep( 1, nObs ),
+   x1 = as.numeric( rnorm( nObs ) > 0 ),
+   x2 = as.numeric( rnorm( nObs ) > 0 ),
+   x3 = rnorm( nObs ),
+   x4 = rnorm( nObs ))
> beta <- c( 0.8, 1.2, -1.0, 1.4, -0.8,
+   -0.6, 1.0, 0.6, -1.2, -1.6)
> sigma <- symMatrix( c( 1, 0.2, 1))
> margEffCond <- try( mvProbitMargEff( ~ x1 + x2 + x3 + x4 , coef = beta,
+   sigma = sigma, data = xData, cond = TRUE ) )
> round( margEffCond, 3 )
    d_y1_d_x1 d_y2_d_x1 d_y1_d_x2 d_y2_d_x2 d_y1_d_x3 d_y2_d_x3 d_y1_d_x4
1       0.001     0.119     0.000     0.049    -0.001    -0.053    -0.001
2       0.007     0.378    -0.006     0.192     0.029    -0.456    -0.011
3       0.101     0.089    -0.075     0.011     0.033    -0.041    -0.018
4       0.006     0.255    -0.004     0.055     0.001    -0.172    -0.001
5       0.216     0.190    -0.182     0.042     0.116    -0.136    -0.057
6       0.340     0.341    -0.334     0.196     0.305    -0.463    -0.124
7       0.089     0.000    -0.060     0.000     0.024     0.000    -0.014
8       0.366     0.315    -0.359     0.282     0.632    -0.562    -0.235
9       0.003     0.000    -0.021     0.000     0.002     0.000    -0.005
10      0.312     0.022    -0.351     0.002     0.307    -0.012    -0.095
11      0.232     0.033    -0.262     0.100     0.182    -0.104    -0.059
12      0.367     0.237    -0.145     0.196     0.396    -0.485    -0.141
13      0.000     0.201     0.000     0.035     0.000    -0.116     0.000
14      0.229     0.116    -0.185     0.019     0.119    -0.067    -0.062
15      0.360     0.014    -0.298     0.069     0.248    -0.058    -0.131
16      0.011     0.015     0.000     0.013     0.002    -0.049    -0.002
17      0.432     0.130    -0.249     0.095     0.514    -0.104    -0.263
18      0.188     0.008    -0.370     0.008     0.411    -0.032    -0.225
19      0.176     0.213    -0.180     0.303     0.460    -0.509    -0.161
20      0.270     0.303    -0.060     0.295     0.200    -0.583    -0.073
21      0.378     0.187    -0.362     0.287     0.343    -0.469    -0.141
22      0.070     0.011    -0.306     0.005     0.236    -0.003    -0.074
23      0.000     0.304    -0.006     0.209     0.001    -0.469    -0.001
24      0.030     0.060    -0.200     0.029     0.115    -0.023    -0.037
25      0.420     0.059    -0.388     0.155     0.570    -0.186    -0.276
26      0.183     0.181    -0.415     0.129     0.480    -0.135    -0.156
27      0.391     0.081    -0.335     0.063     0.570    -0.059    -0.303
28      0.268     0.254    -0.406     0.225     0.545    -0.314    -0.245
29      0.034     0.003    -0.213     0.001     0.126     0.000    -0.041
30      0.431     0.150    -0.388     0.036     0.486    -0.124    -0.245
31      0.006     0.001     0.001     0.001     0.000    -0.006    -0.002
32      0.228     0.016    -0.214     0.058     0.467    -0.057    -0.249
33      0.198     0.133    -0.027     0.069     0.095    -0.080    -0.049
34      0.365     0.131    -0.380     0.253     0.645    -0.352    -0.218
35      0.374     0.336    -0.365     0.188     0.371    -0.454    -0.152
36      0.444     0.000    -0.176     0.000     0.406     0.000    -0.232
37      0.047     0.031    -0.031     0.002     0.010    -0.009    -0.006
38      0.196     0.334    -0.197     0.242     0.481    -0.538    -0.178
39      0.354     0.183    -0.370     0.047     0.653    -0.162    -0.212
40      0.391     0.185    -0.334     0.171     0.610    -0.442    -0.255
41      0.244     0.233    -0.239     0.303     0.158    -0.543    -0.062
42      0.392     0.234    -0.308     0.203     0.625    -0.245    -0.206
43      0.006     0.000    -0.058     0.000     0.015     0.000    -0.009
44      0.426     0.131    -0.386     0.030     0.538    -0.107    -0.275
45      0.182     0.347    -0.173     0.154     0.102    -0.387    -0.043
46      0.000     0.353     0.000     0.230     0.000    -0.477    -0.001
47      0.173     0.357    -0.402     0.281     0.450    -0.462    -0.158
48      0.278     0.001    -0.212     0.012     0.145    -0.006    -0.082
49      0.438     0.004    -0.166     0.002     0.390    -0.001    -0.222
50      0.025     0.352    -0.176     0.227     0.097    -0.341    -0.034
51      0.327     0.299    -0.390     0.269     0.623    -0.565    -0.234
52      0.236     0.000    -0.218     0.000     0.464     0.000    -0.265
53      0.423     0.079    -0.394     0.185     0.570    -0.238    -0.267
54      0.114     0.343    -0.116     0.232     0.055    -0.489    -0.021
55      0.000     0.326    -0.001     0.175     0.000    -0.265    -0.001
56      0.196     0.321    -0.202     0.250     0.126    -0.503    -0.047
57      0.064     0.143    -0.065     0.023     0.219    -0.083    -0.071
58      0.017     0.282    -0.019     0.241     0.004    -0.459    -0.002
59      0.051     0.000    -0.002     0.000     0.011     0.000    -0.006
60      0.035     0.068    -0.035     0.195     0.133    -0.224    -0.043
61      0.434     0.089    -0.257     0.064     0.518    -0.063    -0.274
62      0.372     0.311    -0.348     0.269     0.643    -0.393    -0.219
63      0.143     0.313    -0.388     0.231     0.399    -0.318    -0.135
64      0.059     0.013    -0.059     0.001     0.205    -0.004    -0.065
65      0.002     0.000     0.001     0.000    -0.003     0.000    -0.004
66      0.005     0.236     0.000     0.170     0.000    -0.418    -0.001
67      0.413     0.322    -0.225     0.253     0.509    -0.437    -0.212
68      0.433     0.000    -0.376     0.000     0.534     0.000    -0.305
69      0.343     0.318    -0.378     0.281     0.623    -0.541    -0.243
70      0.286     0.175    -0.059     0.103     0.183    -0.128    -0.091
71      0.102     0.000    -0.357     0.000     0.316     0.000    -0.098
72      0.006     0.061    -0.006     0.120     0.025    -0.160    -0.012
73      0.008     0.375    -0.008     0.197     0.001    -0.455    -0.001
74      0.053     0.123    -0.047     0.261     0.015    -0.362    -0.006
75      0.015     0.068    -0.132     0.032     0.061    -0.027    -0.021
76      0.205     0.136    -0.166     0.024     0.101    -0.083    -0.052
77      0.169     0.063    -0.163     0.140     0.400    -0.182    -0.193
78      0.364     0.325    -0.367     0.250     0.634    -0.557    -0.233
79      0.217     0.353    -0.039     0.239     0.138    -0.438    -0.056
80      0.011     0.012    -0.091     0.010     0.043    -0.040    -0.023
81      0.298     0.033    -0.274     0.004     0.530    -0.020    -0.293
82      0.133     0.298    -0.017     0.215     0.071    -0.487    -0.026
83      0.052     0.272    -0.262     0.173     0.183    -0.218    -0.061
84      0.088     0.065    -0.064     0.007     0.026    -0.027    -0.014
85      0.141     0.235    -0.389     0.165     0.399    -0.194    -0.131
86      0.236     0.025    -0.266     0.082     0.186    -0.080    -0.061
87      0.348     0.318    -0.118     0.247     0.337    -0.525    -0.128
88      0.001     0.362     0.000     0.204     0.000    -0.334     0.000
89      0.394     0.103    -0.373     0.209     0.596    -0.289    -0.272
90      0.113     0.267    -0.121     0.255     0.057    -0.464    -0.021
91      0.014     0.376     0.000     0.224     0.003    -0.393    -0.001
92      0.000     0.051     0.000     0.004     0.000    -0.017     0.000
93      0.082     0.034    -0.008     0.029     0.038    -0.101    -0.013
94      0.214     0.057    -0.386     0.052     0.463    -0.170    -0.226
95      0.001     0.120     0.000     0.175    -0.001    -0.266    -0.001
96      0.387     0.077    -0.420     0.013     0.491    -0.055    -0.155
97      0.001     0.341     0.000     0.226     0.000    -0.479     0.000
98      0.257     0.280    -0.251     0.134     0.539    -0.375    -0.234
99      0.029     0.071    -0.167     0.060     0.101    -0.185    -0.048
100     0.001     0.234    -0.014     0.116     0.002    -0.149    -0.002
    d_y2_d_x4
1      -0.071
2      -0.594
3      -0.053
4      -0.229
5      -0.169
6      -0.548
7       0.000
8      -0.603
9       0.000
10     -0.012
11     -0.126
12     -0.562
13     -0.155
14     -0.084
15     -0.059
16     -0.065
17     -0.116
18     -0.036
19     -0.526
20     -0.591
21     -0.480
22     -0.003
23     -0.624
24     -0.029
25     -0.197
26     -0.153
27     -0.064
28     -0.330
29     -0.001
30     -0.139
31     -0.008
32     -0.064
33     -0.100
34     -0.379
35     -0.529
36      0.000
37     -0.012
38     -0.610
39     -0.173
40     -0.472
41     -0.549
42     -0.258
43      0.000
44     -0.118
45     -0.487
46     -0.636
47     -0.528
48     -0.006
49     -0.002
50     -0.429
51     -0.602
52      0.000
53     -0.251
54     -0.629
55     -0.353
56     -0.628
57     -0.100
58     -0.609
59      0.000
60     -0.226
61     -0.069
62     -0.419
63     -0.367
64     -0.004
65      0.000
66     -0.557
67     -0.491
68      0.000
69     -0.578
70     -0.156
71      0.000
72     -0.209
73     -0.606
74     -0.360
75     -0.034
76     -0.103
77     -0.209
78     -0.598
79     -0.544
80     -0.051
81     -0.021
82     -0.622
83     -0.266
84     -0.035
85     -0.223
86     -0.097
87     -0.617
88     -0.446
89     -0.309
90     -0.596
91     -0.522
92     -0.022
93     -0.130
94     -0.192
95     -0.354
96     -0.057
97     -0.638
98     -0.393
99     -0.233
100    -0.197
> 
> proc.time()
   user  system elapsed 
  1.668   0.124   1.790 
