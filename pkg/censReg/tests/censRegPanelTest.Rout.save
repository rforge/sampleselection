
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library( "censReg" )
Loading required package: maxLik
Loading required package: miscTools

Please cite the 'maxLik' package as:
Henningsen, Arne and Toomet, Ott (2011). maxLik: A package for maximum likelihood estimation in R. Computational Statistics 26(3), 443-458. DOI 10.1007/s00180-010-0217-1.

If you have questions, suggestions, or comments regarding the 'maxLik' package, please use a forum or 'tracker' at maxLik's R-Forge site:
https://r-forge.r-project.org/projects/maxlik/
> library( "plm" )
Loading required package: Formula
> 
> # load outputs that were previously produced by this script 
> saved <- new.env()
> load( "censRegPanelTest.RData.save", envir = saved )
> 
> options( digits = 5 )
> 
> printAll <- function( objName, what = "methods" ) {
+    cat( "Comparing new object '", objName, "' to previously saved object...",
+       sep = "" )
+    x <- get( objName )
+    if( !exists( objName, envir = saved ) ) {
+       cat( "' not found\n" )
+    } else {
+       xSaved <- get( objName, envir = saved )
+       if( !isTRUE( all.equal( class( x ), class( xSaved ) ) ) ) {
+          cat( " different classes:\n" )
+          cat( "new:\n" )
+          print( class( x ) )
+          cat( "saved:\n" )
+          print( class( xSaved ) )
+       } else if( !isTRUE( all.equal( names( x ), names( xSaved ) ) ) ) {
+          cat( " different names:\n" )
+          cat( "new:\n" )
+          print( names( x ) )
+          cat( "saved:\n" )
+          print( names( xSaved ) )
+       } else {
+          cat( "\n" )
+       }
+       for( n in names( x ) ) {
+          if( ! n %in% c( "code", "gradient", "iterations", "last.step",
+                "message" ) ) {
+             cat( "   comparing component '", n, "' ...", sep = "" )
+             testRes <-  all.equal( x[[ n ]], xSaved[[ n ]], tol = 5e-3 )
+             if( isTRUE( testRes ) ) {
+                cat( " OK\n" )
+             } else {
+                cat( " different\n" )
+                print( testRes )
+                cat( "new:\n" )
+                print( x[[ n ]] )
+                cat( "saved:\n" )
+                print( xSaved[[ n ]] )
+             }
+          }
+       }
+    }
+    
+    if( what %in% c( "methods", "all" ) ) {
+       print( x, digits = 1 )
+       print( x, logSigma = FALSE , digits = 1 )
+       print( maxLik:::summary.maxLik( x ), digits = 1 )
+       print( summary( x ), digits = 1 )
+       print( summary( x ), logSigma = FALSE , digits = 1 )
+       print( round( coef( x ), 2 ) )
+       print( round( coef( x, logSigma = FALSE ), 2 ) )
+       print( round( vcov( x ), 2 ) )
+       print( round( vcov( x, logSigma = FALSE ), 2 ) )
+       print( round( coef( summary( x ) ), 2 ) )
+       print( round( coef( summary( x ), logSigma = FALSE ), 2 ) )
+       try( margEff( x ) )
+       print( logLik( x ) )
+       print( nobs( x ) )
+       print( extractAIC( x ) )
+    }
+    
+    if( what == "all" ) {
+       for( n in names( x ) ) {
+          cat( "$", n, "\n", sep = "" )
+          if( n %in% c( "estimate", "gradientObs" ) ) {
+             print( round( x[[ n ]], 2 ) )
+          } else if( n %in% c( "hessian" ) ) {
+             print( round( x[[ n ]], 1 ) )
+          } else if( n %in% c( "gradient" ) ) {
+          } else if( ! n %in% c( "last.step" ) ) {
+             print( x[[ n ]] )
+          }
+          cat( "\n" )
+       }
+       cat( "class\n" )
+       print( class( x ) )
+    }
+ }
> 
> nId <- 15
> nTime <- 4
> 
> set.seed( 123 )
> pData <- data.frame(
+    id = rep( paste( "F", 1:nId, sep = "_" ), each = nTime ),
+    time = rep( 1980 + 1:nTime, nId ) )
> pData$ui <- rep( rnorm( nId ), each = nTime )
> pData$x1 <- rnorm( nId * nTime )
> pData$x2 <- runif( nId * nTime )
> pData$ys <- -1 + pData$ui + 2 * pData$x1 + 3 * pData$x2 + rnorm( nId * nTime )
> pData$y <- ifelse( pData$ys > 0, pData$ys, 0 )
> nData <- pData # save data set without information on panel structure
> pData <- pdata.frame( pData, c( "id", "time" ) )
> 
> 
> ## Newton-Raphson method
> randEff <- censReg( y ~ x1 + x2, data = pData )
> printAll( "randEff" )
Comparing new object 'randEff' to previously saved object...
   comparing component 'maximum' ... OK
   comparing component 'estimate' ... OK
   comparing component 'hessian' ... OK
   comparing component 'fixed' ... OK
   comparing component 'type' ... OK
   comparing component 'gradientObs' ... OK
   comparing component 'control' ... OK
   comparing component 'xMean' ... OK
   comparing component 'call' ... OK
   comparing component 'terms' ... OK
   comparing component 'nObs' ... OK
   comparing component 'df.residual' ... OK
   comparing component 'start' ... OK
   comparing component 'left' ... OK
   comparing component 'right' ... OK

Call:
censReg(formula = y ~ x1 + x2, data = pData)

Coefficients:
(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
      -0.37        1.68        2.24       -0.13       -0.01 


Call:
censReg(formula = y ~ x1 + x2, data = pData)

Coefficients:
(Intercept)          x1          x2     sigmaMu     sigmaNu 
       -0.4         1.7         2.2         0.9         1.0 

--------------------------------------------
Maximum Likelihood estimation
Newton-Raphson maximisation, 5 iterations
Return code 1: gradient close to zero
Log-Likelihood: -73.199 
5  free parameters
Estimates:
            Estimate Std. error t value Pr(> t)    
(Intercept)    -0.37       0.47    -0.8     0.4    
x1              1.68       0.21     8.0   1e-15 ***
x2              2.24       0.67     3.3   9e-04 ***
logSigmaMu     -0.13       0.26    -0.5     0.6    
logSigmaNu     -0.01       0.13    -0.1     0.9    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
--------------------------------------------

Call:
censReg(formula = y ~ x1 + x2, data = pData)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60             20             40              0 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)    -0.37       0.47    -0.8     0.4    
x1              1.68       0.21     8.0   1e-15 ***
x2              2.24       0.67     3.3   9e-04 ***
logSigmaMu     -0.13       0.26    -0.5     0.6    
logSigmaNu     -0.01       0.13    -0.1     0.9    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 5 iterations
Return code 1: gradient close to zero
Log-likelihood: -73.199 on 5 Df


Call:
censReg(formula = y ~ x1 + x2, data = pData)

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60             20             40              0 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)     -0.4        0.5    -0.8     0.4    
x1               1.7        0.2     8.0   1e-15 ***
x2               2.2        0.7     3.3   9e-04 ***
sigmaMu          0.9        0.2     3.9   1e-04 ***
sigmaNu          1.0        0.1     7.7   1e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 5 iterations
Return code 1: gradient close to zero
Log-likelihood: -73.199 on 5 Df

(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
      -0.37        1.68        2.24       -0.13       -0.01 
(Intercept)          x1          x2     sigmaMu     sigmaNu 
      -0.37        1.68        2.24        0.88        0.99 
            (Intercept)    x1    x2 logSigmaMu logSigmaNu
(Intercept)        0.23 -0.02 -0.25      -0.02       0.00
x1                -0.02  0.04  0.01       0.01       0.00
x2                -0.25  0.01  0.45       0.02       0.00
logSigmaMu        -0.02  0.01  0.02       0.07       0.00
logSigmaNu         0.00  0.00  0.00       0.00       0.02
            (Intercept)    x1    x2 sigmaMu sigmaNu
(Intercept)        0.23 -0.02 -0.25   -0.02    0.00
x1                -0.02  0.04  0.01    0.01    0.00
x2                -0.25  0.01  0.45    0.02    0.00
sigmaMu           -0.02  0.01  0.02    0.05    0.00
sigmaNu            0.00  0.00  0.00    0.00    0.02
            Estimate Std. error t value Pr(> t)
(Intercept)    -0.37       0.47   -0.77    0.44
x1              1.68       0.21    8.03    0.00
x2              2.24       0.67    3.32    0.00
logSigmaMu     -0.13       0.26   -0.50    0.62
logSigmaNu     -0.01       0.13   -0.10    0.92
            Estimate Std. error t value Pr(> t)
(Intercept)    -0.37       0.47   -0.77    0.44
x1              1.68       0.21    8.03    0.00
x2              2.24       0.67    3.32    0.00
sigmaMu         0.88       0.23    3.87    0.00
sigmaNu         0.99       0.13    7.71    0.00
Error in margEff.censReg(x) : 
  the margEff() method for objects of class 'censReg' can not yet be used for panel data models
'log Lik.' -73.199 (df=5)
[1] 60
[1] -40.0 156.4
> 
> 
> ## BHHH method
> randEffBhhh <- censReg( y ~ x1 + x2, data = pData, method = "BHHH" )
> printAll( "randEffBhhh" )
Comparing new object 'randEffBhhh' to previously saved object...
   comparing component 'maximum' ... OK
   comparing component 'estimate' ... OK
   comparing component 'hessian' ... OK
   comparing component 'fixed' ... OK
   comparing component 'type' ... OK
   comparing component 'gradientObs' ... OK
   comparing component 'control' ... OK
   comparing component 'xMean' ... OK
   comparing component 'call' ... OK
   comparing component 'terms' ... OK
   comparing component 'nObs' ... OK
   comparing component 'df.residual' ... OK
   comparing component 'start' ... OK
   comparing component 'left' ... OK
   comparing component 'right' ... OK

Call:
censReg(formula = y ~ x1 + x2, data = pData, method = "BHHH")

Coefficients:
(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
      -0.37        1.68        2.24       -0.13       -0.01 


Call:
censReg(formula = y ~ x1 + x2, data = pData, method = "BHHH")

Coefficients:
(Intercept)          x1          x2     sigmaMu     sigmaNu 
       -0.4         1.7         2.2         0.9         1.0 

--------------------------------------------
Maximum Likelihood estimation
BHHH maximisation, 14 iterations
Return code 2: successive function values within tolerance limit
Log-Likelihood: -73.199 
5  free parameters
Estimates:
            Estimate Std. error t value Pr(> t)    
(Intercept)    -0.37       0.56    -0.7   0.510    
x1              1.68       0.29     5.7   1e-08 ***
x2              2.24       0.73     3.1   0.002 ** 
logSigmaMu     -0.13       0.29    -0.4   0.660    
logSigmaNu     -0.01       0.14    -0.1   0.930    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
--------------------------------------------

Call:
censReg(formula = y ~ x1 + x2, data = pData, method = "BHHH")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60             20             40              0 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)    -0.37       0.56    -0.7   0.510    
x1              1.68       0.29     5.7   1e-08 ***
x2              2.24       0.73     3.1   0.002 ** 
logSigmaMu     -0.13       0.29    -0.4   0.660    
logSigmaNu     -0.01       0.14    -0.1   0.930    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BHHH maximisation, 14 iterations
Return code 2: successive function values within tolerance limit
Log-likelihood: -73.199 on 5 Df


Call:
censReg(formula = y ~ x1 + x2, data = pData, method = "BHHH")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60             20             40              0 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)     -0.4        0.6    -0.7   0.510    
x1               1.7        0.3     5.7   1e-08 ***
x2               2.2        0.7     3.1   0.002 ** 
sigmaMu          0.9        0.3     3.4   7e-04 ***
sigmaNu          1.0        0.1     7.1   1e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BHHH maximisation, 14 iterations
Return code 2: successive function values within tolerance limit
Log-likelihood: -73.199 on 5 Df

(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
      -0.37        1.68        2.24       -0.13       -0.01 
(Intercept)          x1          x2     sigmaMu     sigmaNu 
      -0.37        1.68        2.24        0.88        0.99 
            (Intercept)    x1    x2 logSigmaMu logSigmaNu
(Intercept)        0.31 -0.03 -0.35       0.06      -0.01
x1                -0.03  0.09  0.02       0.00       0.02
x2                -0.35  0.02  0.53      -0.08       0.02
logSigmaMu         0.06  0.00 -0.08       0.09       0.00
logSigmaNu        -0.01  0.02  0.02       0.00       0.02
            (Intercept)    x1    x2 sigmaMu sigmaNu
(Intercept)        0.31 -0.03 -0.35    0.06   -0.01
x1                -0.03  0.09  0.02    0.00    0.02
x2                -0.35  0.02  0.53   -0.07    0.02
sigmaMu            0.06  0.00 -0.07    0.07    0.00
sigmaNu           -0.01  0.02  0.02    0.00    0.02
            Estimate Std. error t value Pr(> t)
(Intercept)    -0.37       0.56   -0.66    0.51
x1              1.68       0.29    5.72    0.00
x2              2.24       0.73    3.07    0.00
logSigmaMu     -0.13       0.29   -0.44    0.66
logSigmaNu     -0.01       0.14   -0.09    0.93
            Estimate Std. error t value Pr(> t)
(Intercept)    -0.37       0.56   -0.66    0.51
x1              1.68       0.29    5.72    0.00
x2              2.24       0.73    3.07    0.00
sigmaMu         0.88       0.26    3.39    0.00
sigmaNu         0.99       0.14    7.14    0.00
Error in margEff.censReg(x) : 
  the margEff() method for objects of class 'censReg' can not yet be used for panel data models
'log Lik.' -73.199 (df=5)
[1] 60
[1] -40.0 156.4
> 
> 
> ## BFGS method (optim)
> randEffBfgs <- censReg( y ~ x1 + x2, data = pData, method = "BFGS" )
> printAll( "randEffBfgs" )
Comparing new object 'randEffBfgs' to previously saved object...
   comparing component 'maximum' ... OK
   comparing component 'estimate' ... OK
   comparing component 'hessian' ... OK
   comparing component 'fixed' ... OK
   comparing component 'type' ... OK
   comparing component 'constraints' ... OK
   comparing component 'gradientObs' ... OK
   comparing component 'control' ... OK
   comparing component 'xMean' ... OK
   comparing component 'call' ... OK
   comparing component 'terms' ... OK
   comparing component 'nObs' ... OK
   comparing component 'df.residual' ... OK
   comparing component 'start' ... OK
   comparing component 'left' ... OK
   comparing component 'right' ... OK

Call:
censReg(formula = y ~ x1 + x2, data = pData, method = "BFGS")

Coefficients:
(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
      -0.37        1.68        2.24       -0.13       -0.01 


Call:
censReg(formula = y ~ x1 + x2, data = pData, method = "BFGS")

Coefficients:
(Intercept)          x1          x2     sigmaMu     sigmaNu 
       -0.4         1.7         2.2         0.9         1.0 

--------------------------------------------
Maximum Likelihood estimation
BFGS maximization, 25 iterations
Return code 0: successful convergence 
Log-Likelihood: -73.199 
5  free parameters
Estimates:
            Estimate Std. error t value Pr(> t)    
(Intercept)    -0.37       0.47    -0.8     0.4    
x1              1.68       0.21     8.0   1e-15 ***
x2              2.24       0.67     3.3   9e-04 ***
logSigmaMu     -0.13       0.26    -0.5     0.6    
logSigmaNu     -0.01       0.13    -0.1     0.9    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
--------------------------------------------

Call:
censReg(formula = y ~ x1 + x2, data = pData, method = "BFGS")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60             20             40              0 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)    -0.37       0.47    -0.8     0.4    
x1              1.68       0.21     8.0   1e-15 ***
x2              2.24       0.67     3.3   9e-04 ***
logSigmaMu     -0.13       0.26    -0.5     0.6    
logSigmaNu     -0.01       0.13    -0.1     0.9    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BFGS maximization, 25 iterations
Return code 0: successful convergence 
Log-likelihood: -73.199 on 5 Df


Call:
censReg(formula = y ~ x1 + x2, data = pData, method = "BFGS")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60             20             40              0 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)     -0.4        0.5    -0.8     0.4    
x1               1.7        0.2     8.0   1e-15 ***
x2               2.2        0.7     3.3   9e-04 ***
sigmaMu          0.9        0.2     3.9   1e-04 ***
sigmaNu          1.0        0.1     7.7   1e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BFGS maximization, 25 iterations
Return code 0: successful convergence 
Log-likelihood: -73.199 on 5 Df

(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
      -0.37        1.68        2.24       -0.13       -0.01 
(Intercept)          x1          x2     sigmaMu     sigmaNu 
      -0.37        1.68        2.24        0.88        0.99 
            (Intercept)    x1    x2 logSigmaMu logSigmaNu
(Intercept)        0.23 -0.02 -0.25      -0.02       0.00
x1                -0.02  0.04  0.01       0.01       0.00
x2                -0.25  0.01  0.45       0.02       0.00
logSigmaMu        -0.02  0.01  0.02       0.07       0.00
logSigmaNu         0.00  0.00  0.00       0.00       0.02
            (Intercept)    x1    x2 sigmaMu sigmaNu
(Intercept)        0.23 -0.02 -0.25   -0.02    0.00
x1                -0.02  0.04  0.01    0.01    0.00
x2                -0.25  0.01  0.45    0.02    0.00
sigmaMu           -0.02  0.01  0.02    0.05    0.00
sigmaNu            0.00  0.00  0.00    0.00    0.02
            Estimate Std. error t value Pr(> t)
(Intercept)    -0.37       0.47   -0.77    0.44
x1              1.68       0.21    8.03    0.00
x2              2.24       0.67    3.32    0.00
logSigmaMu     -0.13       0.26   -0.50    0.62
logSigmaNu     -0.01       0.13   -0.10    0.92
            Estimate Std. error t value Pr(> t)
(Intercept)    -0.37       0.47   -0.77    0.44
x1              1.68       0.21    8.03    0.00
x2              2.24       0.67    3.32    0.00
sigmaMu         0.88       0.23    3.87    0.00
sigmaNu         0.99       0.13    7.71    0.00
Error in margEff.censReg(x) : 
  the margEff() method for objects of class 'censReg' can not yet be used for panel data models
'log Lik.' -73.199 (df=5)
[1] 60
[1] -40.0 156.4
> 
> 
> ## BFGS method (R)
> randEffBfgsr <- censReg( y ~ x1 + x2, data = pData, method = "BFGSR" )
> printAll( "randEffBfgsr" )
Comparing new object 'randEffBfgsr' to previously saved object...
   comparing component 'maximum' ... OK
   comparing component 'estimate' ... OK
   comparing component 'hessian' ... OK
   comparing component 'fixed' ... OK
   comparing component 'type' ... OK
   comparing component 'gradientObs' ... OK
   comparing component 'control' ... OK
   comparing component 'xMean' ... OK
   comparing component 'call' ... OK
   comparing component 'terms' ... OK
   comparing component 'nObs' ... OK
   comparing component 'df.residual' ... OK
   comparing component 'start' ... OK
   comparing component 'left' ... OK
   comparing component 'right' ... OK

Call:
censReg(formula = y ~ x1 + x2, data = pData, method = "BFGSR")

Coefficients:
(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
      -0.37        1.68        2.25       -0.13       -0.01 


Call:
censReg(formula = y ~ x1 + x2, data = pData, method = "BFGSR")

Coefficients:
(Intercept)          x1          x2     sigmaMu     sigmaNu 
       -0.4         1.7         2.2         0.9         1.0 

--------------------------------------------
Maximum Likelihood estimation
BFGSR maximization, 77 iterations
Return code 2: successive function values within tolerance limit
Log-Likelihood: -73.199 
5  free parameters
Estimates:
            Estimate Std. error t value Pr(> t)    
(Intercept)    -0.37       0.47    -0.8     0.4    
x1              1.68       0.21     8.0   1e-15 ***
x2              2.25       0.67     3.3   9e-04 ***
logSigmaMu     -0.13       0.26    -0.5     0.6    
logSigmaNu     -0.01       0.13    -0.1     0.9    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
--------------------------------------------

Call:
censReg(formula = y ~ x1 + x2, data = pData, method = "BFGSR")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60             20             40              0 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)    -0.37       0.47    -0.8     0.4    
x1              1.68       0.21     8.0   1e-15 ***
x2              2.25       0.67     3.3   9e-04 ***
logSigmaMu     -0.13       0.26    -0.5     0.6    
logSigmaNu     -0.01       0.13    -0.1     0.9    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BFGSR maximization, 77 iterations
Return code 2: successive function values within tolerance limit
Log-likelihood: -73.199 on 5 Df


Call:
censReg(formula = y ~ x1 + x2, data = pData, method = "BFGSR")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60             20             40              0 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)     -0.4        0.5    -0.8     0.4    
x1               1.7        0.2     8.0   1e-15 ***
x2               2.2        0.7     3.3   9e-04 ***
sigmaMu          0.9        0.2     3.9   1e-04 ***
sigmaNu          1.0        0.1     7.7   1e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BFGSR maximization, 77 iterations
Return code 2: successive function values within tolerance limit
Log-likelihood: -73.199 on 5 Df

(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
      -0.37        1.68        2.25       -0.13       -0.01 
(Intercept)          x1          x2     sigmaMu     sigmaNu 
      -0.37        1.68        2.25        0.88        0.99 
            (Intercept)    x1    x2 logSigmaMu logSigmaNu
(Intercept)        0.23 -0.02 -0.25      -0.02       0.00
x1                -0.02  0.04  0.01       0.01       0.00
x2                -0.25  0.01  0.45       0.02       0.00
logSigmaMu        -0.02  0.01  0.02       0.07       0.00
logSigmaNu         0.00  0.00  0.00       0.00       0.02
            (Intercept)    x1    x2 sigmaMu sigmaNu
(Intercept)        0.23 -0.02 -0.25   -0.02    0.00
x1                -0.02  0.04  0.01    0.01    0.00
x2                -0.25  0.01  0.45    0.02    0.00
sigmaMu           -0.02  0.01  0.02    0.05    0.00
sigmaNu            0.00  0.00  0.00    0.00    0.02
            Estimate Std. error t value Pr(> t)
(Intercept)    -0.37       0.47   -0.78    0.44
x1              1.68       0.21    8.03    0.00
x2              2.25       0.67    3.33    0.00
logSigmaMu     -0.13       0.26   -0.50    0.62
logSigmaNu     -0.01       0.13   -0.10    0.92
            Estimate Std. error t value Pr(> t)
(Intercept)    -0.37       0.47   -0.78    0.44
x1              1.68       0.21    8.03    0.00
x2              2.25       0.67    3.33    0.00
sigmaMu         0.88       0.23    3.88    0.00
sigmaNu         0.99       0.13    7.71    0.00
Error in margEff.censReg(x) : 
  the margEff() method for objects of class 'censReg' can not yet be used for panel data models
'log Lik.' -73.199 (df=5)
[1] 60
[1] -40.0 156.4
> 
> 
> ## BHHH with starting values
> randEffBhhhStart <- censReg( y ~ x1 + x2, data = pData, method = "BHHH",
+    start = c( -0.4, 1.7, 2.2, -0.1, -0.01 ) )
> printAll( "randEffBhhhStart" )
Comparing new object 'randEffBhhhStart' to previously saved object...
   comparing component 'maximum' ... OK
   comparing component 'estimate' ... OK
   comparing component 'hessian' ... OK
   comparing component 'fixed' ... OK
   comparing component 'type' ... OK
   comparing component 'gradientObs' ... OK
   comparing component 'control' ... OK
   comparing component 'xMean' ... OK
   comparing component 'call' ... OK
   comparing component 'terms' ... OK
   comparing component 'nObs' ... OK
   comparing component 'df.residual' ... OK
   comparing component 'start' ... OK
   comparing component 'left' ... OK
   comparing component 'right' ... OK

Call:
censReg(formula = y ~ x1 + x2, data = pData, start = c(-0.4, 
    1.7, 2.2, -0.1, -0.01), method = "BHHH")

Coefficients:
(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
      -0.37        1.68        2.24       -0.13       -0.01 


Call:
censReg(formula = y ~ x1 + x2, data = pData, start = c(-0.4, 
    1.7, 2.2, -0.1, -0.01), method = "BHHH")

Coefficients:
(Intercept)          x1          x2     sigmaMu     sigmaNu 
       -0.4         1.7         2.2         0.9         1.0 

--------------------------------------------
Maximum Likelihood estimation
BHHH maximisation, 7 iterations
Return code 2: successive function values within tolerance limit
Log-Likelihood: -73.199 
5  free parameters
Estimates:
            Estimate Std. error t value Pr(> t)    
(Intercept)    -0.37       0.56    -0.7   0.510    
x1              1.68       0.29     5.7   1e-08 ***
x2              2.24       0.73     3.1   0.002 ** 
logSigmaMu     -0.13       0.30    -0.4   0.661    
logSigmaNu     -0.01       0.14    -0.1   0.929    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
--------------------------------------------

Call:
censReg(formula = y ~ x1 + x2, data = pData, start = c(-0.4, 
    1.7, 2.2, -0.1, -0.01), method = "BHHH")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60             20             40              0 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)    -0.37       0.56    -0.7   0.510    
x1              1.68       0.29     5.7   1e-08 ***
x2              2.24       0.73     3.1   0.002 ** 
logSigmaMu     -0.13       0.30    -0.4   0.661    
logSigmaNu     -0.01       0.14    -0.1   0.929    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BHHH maximisation, 7 iterations
Return code 2: successive function values within tolerance limit
Log-likelihood: -73.199 on 5 Df


Call:
censReg(formula = y ~ x1 + x2, data = pData, start = c(-0.4, 
    1.7, 2.2, -0.1, -0.01), method = "BHHH")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60             20             40              0 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)     -0.4        0.6    -0.7   0.510    
x1               1.7        0.3     5.7   1e-08 ***
x2               2.2        0.7     3.1   0.002 ** 
sigmaMu          0.9        0.3     3.4   7e-04 ***
sigmaNu          1.0        0.1     7.1   1e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BHHH maximisation, 7 iterations
Return code 2: successive function values within tolerance limit
Log-likelihood: -73.199 on 5 Df

(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
      -0.37        1.68        2.24       -0.13       -0.01 
(Intercept)          x1          x2     sigmaMu     sigmaNu 
      -0.37        1.68        2.24        0.88        0.99 
            (Intercept)    x1    x2 logSigmaMu logSigmaNu
(Intercept)        0.31 -0.03 -0.35       0.06      -0.01
x1                -0.03  0.09  0.02       0.00       0.02
x2                -0.35  0.02  0.53      -0.08       0.02
logSigmaMu         0.06  0.00 -0.08       0.09       0.00
logSigmaNu        -0.01  0.02  0.02       0.00       0.02
            (Intercept)    x1    x2 sigmaMu sigmaNu
(Intercept)        0.31 -0.03 -0.35    0.06   -0.01
x1                -0.03  0.09  0.02    0.00    0.02
x2                -0.35  0.02  0.53   -0.07    0.02
sigmaMu            0.06  0.00 -0.07    0.07    0.00
sigmaNu           -0.01  0.02  0.02    0.00    0.02
            Estimate Std. error t value Pr(> t)
(Intercept)    -0.37       0.56   -0.66    0.51
x1              1.68       0.29    5.72    0.00
x2              2.24       0.73    3.07    0.00
logSigmaMu     -0.13       0.30   -0.44    0.66
logSigmaNu     -0.01       0.14   -0.09    0.93
            Estimate Std. error t value Pr(> t)
(Intercept)    -0.37       0.56   -0.66    0.51
x1              1.68       0.29    5.72    0.00
x2              2.24       0.73    3.07    0.00
sigmaMu         0.88       0.26    3.39    0.00
sigmaNu         0.99       0.14    7.14    0.00
Error in margEff.censReg(x) : 
  the margEff() method for objects of class 'censReg' can not yet be used for panel data models
'log Lik.' -73.199 (df=5)
[1] 60
[1] -40.0 156.4
> 
> 
> ## left-censoring at 5
> pData$yAdd <- pData$y + 5
> randEffAdd <- censReg( yAdd ~ x1 + x2, data = pData, method = "BFGSR", left = 5 )
> printAll( "randEffAdd" )
Comparing new object 'randEffAdd' to previously saved object...
   comparing component 'maximum' ... OK
   comparing component 'estimate' ... OK
   comparing component 'hessian' ... OK
   comparing component 'fixed' ... OK
   comparing component 'type' ... OK
   comparing component 'gradientObs' ... OK
   comparing component 'control' ... OK
   comparing component 'xMean' ... OK
   comparing component 'call' ... OK
   comparing component 'terms' ... OK
   comparing component 'nObs' ... OK
   comparing component 'df.residual' ... OK
   comparing component 'start' ... OK
   comparing component 'left' ... OK
   comparing component 'right' ... OK

Call:
censReg(formula = yAdd ~ x1 + x2, left = 5, data = pData, method = "BFGSR")

Coefficients:
(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
       4.63        1.68        2.25       -0.13       -0.01 


Call:
censReg(formula = yAdd ~ x1 + x2, left = 5, data = pData, method = "BFGSR")

Coefficients:
(Intercept)          x1          x2     sigmaMu     sigmaNu 
        4.6         1.7         2.2         0.9         1.0 

--------------------------------------------
Maximum Likelihood estimation
BFGSR maximization, 76 iterations
Return code 2: successive function values within tolerance limit
Log-Likelihood: -73.199 
5  free parameters
Estimates:
            Estimate Std. error t value Pr(> t)    
(Intercept)     4.63       0.47     9.7  <2e-16 ***
x1              1.68       0.21     8.0   1e-15 ***
x2              2.25       0.67     3.3   9e-04 ***
logSigmaMu     -0.13       0.26    -0.5     0.6    
logSigmaNu     -0.01       0.13    -0.1     0.9    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
--------------------------------------------

Call:
censReg(formula = yAdd ~ x1 + x2, left = 5, data = pData, method = "BFGSR")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60             20             40              0 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)     4.63       0.47     9.7  <2e-16 ***
x1              1.68       0.21     8.0   1e-15 ***
x2              2.25       0.67     3.3   9e-04 ***
logSigmaMu     -0.13       0.26    -0.5     0.6    
logSigmaNu     -0.01       0.13    -0.1     0.9    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BFGSR maximization, 76 iterations
Return code 2: successive function values within tolerance limit
Log-likelihood: -73.199 on 5 Df


Call:
censReg(formula = yAdd ~ x1 + x2, left = 5, data = pData, method = "BFGSR")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60             20             40              0 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)      4.6        0.5      10  <2e-16 ***
x1               1.7        0.2       8   1e-15 ***
x2               2.2        0.7       3   9e-04 ***
sigmaMu          0.9        0.2       4   1e-04 ***
sigmaNu          1.0        0.1       8   1e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BFGSR maximization, 76 iterations
Return code 2: successive function values within tolerance limit
Log-likelihood: -73.199 on 5 Df

(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
       4.63        1.68        2.25       -0.13       -0.01 
(Intercept)          x1          x2     sigmaMu     sigmaNu 
       4.63        1.68        2.25        0.88        0.99 
            (Intercept)    x1    x2 logSigmaMu logSigmaNu
(Intercept)        0.23 -0.02 -0.25      -0.02       0.00
x1                -0.02  0.04  0.01       0.01       0.00
x2                -0.25  0.01  0.45       0.02       0.00
logSigmaMu        -0.02  0.01  0.02       0.07       0.00
logSigmaNu         0.00  0.00  0.00       0.00       0.02
            (Intercept)    x1    x2 sigmaMu sigmaNu
(Intercept)        0.23 -0.02 -0.25   -0.02    0.00
x1                -0.02  0.04  0.01    0.01    0.00
x2                -0.25  0.01  0.45    0.02    0.00
sigmaMu           -0.02  0.01  0.02    0.05    0.00
sigmaNu            0.00  0.00  0.00    0.00    0.02
            Estimate Std. error t value Pr(> t)
(Intercept)     4.63       0.47    9.75    0.00
x1              1.68       0.21    8.03    0.00
x2              2.25       0.67    3.33    0.00
logSigmaMu     -0.13       0.26   -0.50    0.62
logSigmaNu     -0.01       0.13   -0.10    0.92
            Estimate Std. error t value Pr(> t)
(Intercept)     4.63       0.47    9.75       0
x1              1.68       0.21    8.03       0
x2              2.25       0.67    3.33       0
sigmaMu         0.88       0.23    3.88       0
sigmaNu         0.99       0.13    7.71       0
Error in margEff.censReg(x) : 
  the margEff() method for objects of class 'censReg' can not yet be used for panel data models
'log Lik.' -73.199 (df=5)
[1] 60
[1] -40.0 156.4
> 
> 
> ## right-censoring
> pData$yNeg <- - pData$y
> randEffNeg <- censReg( yNeg ~ x1 + x2, data = pData, method = "BFGSR",
+    left = -Inf, right = 0 )
> printAll( "randEffNeg" )
Comparing new object 'randEffNeg' to previously saved object...
   comparing component 'maximum' ... OK
   comparing component 'estimate' ... OK
   comparing component 'hessian' ... OK
   comparing component 'fixed' ... OK
   comparing component 'type' ... OK
   comparing component 'gradientObs' ... OK
   comparing component 'control' ... OK
   comparing component 'xMean' ... OK
   comparing component 'call' ... OK
   comparing component 'terms' ... OK
   comparing component 'nObs' ... OK
   comparing component 'df.residual' ... OK
   comparing component 'start' ... OK
   comparing component 'left' ... OK
   comparing component 'right' ... OK

Call:
censReg(formula = yNeg ~ x1 + x2, left = -Inf, right = 0, data = pData, 
    method = "BFGSR")

Coefficients:
(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
       0.37       -1.68       -2.25       -0.13       -0.01 


Call:
censReg(formula = yNeg ~ x1 + x2, left = -Inf, right = 0, data = pData, 
    method = "BFGSR")

Coefficients:
(Intercept)          x1          x2     sigmaMu     sigmaNu 
        0.4        -1.7        -2.2         0.9         1.0 

--------------------------------------------
Maximum Likelihood estimation
BFGSR maximization, 77 iterations
Return code 2: successive function values within tolerance limit
Log-Likelihood: -73.199 
5  free parameters
Estimates:
            Estimate Std. error t value Pr(> t)    
(Intercept)     0.37       0.47     0.8     0.4    
x1             -1.68       0.21    -8.0   1e-15 ***
x2             -2.25       0.67    -3.3   9e-04 ***
logSigmaMu     -0.13       0.26    -0.5     0.6    
logSigmaNu     -0.01       0.13    -0.1     0.9    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
--------------------------------------------

Call:
censReg(formula = yNeg ~ x1 + x2, left = -Inf, right = 0, data = pData, 
    method = "BFGSR")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60              0             40             20 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)     0.37       0.47     0.8     0.4    
x1             -1.68       0.21    -8.0   1e-15 ***
x2             -2.25       0.67    -3.3   9e-04 ***
logSigmaMu     -0.13       0.26    -0.5     0.6    
logSigmaNu     -0.01       0.13    -0.1     0.9    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BFGSR maximization, 77 iterations
Return code 2: successive function values within tolerance limit
Log-likelihood: -73.199 on 5 Df


Call:
censReg(formula = yNeg ~ x1 + x2, left = -Inf, right = 0, data = pData, 
    method = "BFGSR")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60              0             40             20 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)      0.4        0.5     0.8     0.4    
x1              -1.7        0.2    -8.0   1e-15 ***
x2              -2.2        0.7    -3.3   9e-04 ***
sigmaMu          0.9        0.2     3.9   1e-04 ***
sigmaNu          1.0        0.1     7.7   1e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BFGSR maximization, 77 iterations
Return code 2: successive function values within tolerance limit
Log-likelihood: -73.199 on 5 Df

(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
       0.37       -1.68       -2.25       -0.13       -0.01 
(Intercept)          x1          x2     sigmaMu     sigmaNu 
       0.37       -1.68       -2.25        0.88        0.99 
            (Intercept)    x1    x2 logSigmaMu logSigmaNu
(Intercept)        0.23 -0.02 -0.25       0.02       0.00
x1                -0.02  0.04  0.01      -0.01       0.00
x2                -0.25  0.01  0.45      -0.02       0.00
logSigmaMu         0.02 -0.01 -0.02       0.07       0.00
logSigmaNu         0.00  0.00  0.00       0.00       0.02
            (Intercept)    x1    x2 sigmaMu sigmaNu
(Intercept)        0.23 -0.02 -0.25    0.02    0.00
x1                -0.02  0.04  0.01   -0.01    0.00
x2                -0.25  0.01  0.45   -0.02    0.00
sigmaMu            0.02 -0.01 -0.02    0.05    0.00
sigmaNu            0.00  0.00  0.00    0.00    0.02
            Estimate Std. error t value Pr(> t)
(Intercept)     0.37       0.47    0.78    0.44
x1             -1.68       0.21   -8.03    0.00
x2             -2.25       0.67   -3.33    0.00
logSigmaMu     -0.13       0.26   -0.50    0.62
logSigmaNu     -0.01       0.13   -0.10    0.92
            Estimate Std. error t value Pr(> t)
(Intercept)     0.37       0.47    0.78    0.44
x1             -1.68       0.21   -8.03    0.00
x2             -2.25       0.67   -3.33    0.00
sigmaMu         0.88       0.23    3.88    0.00
sigmaNu         0.99       0.13    7.71    0.00
Error in margEff.censReg(x) : 
  the margEff() method for objects of class 'censReg' can not yet be used for panel data models
'log Lik.' -73.199 (df=5)
[1] 60
[1] -40.0 156.4
> 
> 
> ## right-censoring at -5
> pData$yAddNeg <- - pData$yAdd
> randEffAddNeg <- censReg( yAddNeg ~ x1 + x2, data = pData, method = "BFGSR",
+    left = -Inf, right = -5 )
> printAll( "randEffAddNeg" )
Comparing new object 'randEffAddNeg' to previously saved object...
   comparing component 'maximum' ... OK
   comparing component 'estimate' ... OK
   comparing component 'hessian' ... OK
   comparing component 'fixed' ... OK
   comparing component 'type' ... OK
   comparing component 'gradientObs' ... OK
   comparing component 'control' ... OK
   comparing component 'xMean' ... OK
   comparing component 'call' ... OK
   comparing component 'terms' ... OK
   comparing component 'nObs' ... OK
   comparing component 'df.residual' ... OK
   comparing component 'start' ... OK
   comparing component 'left' ... OK
   comparing component 'right' ... OK

Call:
censReg(formula = yAddNeg ~ x1 + x2, left = -Inf, right = -5, 
    data = pData, method = "BFGSR")

Coefficients:
(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
      -4.63       -1.68       -2.25       -0.13       -0.01 


Call:
censReg(formula = yAddNeg ~ x1 + x2, left = -Inf, right = -5, 
    data = pData, method = "BFGSR")

Coefficients:
(Intercept)          x1          x2     sigmaMu     sigmaNu 
       -4.6        -1.7        -2.2         0.9         1.0 

--------------------------------------------
Maximum Likelihood estimation
BFGSR maximization, 76 iterations
Return code 2: successive function values within tolerance limit
Log-Likelihood: -73.199 
5  free parameters
Estimates:
            Estimate Std. error t value Pr(> t)    
(Intercept)    -4.63       0.47    -9.7  <2e-16 ***
x1             -1.68       0.21    -8.0   1e-15 ***
x2             -2.25       0.67    -3.3   9e-04 ***
logSigmaMu     -0.13       0.26    -0.5     0.6    
logSigmaNu     -0.01       0.13    -0.1     0.9    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
--------------------------------------------

Call:
censReg(formula = yAddNeg ~ x1 + x2, left = -Inf, right = -5, 
    data = pData, method = "BFGSR")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60              0             40             20 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)    -4.63       0.47    -9.7  <2e-16 ***
x1             -1.68       0.21    -8.0   1e-15 ***
x2             -2.25       0.67    -3.3   9e-04 ***
logSigmaMu     -0.13       0.26    -0.5     0.6    
logSigmaNu     -0.01       0.13    -0.1     0.9    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BFGSR maximization, 76 iterations
Return code 2: successive function values within tolerance limit
Log-likelihood: -73.199 on 5 Df


Call:
censReg(formula = yAddNeg ~ x1 + x2, left = -Inf, right = -5, 
    data = pData, method = "BFGSR")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60              0             40             20 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)     -4.6        0.5     -10  <2e-16 ***
x1              -1.7        0.2      -8   1e-15 ***
x2              -2.2        0.7      -3   9e-04 ***
sigmaMu          0.9        0.2       4   1e-04 ***
sigmaNu          1.0        0.1       8   1e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BFGSR maximization, 76 iterations
Return code 2: successive function values within tolerance limit
Log-likelihood: -73.199 on 5 Df

(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
      -4.63       -1.68       -2.25       -0.13       -0.01 
(Intercept)          x1          x2     sigmaMu     sigmaNu 
      -4.63       -1.68       -2.25        0.88        0.99 
            (Intercept)    x1    x2 logSigmaMu logSigmaNu
(Intercept)        0.23 -0.02 -0.25       0.02       0.00
x1                -0.02  0.04  0.01      -0.01       0.00
x2                -0.25  0.01  0.45      -0.02       0.00
logSigmaMu         0.02 -0.01 -0.02       0.07       0.00
logSigmaNu         0.00  0.00  0.00       0.00       0.02
            (Intercept)    x1    x2 sigmaMu sigmaNu
(Intercept)        0.23 -0.02 -0.25    0.02    0.00
x1                -0.02  0.04  0.01   -0.01    0.00
x2                -0.25  0.01  0.45   -0.02    0.00
sigmaMu            0.02 -0.01 -0.02    0.05    0.00
sigmaNu            0.00  0.00  0.00    0.00    0.02
            Estimate Std. error t value Pr(> t)
(Intercept)    -4.63       0.47   -9.75    0.00
x1             -1.68       0.21   -8.03    0.00
x2             -2.25       0.67   -3.33    0.00
logSigmaMu     -0.13       0.26   -0.50    0.62
logSigmaNu     -0.01       0.13   -0.10    0.92
            Estimate Std. error t value Pr(> t)
(Intercept)    -4.63       0.47   -9.75       0
x1             -1.68       0.21   -8.03       0
x2             -2.25       0.67   -3.33       0
sigmaMu         0.88       0.23    3.88       0
sigmaNu         0.99       0.13    7.71       0
Error in margEff.censReg(x) : 
  the margEff() method for objects of class 'censReg' can not yet be used for panel data models
'log Lik.' -73.199 (df=5)
[1] 60
[1] -40.0 156.4
> 
> 
> ## both right and left censoring
> pData$yBoth <- ifelse( pData$y < 3, pData$y, 3 )
> randEffBoth <- censReg( yBoth ~ x1 + x2, data = pData, method = "BFGSR",
+    left = 0, right = 3 )
> printAll( "randEffBoth" )
Comparing new object 'randEffBoth' to previously saved object...
   comparing component 'maximum' ... OK
   comparing component 'estimate' ... OK
   comparing component 'hessian' ... OK
   comparing component 'fixed' ... OK
   comparing component 'type' ... OK
   comparing component 'gradientObs' ... OK
   comparing component 'control' ... OK
   comparing component 'xMean' ... OK
   comparing component 'call' ... OK
   comparing component 'terms' ... OK
   comparing component 'nObs' ... OK
   comparing component 'df.residual' ... OK
   comparing component 'start' ... OK
   comparing component 'left' ... OK
   comparing component 'right' ... OK

Call:
censReg(formula = yBoth ~ x1 + x2, left = 0, right = 3, data = pData, 
    method = "BFGSR")

Coefficients:
(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
     -0.234       1.893       1.969       0.002       0.053 


Call:
censReg(formula = yBoth ~ x1 + x2, left = 0, right = 3, data = pData, 
    method = "BFGSR")

Coefficients:
(Intercept)          x1          x2     sigmaMu     sigmaNu 
       -0.2         1.9         2.0         1.0         1.1 

--------------------------------------------
Maximum Likelihood estimation
BFGSR maximization, 99 iterations
Return code 2: successive function values within tolerance limit
Log-Likelihood: -64.313 
5  free parameters
Estimates:
            Estimate Std. error t value Pr(> t)    
(Intercept)   -0.234      0.548    -0.4    0.67    
x1             1.893      0.301     6.3   3e-10 ***
x2             1.969      0.819     2.4    0.02 *  
logSigmaMu     0.002      0.278     0.0    1.00    
logSigmaNu     0.053      0.163     0.3    0.75    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
--------------------------------------------

Call:
censReg(formula = yBoth ~ x1 + x2, left = 0, right = 3, data = pData, 
    method = "BFGSR")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60             20             28             12 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)   -0.234      0.548    -0.4    0.67    
x1             1.893      0.301     6.3   3e-10 ***
x2             1.969      0.819     2.4    0.02 *  
logSigmaMu     0.002      0.278     0.0    1.00    
logSigmaNu     0.053      0.163     0.3    0.75    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BFGSR maximization, 99 iterations
Return code 2: successive function values within tolerance limit
Log-likelihood: -64.313 on 5 Df


Call:
censReg(formula = yBoth ~ x1 + x2, left = 0, right = 3, data = pData, 
    method = "BFGSR")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            60             20             28             12 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)     -0.2        0.5    -0.4    0.67    
x1               1.9        0.3     6.3   3e-10 ***
x2               2.0        0.8     2.4    0.02 *  
sigmaMu          1.0        0.3     3.6   3e-04 ***
sigmaNu          1.1        0.2     6.1   9e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BFGSR maximization, 99 iterations
Return code 2: successive function values within tolerance limit
Log-likelihood: -64.313 on 5 Df

(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
      -0.23        1.89        1.97        0.00        0.05 
(Intercept)          x1          x2     sigmaMu     sigmaNu 
      -0.23        1.89        1.97        1.00        1.05 
            (Intercept)    x1    x2 logSigmaMu logSigmaNu
(Intercept)        0.30 -0.03 -0.36      -0.02      -0.02
x1                -0.03  0.09  0.03       0.04       0.02
x2                -0.36  0.03  0.67       0.02       0.02
logSigmaMu        -0.02  0.04  0.02       0.08       0.00
logSigmaNu        -0.02  0.02  0.02       0.00       0.03
            (Intercept)    x1    x2 sigmaMu sigmaNu
(Intercept)        0.30 -0.03 -0.36   -0.02   -0.02
x1                -0.03  0.09  0.03    0.04    0.02
x2                -0.36  0.03  0.67    0.02    0.03
sigmaMu           -0.02  0.04  0.02    0.08    0.00
sigmaNu           -0.02  0.02  0.03    0.00    0.03
            Estimate Std. error t value Pr(> t)
(Intercept)    -0.23       0.55   -0.43    0.67
x1              1.89       0.30    6.29    0.00
x2              1.97       0.82    2.41    0.02
logSigmaMu      0.00       0.28    0.01    1.00
logSigmaNu      0.05       0.16    0.32    0.75
            Estimate Std. error t value Pr(> t)
(Intercept)    -0.23       0.55   -0.43    0.67
x1              1.89       0.30    6.29    0.00
x2              1.97       0.82    2.41    0.02
sigmaMu         1.00       0.28    3.60    0.00
sigmaNu         1.05       0.17    6.14    0.00
Error in margEff.censReg(x) : 
  the margEff() method for objects of class 'censReg' can not yet be used for panel data models
'log Lik.' -64.313 (df=5)
[1] 60
[1] -40.00 138.63
> 
> 
> ## re-order observations/individuals
> set.seed( 234 )
> perm <- sample( nId )
> nData2 <- nData
> nData2$id <- NA
> for( i in 1:nId ) {
+    nData2$id[ nData$id == paste( "F", i, sep = "_" ) ] <-
+       paste( "G", perm[ i ], sep = "_" )
+ }
> pData2 <- pdata.frame( nData2, c( "id", "time" ) )
> randEffBfgsr2 <- censReg( y ~ x1 + x2, data = pData2, method = "BFGSR" )
> all.equal( randEffBfgsr2[ -c(3,5,6,7,9,11,14) ],
+    randEffBfgsr[ -c(3,5,6,7,9,11,14) ], tolerance = 1e-2 )
[1] TRUE
> 
> # check if the order of observations/individuals influences the likelihood values
> d1c1 <- censReg( y ~ x1 + x2, data = pData, method = "BFGSR", start = coef(randEffBfgsr),
+    iterlim = 0 )
> all.equal( d1c1[-c(5,6,7,9,12,14,18)], randEffBfgsr[-c(5,6,7,9,12,14,18)] )
[1] TRUE
> d1c1$maximum -  randEffBfgsr$maximum
[1] 0
> 
> d2c2 <- censReg( y ~ x1 + x2, data = pData2, method = "BFGSR", start = coef(randEffBfgsr2),
+    iterlim = 0 )
> all.equal( d2c2[-c(5,6,7,9,12,14,18)], randEffBfgsr2[-c(5,6,7,9,12,14,18)] )
[1] TRUE
> d2c2$maximum -  randEffBfgsr2$maximum
[1] 0
> 
> d1c2 <- censReg( y ~ x1 + x2, data = pData, method = "BFGSR", 
+    start = coef(randEffBfgsr2), iterlim = 0 )
> d2c2$maximum - d1c2$maximum
[1] 0
> d2c2$gradient - d1c2$gradient
(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
          0           0           0           0           0 
> 
> d2c1 <- censReg( y ~ x1 + x2, data = pData2, method = "BFGSR", 
+    start = coef(randEffBfgsr), iterlim = 0 )
> d1c1$maximum - d2c1$maximum
[1] 0
> d1c1$gradient - d2c1$gradient
(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
          0           0           0           0           0 
> 
> round( d2c2$maximum - d2c1$maximum, 3 )
[1] 0
> round( d1c1$maximum - d1c2$maximum, 3 )
[1] 0
> 
> d1cS <- censReg( y ~ x1 + x2, data = pData, method = "BFGSR", 
+    start = randEffBfgsr$start, iterlim = 0 )
> d2cS <- censReg( y ~ x1 + x2, data = pData2, method = "BFGSR", 
+    start = randEffBfgsr$start, iterlim = 0 )
> d1cS$maximum - d2cS$maximum
[1] 0
> d1cS$gradient - d2cS$gradient
(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
          0           0           0           0           0 
> 
> 
> ## unbalanced panel data
> nDataUnb <- nData[ -c( 2, 5, 6, 8 ), ]
> pDataUnb <- pdata.frame( nDataUnb, c( "id", "time" ) )
> randEffBfgsrUnb <- censReg( y ~ x1 + x2, data = pDataUnb, method = "BFGSR" )
> printAll( "randEffBfgsrUnb" )
Comparing new object 'randEffBfgsrUnb' to previously saved object...
   comparing component 'maximum' ... OK
   comparing component 'estimate' ... OK
   comparing component 'hessian' ... OK
   comparing component 'fixed' ... OK
   comparing component 'type' ... OK
   comparing component 'gradientObs' ... OK
   comparing component 'control' ... OK
   comparing component 'xMean' ... OK
   comparing component 'call' ... OK
   comparing component 'terms' ... OK
   comparing component 'nObs' ... OK
   comparing component 'df.residual' ... OK
   comparing component 'start' ... OK
   comparing component 'left' ... OK
   comparing component 'right' ... OK

Call:
censReg(formula = y ~ x1 + x2, data = pDataUnb, method = "BFGSR")

Coefficients:
(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
     -0.222       1.640       2.108      -0.167      -0.001 


Call:
censReg(formula = y ~ x1 + x2, data = pDataUnb, method = "BFGSR")

Coefficients:
(Intercept)          x1          x2     sigmaMu     sigmaNu 
       -0.2         1.6         2.1         0.8         1.0 

--------------------------------------------
Maximum Likelihood estimation
BFGSR maximization, 77 iterations
Return code 2: successive function values within tolerance limit
Log-Likelihood: -71.193 
5  free parameters
Estimates:
            Estimate Std. error t value Pr(> t)    
(Intercept)   -0.222      0.472    -0.5   0.638    
x1             1.640      0.211     7.8   8e-15 ***
x2             2.108      0.685     3.1   0.002 ** 
logSigmaMu    -0.167      0.271    -0.6   0.538    
logSigmaNu    -0.001      0.132     0.0   0.993    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
--------------------------------------------

Call:
censReg(formula = y ~ x1 + x2, data = pDataUnb, method = "BFGSR")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            56             17             39              0 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)   -0.222      0.472    -0.5   0.638    
x1             1.640      0.211     7.8   8e-15 ***
x2             2.108      0.685     3.1   0.002 ** 
logSigmaMu    -0.167      0.271    -0.6   0.538    
logSigmaNu    -0.001      0.132     0.0   0.993    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BFGSR maximization, 77 iterations
Return code 2: successive function values within tolerance limit
Log-likelihood: -71.193 on 5 Df


Call:
censReg(formula = y ~ x1 + x2, data = pDataUnb, method = "BFGSR")

Observations:
         Total  Left-censored     Uncensored Right-censored 
            56             17             39              0 

Coefficients:
            Estimate Std. error t value Pr(> t)    
(Intercept)     -0.2        0.5    -0.5   0.638    
x1               1.6        0.2     7.8   8e-15 ***
x2               2.1        0.7     3.1   0.002 ** 
sigmaMu          0.8        0.2     3.7   2e-04 ***
sigmaNu          1.0        0.1     7.6   4e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

BFGSR maximization, 77 iterations
Return code 2: successive function values within tolerance limit
Log-likelihood: -71.193 on 5 Df

(Intercept)          x1          x2  logSigmaMu  logSigmaNu 
      -0.22        1.64        2.11       -0.17        0.00 
(Intercept)          x1          x2     sigmaMu     sigmaNu 
      -0.22        1.64        2.11        0.85        1.00 
            (Intercept)    x1    x2 logSigmaMu logSigmaNu
(Intercept)        0.22 -0.02 -0.26      -0.02       0.00
x1                -0.02  0.04  0.01       0.01       0.00
x2                -0.26  0.01  0.47       0.02       0.00
logSigmaMu        -0.02  0.01  0.02       0.07       0.00
logSigmaNu         0.00  0.00  0.00       0.00       0.02
            (Intercept)    x1    x2 sigmaMu sigmaNu
(Intercept)        0.22 -0.02 -0.26   -0.02    0.00
x1                -0.02  0.04  0.01    0.01    0.00
x2                -0.26  0.01  0.47    0.02    0.00
sigmaMu           -0.02  0.01  0.02    0.05    0.00
sigmaNu            0.00  0.00  0.00    0.00    0.02
            Estimate Std. error t value Pr(> t)
(Intercept)    -0.22       0.47   -0.47    0.64
x1              1.64       0.21    7.77    0.00
x2              2.11       0.68    3.08    0.00
logSigmaMu     -0.17       0.27   -0.62    0.54
logSigmaNu      0.00       0.13   -0.01    0.99
            Estimate Std. error t value Pr(> t)
(Intercept)    -0.22       0.47   -0.47    0.64
x1              1.64       0.21    7.77    0.00
x2              2.11       0.68    3.08    0.00
sigmaMu         0.85       0.23    3.68    0.00
sigmaNu         1.00       0.13    7.56    0.00
Error in margEff.censReg(x) : 
  the margEff() method for objects of class 'censReg' can not yet be used for panel data models
'log Lik.' -71.193 (df=5)
[1] 56
[1] -36.00 152.39
> 
> 
> ## NAs in data
> pDataNa <- pData
> obsNa <- which( ! rownames( pData ) %in% rownames( pDataUnb ) )
> pDataNa$y[ obsNa[ 1:2 ] ] <- NA
> pDataNa$x1[ obsNa[ 3 ] ] <- NA
> pDataNa$x2[ obsNa[ c( 1, 2, 4 ) ] ] <- NA
> randEffBfgsrNa <- censReg( y ~ x1 + x2, data = pDataNa, method = "BFGSR" )
> all.equal( randEffBfgsrNa[ -14 ], randEffBfgsrUnb[ -14 ] )
[1] TRUE
> 
> 
> # returning log-likelihood contributions only (no estimations)
> logLikRandEff <- censReg( y ~ x1 + x2, data = pData, start = coef( randEff ),
+    logLikOnly = TRUE )
> print( logLikRandEff, digits = 1 )
 [1] -4 -4 -7 -5 -3 -5 -6 -2 -4 -4 -7 -6 -4 -6 -6
attr(,"gradient")
       [,1]  [,2]  [,3] [,4] [,5]
 [1,] -0.85  0.23 -0.07 -0.1 -1.0
 [2,] -1.70  0.05 -1.19  1.7 -1.0
 [3,]  1.75  0.33  1.73  1.8  1.8
 [4,]  0.16 -0.20 -0.43 -0.7 -1.4
 [5,]  0.13  0.98  0.69 -0.7 -0.6
 [6,]  0.33 -0.31  0.38 -0.5 -1.6
 [7,] -0.08 -3.19 -0.24 -0.7  6.0
 [8,] -0.27  0.38  0.06 -0.5 -1.1
 [9,]  1.15  0.59  0.30  0.1 -1.6
[10,] -0.44 -0.41 -0.15 -0.5 -1.9
[11,] -0.03  1.45 -0.64 -0.9  2.7
[12,]  1.21  0.54  0.61  0.2 -1.7
[13,]  0.54 -0.23  0.33 -0.4 -1.4
[14,] -1.81 -1.31 -0.92  2.0  2.6
[15,] -0.08  1.09 -0.46 -0.8  0.2
> all.equal( sum( logLikRandEff ), c( logLik( randEff ) ) )
[1] TRUE
> logLikStart <- censReg( y ~ x1 + x2, data = pData, 
+    start = c( -0.4, 1.7, 2.2, -0.1, -0.01 ), logLikOnly = TRUE )
> print( round( c( logLikStart ), 3 ) )
 [1] -4.224 -3.591 -7.110 -5.316 -3.389 -5.360 -6.349 -1.662 -4.434 -3.774
[11] -6.788 -5.699 -4.385 -5.593 -5.548
> print( round( attr( logLikStart, "gradient" ), 2 ) )
       [,1]  [,2]  [,3]  [,4]  [,5]
 [1,] -0.79  0.28 -0.04 -0.18 -1.03
 [2,] -1.58  0.09 -1.10  1.49 -1.06
 [3,]  1.72  0.26  1.72  1.91  1.84
 [4,]  0.18 -0.21 -0.41 -0.61 -1.53
 [5,]  0.16  0.97  0.71 -0.66 -0.51
 [6,]  0.36 -0.39  0.42 -0.43 -1.58
 [7,] -0.05 -3.20 -0.23 -0.70  6.13
 [8,] -0.22  0.36  0.08 -0.57 -1.07
 [9,]  1.13  0.55  0.30  0.15 -1.61
[10,] -0.35 -0.39 -0.11 -0.52 -1.91
[11,] -0.01  1.42 -0.62 -0.97  2.68
[12,]  1.16  0.50  0.60  0.20 -1.75
[13,]  0.60 -0.27  0.37 -0.30 -1.38
[14,] -1.71 -1.20 -0.85  1.82  2.50
[15,] -0.03  1.06 -0.42 -0.92  0.20
> 
> 
> # save all objectives that were produced in this script
> # (in order to compare them with objects created by this script in the future)
> rm( saved )
> save.image( "censRegPanelTest.RData" )
> 
> 
> proc.time()
   user  system elapsed 
 28.844   0.132  29.022 
