
R version 3.2.2 (2015-08-14) -- "Fire Safety"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # I thank Mohit Batham for providing this R script that demonstrates
> # a bug in mvProbitMargEff() when called with 2 dependent variables
> library( "mvProbit" )
Loading required package: mvtnorm
Loading required package: maxLik
Loading required package: miscTools

Please cite the 'maxLik' package as:
Henningsen, Arne and Toomet, Ott (2011). maxLik: A package for maximum likelihood estimation in R. Computational Statistics 26(3), 443-458. DOI 10.1007/s00180-010-0217-1.

If you have questions, suggestions, or comments regarding the 'maxLik' package, please use a forum or 'tracker' at maxLik's R-Forge site:
https://r-forge.r-project.org/projects/maxlik/
Loading required package: abind
> nObs <- 100
> set.seed( 123 )
> xData <- data.frame(
+   const = rep( 1, nObs ),
+   x1 = as.numeric( rnorm( nObs ) > 0 ),
+   x2 = as.numeric( rnorm( nObs ) > 0 ),
+   x3 = rnorm( nObs ),
+   x4 = rnorm( nObs ))
> beta <- c( 0.8, 1.2, -1.0, 1.4, -0.8,
+   -0.6, 1.0, 0.6, -1.2, -1.6)
> sigma <- symMatrix( c( 1, 0.2, 1))
> margEffCond <- try( mvProbitMargEff( ~ x1 + x2 + x3 + x4 , coef = beta,
+   sigma = sigma, data = xData, cond = TRUE ) )
> margEffCond
       d_y1_d_x1    d_y2_d_x1     d_y1_d_x2    d_y2_d_x2     d_y1_d_x3
1   6.242162e-04 1.187352e-01  3.541798e-04 4.941583e-02 -9.092871e-04
2   6.543643e-03 3.779017e-01 -6.031307e-03 1.916769e-01  2.864799e-02
3   1.009866e-01 8.853915e-02 -7.511485e-02 1.091352e-02  3.271630e-02
4   5.560925e-03 2.551197e-01 -4.228668e-03 5.521326e-02  6.377971e-04
5   2.162461e-01 1.899223e-01 -1.824116e-01 4.179951e-02  1.155179e-01
6   3.404020e-01 3.411978e-01 -3.336132e-01 1.959699e-01  3.051426e-01
7   8.943431e-02 1.385113e-04 -5.978140e-02 2.244479e-06  2.409395e-02
8   3.659047e-01 3.151192e-01 -3.587648e-01 2.816372e-01  6.322922e-01
9   2.507393e-03 1.825377e-04 -2.052425e-02 3.945188e-05  2.108039e-03
10  3.123028e-01 2.196732e-02 -3.507011e-01 2.479513e-03  3.071897e-01
11  2.324986e-01 3.332342e-02 -2.616279e-01 9.990822e-02  1.815014e-01
12  3.669701e-01 2.371908e-01 -1.452190e-01 1.959842e-01  3.957123e-01
13  1.562764e-04 2.010166e-01  6.738908e-06 3.494378e-02 -7.927075e-05
14  2.290304e-01 1.158375e-01 -1.850332e-01 1.876800e-02  1.189817e-01
15  3.598924e-01 1.444204e-02 -2.983798e-01 6.872814e-02  2.480020e-01
16  1.087014e-02 1.543957e-02  1.205209e-04 1.323516e-02  1.502946e-03
17  4.316321e-01 1.302896e-01 -2.494667e-01 9.451514e-02  5.137184e-01
18  1.883839e-01 8.233130e-03 -3.695295e-01 7.784859e-03  4.111979e-01
19  1.764595e-01 2.127656e-01 -1.795664e-01 3.032924e-01  4.598809e-01
20  2.696128e-01 3.026175e-01 -5.979974e-02 2.953224e-01  2.002931e-01
21  3.781275e-01 1.873977e-01 -3.624343e-01 2.871183e-01  3.427225e-01
22  7.011294e-02 1.062175e-02 -3.060015e-01 5.189192e-03  2.360090e-01
23  3.530314e-04 3.036542e-01 -5.553025e-03 2.092471e-01  6.365872e-04
24  2.996895e-02 5.967149e-02 -1.996297e-01 2.942236e-02  1.148780e-01
25  4.202324e-01 5.860684e-02 -3.884077e-01 1.554984e-01  5.702601e-01
26  1.833302e-01 1.806521e-01 -4.149470e-01 1.288253e-01  4.798738e-01
27  3.905964e-01 8.137676e-02 -3.354230e-01 6.295951e-02  5.702647e-01
28  2.677490e-01 2.540814e-01 -4.061007e-01 2.246568e-01  5.450079e-01
29  3.357505e-02 2.511875e-03 -2.128142e-01 9.768853e-04  1.256953e-01
30  4.310937e-01 1.501553e-01 -3.882254e-01 3.587328e-02  4.863993e-01
31  5.555068e-03 1.430166e-03  6.147787e-04 1.291733e-03 -4.691610e-04
32  2.283252e-01 1.577052e-02 -2.143117e-01 5.824529e-02  4.668765e-01
33  1.980748e-01 1.333332e-01 -2.719425e-02 6.943360e-02  9.546301e-02
34  3.649192e-01 1.308764e-01 -3.802458e-01 2.526059e-01  6.448639e-01
35  3.739404e-01 3.357298e-01 -3.652201e-01 1.883932e-01  3.713995e-01
36  4.437260e-01 1.242135e-07 -1.763561e-01 5.508303e-08  4.062312e-01
37  4.650728e-02 3.098674e-02 -3.094215e-02 2.216587e-03  1.001322e-02
38  1.963769e-01 3.335111e-01 -1.967856e-01 2.419949e-01  4.810435e-01
39  3.539308e-01 1.833311e-01 -3.701590e-01 4.657211e-02  6.526345e-01
40  3.908429e-01 1.846544e-01 -3.342273e-01 1.712057e-01  6.097303e-01
41  2.437334e-01 2.333646e-01 -2.386136e-01 3.031552e-01  1.578993e-01
42  3.915181e-01 2.335575e-01 -3.077460e-01 2.029372e-01  6.252012e-01
43  5.670658e-03 2.337954e-05 -5.787178e-02 4.941175e-06  1.548173e-02
44  4.260204e-01 1.311815e-01 -3.860337e-01 2.979872e-02  5.377571e-01
45  1.821236e-01 3.470872e-01 -1.729038e-01 1.537558e-01  1.023031e-01
46  2.358681e-04 3.528425e-01  1.270927e-04 2.302791e-01 -3.761272e-04
47  1.728514e-01 3.567890e-01 -4.020370e-01 2.806900e-01  4.501790e-01
48  2.776750e-01 1.229863e-03 -2.124277e-01 1.153734e-02  1.452728e-01
49  4.377307e-01 4.373829e-03 -1.659166e-01 2.439275e-03  3.899896e-01
50  2.498035e-02 3.518530e-01 -1.757650e-01 2.271833e-01  9.722798e-02
51  3.268871e-01 2.987312e-01 -3.904456e-01 2.689267e-01  6.231078e-01
52  2.363817e-01 3.148475e-05 -2.178222e-01 4.474813e-04  4.644625e-01
53  4.227373e-01 7.889815e-02 -3.939865e-01 1.850863e-01  5.695743e-01
54  1.137235e-01 3.429718e-01 -1.163398e-01 2.321793e-01  5.465348e-02
55  4.259948e-04 3.263798e-01 -9.579334e-04 1.748102e-01 -4.700098e-04
56  1.964941e-01 3.208049e-01 -2.022963e-01 2.504891e-01  1.256412e-01
57  6.434447e-02 1.430569e-01 -6.454978e-02 2.264578e-02  2.190247e-01
58  1.743691e-02 2.821432e-01 -1.878913e-02 2.407232e-01  3.959988e-03
59  5.085158e-02 1.821873e-05 -2.380857e-03 3.518649e-06  1.066594e-02
60  3.497401e-02 6.790807e-02 -3.549737e-02 1.946573e-01  1.333344e-01
61  4.339590e-01 8.877389e-02 -2.574497e-01 6.353119e-02  5.178587e-01
62  3.723010e-01 3.106623e-01 -3.475419e-01 2.694763e-01  6.428392e-01
63  1.425268e-01 3.134066e-01 -3.877197e-01 2.305724e-01  3.987836e-01
64  5.908674e-02 1.332659e-02 -5.870003e-02 7.405398e-04  2.050218e-01
65  1.812099e-03 1.241717e-04  6.853699e-04 2.309213e-05 -2.626757e-03
66  5.382265e-03 2.362120e-01  1.184724e-04 1.700117e-01  4.485338e-04
67  4.130255e-01 3.221554e-01 -2.249984e-01 2.534448e-01  5.088477e-01
68  4.333740e-01 3.691081e-04 -3.757613e-01 1.315987e-05  5.344392e-01
69  3.433076e-01 3.184406e-01 -3.777607e-01 2.811350e-01  6.226309e-01
70  2.858266e-01 1.749116e-01 -5.880279e-02 1.026039e-01  1.831357e-01
71  1.017219e-01 4.050366e-06 -3.566934e-01 1.584886e-06  3.160650e-01
72  5.958139e-03 6.144427e-02 -5.772062e-03 1.197804e-01  2.519904e-02
73  7.780256e-03 3.751948e-01 -7.524372e-03 1.971743e-01  1.110557e-03
74  5.307541e-02 1.234951e-01 -4.688123e-02 2.611450e-01  1.491626e-02
75  1.477768e-02 6.786639e-02 -1.322794e-01 3.152765e-02  6.061507e-02
76  2.051165e-01 1.359589e-01 -1.664074e-01 2.366505e-02  1.012108e-01
77  1.692668e-01 6.294716e-02 -1.628435e-01 1.401429e-01  3.998784e-01
78  3.642854e-01 3.251374e-01 -3.673405e-01 2.495282e-01  6.342604e-01
79  2.170606e-01 3.528998e-01 -3.920347e-02 2.386014e-01  1.382442e-01
80  1.112030e-02 1.178723e-02 -9.088258e-02 1.049535e-02  4.261244e-02
81  2.978905e-01 3.320241e-02 -2.736589e-01 4.390357e-03  5.295058e-01
82  1.331111e-01 2.979235e-01 -1.724521e-02 2.150022e-01  7.078445e-02
83  5.226047e-02 2.716662e-01 -2.617809e-01 1.734823e-01  1.833979e-01
84  8.835392e-02 6.493246e-02 -6.374644e-02 6.773689e-03  2.620113e-02
85  1.408281e-01 2.352794e-01 -3.893355e-01 1.653732e-01  3.985251e-01
86  2.358429e-01 2.459438e-02 -2.661120e-01 8.182480e-02  1.864740e-01
87  3.484934e-01 3.184398e-01 -1.183630e-01 2.471137e-01  3.369886e-01
88  8.611436e-04 3.619514e-01  1.205684e-04 2.039100e-01 -1.453527e-04
89  3.939608e-01 1.027403e-01 -3.730341e-01 2.086362e-01  5.963754e-01
90  1.131527e-01 2.665471e-01 -1.211971e-01 2.554413e-01  5.660223e-02
91  1.381431e-02 3.759098e-01 -3.741968e-04 2.236921e-01  2.641137e-03
92  6.485357e-05 5.142546e-02 -9.327762e-06 4.123271e-03 -1.394391e-05
93  8.197719e-02 3.435105e-02 -8.014731e-03 2.907749e-02  3.802023e-02
94  2.138202e-01 5.680596e-02 -3.861241e-01 5.214430e-02  4.628950e-01
95  6.240478e-04 1.202957e-01  2.616383e-04 1.747915e-01 -6.018098e-04
96  3.870766e-01 7.658844e-02 -4.203989e-01 1.340185e-02  4.913201e-01
97  7.324932e-04 3.409098e-01  2.068383e-04 2.256284e-01 -3.267474e-04
98  2.565919e-01 2.799815e-01 -2.507716e-01 1.339879e-01  5.393088e-01
99  2.883700e-02 7.073877e-02 -1.673873e-01 6.036296e-02  1.007286e-01
100 9.950057e-04 2.342644e-01 -1.438903e-02 1.159419e-01  2.225310e-03
        d_y2_d_x3     d_y1_d_x4     d_y2_d_x4
1   -5.337076e-02 -1.217946e-03 -7.116016e-02
2   -4.556785e-01 -1.085716e-02 -5.938578e-01
3   -4.096208e-02 -1.752248e-02 -5.305315e-02
4   -1.718573e-01 -5.033725e-04 -2.288995e-01
5   -1.356151e-01 -5.709962e-02 -1.693108e-01
6   -4.626065e-01 -1.236955e-01 -5.476115e-01
7   -1.374774e-05 -1.376687e-02 -1.766507e-05
8   -5.617751e-01 -2.352093e-01 -6.027622e-01
9   -1.495129e-05 -4.698874e-03 -1.965954e-05
10  -1.205471e-02 -9.502537e-02 -1.223440e-02
11  -1.037333e-01 -5.927103e-02 -1.261485e-01
12  -4.853602e-01 -1.409460e-01 -5.618024e-01
13  -1.160680e-01 -1.077226e-04 -1.547572e-01
14  -6.743002e-02 -6.227138e-02 -8.382617e-02
15  -5.840224e-02 -1.310006e-01 -5.940975e-02
16  -4.906360e-02 -1.987875e-03 -6.512110e-02
17  -1.041164e-01 -2.630165e-01 -1.155074e-01
18  -3.198514e-02 -2.245065e-01 -3.629164e-02
19  -5.094600e-01 -1.611214e-01 -5.258547e-01
20  -5.834945e-01 -7.315317e-02 -5.908285e-01
21  -4.686536e-01 -1.409292e-01 -4.801276e-01
22  -2.801524e-03 -7.413808e-02 -3.315654e-03
23  -4.687627e-01 -7.913827e-04 -6.242125e-01
24  -2.339741e-02 -3.739096e-02 -2.897192e-02
25  -1.864479e-01 -2.757257e-01 -1.973650e-01
26  -1.354473e-01 -1.555653e-01 -1.530124e-01
27  -5.905910e-02 -3.031747e-01 -6.356146e-02
28  -3.141834e-01 -2.445481e-01 -3.296586e-01
29  -4.308149e-04 -4.063636e-02 -5.256609e-04
30  -1.244164e-01 -2.451831e-01 -1.393109e-01
31  -5.748765e-03 -1.996328e-03 -7.645247e-03
32  -5.749169e-02 -2.485152e-01 -6.443908e-02
33  -7.976489e-02 -4.933588e-02 -1.001991e-01
34  -3.519689e-01 -2.176969e-01 -3.787362e-01
35  -4.543608e-01 -1.520545e-01 -5.288002e-01
36   4.078959e-08 -2.321321e-01 -3.650413e-08
37  -9.470638e-03 -5.599074e-03 -1.245874e-02
38  -5.379608e-01 -1.784128e-01 -6.103357e-01
39  -1.623868e-01 -2.117020e-01 -1.734282e-01
40  -4.424046e-01 -2.549755e-01 -4.723255e-01
41  -5.431038e-01 -6.172747e-02 -5.485077e-01
42  -2.452776e-01 -2.058680e-01 -2.583648e-01
43  -1.361928e-06 -9.421621e-03 -1.751449e-06
44  -1.068868e-01 -2.747952e-01 -1.176572e-01
45  -3.866129e-01 -4.308797e-02 -4.870865e-01
46  -4.772984e-01 -5.048467e-04 -6.363958e-01
47  -4.617904e-01 -1.582323e-01 -5.275702e-01
48  -6.288000e-03 -8.171878e-02 -6.338553e-03
49  -1.370293e-03 -2.221004e-01 -1.547789e-03
50  -3.405243e-01 -3.377483e-02 -4.287770e-01
51  -5.653006e-01 -2.339108e-01 -6.015586e-01
52  -1.865288e-04 -2.652524e-01 -2.058695e-04
53  -2.377973e-01 -2.669393e-01 -2.513088e-01
54  -4.887139e-01 -2.117005e-02 -6.286334e-01
55  -2.645143e-01 -8.472496e-04 -3.525876e-01
56  -5.029070e-01 -4.735254e-02 -6.281507e-01
57  -8.345383e-02 -7.093947e-02 -1.002719e-01
58  -4.589524e-01 -2.110972e-03 -6.088638e-01
59  -1.155476e-06 -6.094729e-03 -1.524647e-06
60  -2.242676e-01 -4.338866e-02 -2.255882e-01
61  -6.256686e-02 -2.744632e-01 -6.910334e-02
62  -3.930630e-01 -2.188573e-01 -4.187628e-01
63  -3.177072e-01 -1.346508e-01 -3.667627e-01
64  -3.633869e-03 -6.474833e-02 -4.341707e-03
65  -9.185527e-06 -3.551360e-03 -1.224145e-05
66  -4.182937e-01 -9.412847e-04 -5.569548e-01
67  -4.368539e-01 -2.121764e-01 -4.909395e-01
68  -8.378218e-05 -3.053053e-01 -9.038619e-05
69  -5.406791e-01 -2.429832e-01 -5.780371e-01
70  -1.278012e-01 -9.136303e-02 -1.556958e-01
71  -2.690645e-07 -9.778124e-02 -3.065364e-07
72  -1.599442e-01 -1.222468e-02 -2.087815e-01
73  -4.553119e-01 -9.429923e-04 -6.059894e-01
74  -3.619919e-01 -6.373366e-03 -3.600466e-01
75  -2.654144e-02 -2.052730e-02 -3.368368e-02
76  -8.253894e-02 -5.219228e-02 -1.034428e-01
77  -1.823580e-01 -1.933462e-01 -2.094549e-01
78  -5.570737e-01 -2.329998e-01 -5.977344e-01
79  -4.376374e-01 -5.640861e-02 -5.442394e-01
80  -3.960260e-02 -2.286901e-02 -5.097118e-02
81  -1.985494e-02 -2.930432e-01 -2.083551e-02
82  -4.873264e-01 -2.635275e-02 -6.219051e-01
83  -2.178570e-01 -6.124102e-02 -2.655877e-01
84  -2.654547e-02 -1.427893e-02 -3.450270e-02
85  -1.935700e-01 -1.310417e-01 -2.230268e-01
86  -8.012368e-02 -6.055196e-02 -9.719265e-02
87  -5.251842e-01 -1.277369e-01 -6.169786e-01
88  -3.343081e-01 -2.988801e-04 -4.457054e-01
89  -2.893290e-01 -2.715192e-01 -3.090571e-01
90  -4.641251e-01 -2.083294e-02 -5.959627e-01
91  -3.927113e-01 -1.490187e-03 -5.218740e-01
92  -1.686355e-02 -1.997389e-05 -2.248464e-02
93  -1.006463e-01 -1.342221e-02 -1.298114e-01
94  -1.703575e-01 -2.259094e-01 -1.923912e-01
95  -2.655414e-01 -8.026463e-04 -3.540551e-01
96  -5.533354e-02 -1.549509e-01 -5.700021e-02
97  -4.787733e-01 -4.979888e-04 -6.383273e-01
98  -3.748202e-01 -2.341429e-01 -3.925652e-01
99  -1.849022e-01 -4.803859e-02 -2.325098e-01
100 -1.485286e-01 -1.904501e-03 -1.971365e-01
> 
> proc.time()
   user  system elapsed 
  2.108   0.132   2.241 
