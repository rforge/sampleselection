
R version 3.2.2 (2015-08-14) -- "Fire Safety"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # I thank Mohit Batham for providing this R script that demonstrates
> # a bug in mvProbitMargEff() when called with 2 dependent variables
> library( "mvProbit" )
Loading required package: mvtnorm
Loading required package: maxLik
Loading required package: miscTools

Please cite the 'maxLik' package as:
Henningsen, Arne and Toomet, Ott (2011). maxLik: A package for maximum likelihood estimation in R. Computational Statistics 26(3), 443-458. DOI 10.1007/s00180-010-0217-1.

If you have questions, suggestions, or comments regarding the 'maxLik' package, please use a forum or 'tracker' at maxLik's R-Forge site:
https://r-forge.r-project.org/projects/maxlik/
Loading required package: abind
> nObs <- 100
> set.seed( 123 )
> xData <- data.frame(
+   const = rep( 1, nObs ),
+   x1 = as.numeric( rnorm( nObs ) > 0 ),
+   x2 = as.numeric( rnorm( nObs ) > 0 ),
+   x3 = rnorm( nObs ),
+   x4 = rnorm( nObs ))
> beta <- c( 0.8, 1.2, -1.0, 1.4, -0.8,
+   -0.6, 1.0, 0.6, -1.2, -1.6)
> sigma <- symMatrix( c( 1, 0.2, 1))
> margEffCond <- try( mvProbitMargEff( ~ x1 + x2 + x3 + x4 , coef = beta,
+   sigma = sigma, data = xData, cond = TRUE ) )
Error in pmvnormWrap(upper = xBeta[i, -k], sigma = coef$sigma[-k, -k],  : 
  argument 'sigma' must be a matrix
> margEffCond
[1] "Error in pmvnormWrap(upper = xBeta[i, -k], sigma = coef$sigma[-k, -k],  : \n  argument 'sigma' must be a matrix\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in pmvnormWrap(upper = xBeta[i, -k], sigma = coef$sigma[-k, -k],     algorithm = algorithm, nGHK = nGHK, random.seed = random.seed,     ...): argument 'sigma' must be a matrix>
> 
> proc.time()
   user  system elapsed 
  0.408   0.012   0.413 
