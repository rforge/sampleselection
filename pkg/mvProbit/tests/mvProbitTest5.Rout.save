
R version 2.13.2 (2011-09-30)
Copyright (C) 2011 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: i686-pc-linux-gnu (32-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library( "mvProbit" )
Loading required package: mvtnorm
Loading required package: maxLik
Loading required package: miscTools
Loading required package: bayesm
> 
> ## generate a simulated data set
> set.seed( 123 )
> # number of observations
> nObs <- 10
> 
> # generate explanatory variables
> xMat <- cbind( 
+    const = rep( 1, nObs ),
+    x1 = as.numeric( rnorm( nObs ) > 0 ),
+    x2 = rnorm( nObs ),
+    x3 = rnorm( nObs ) )
> 
> # model coefficients
> beta <- cbind( c( -0.4,  0.8, -1.0, -1.4 ),
+                c( -0.6, -0.5,  0.6, -1.2 ),
+                c(  0.3,  0.9, -1.3,  0.8 ),
+                c( -0.3, -1.0,  0.5, -0.8 ),
+                c(  1.2, -0.6, -0.7,  1.1 ) )
> 
> # covariance matrix of error terms
> sigma <- diag( 5 )
> sigma[ upper.tri( sigma ) ] <- 
+    c( 0.5, 0.4, -0.7, 0.8, -0.5, 0.8, 0, 0.6, -0.2, 0.6 )
> sigma <- cov2cor( t( sigma ) %*% sigma )
> 
> # all parameters in a vector
> allCoef <- c( c( beta ), sigma[ lower.tri( sigma ) ] )
> 
> # generate dependent variables
> yMatLin <- xMat %*% beta 
> yMat <- ( yMatLin + rmvnorm( nObs, sigma = sigma ) ) > 0
> colnames( yMat ) <- paste( "y", 1:5, sep = "" )
> # (yMatLin > 0 )== yMat
> 
> # unconditional expectations of dependent variables
> yExp <- mvProbitExp( ~ x1 + x2 + x3, coef = c( beta ), 
+    sigma = sigma, data = as.data.frame( xMat ) )
> print( yExp )
           V1          V2          V3         V4          V5
1  0.44862794 0.921588460 0.015953838 0.87825339 0.202855966
2  0.32468091 0.451234969 0.366123556 0.52164668 0.760638490
3  0.92444685 0.644930051 0.443616447 0.39019505 0.209215900
4  0.90486233 0.436865599 0.681893227 0.25413122 0.390023321
5  0.96644197 0.247158880 0.922568426 0.14054161 0.618500758
6  0.83508528 0.977042825 0.006711557 0.82711126 0.006101797
7  0.10190838 0.035409669 0.889339687 0.04259780 0.879616215
8  0.91179551 0.024764000 0.998555465 0.07986101 0.996977611
9  0.68865299 0.882302914 0.063970443 0.83177105 0.293599410
10 0.04623117 0.008464347 0.972424249 0.06184753 0.998193726
> yExpA <- mvProbitExp( ~ x1 + x2 + x3, coef = allCoef,
+    data = as.data.frame( xMat ) )
> all.equal( yExp, yExpA )
[1] TRUE
> yExp2 <- pnorm( yMatLin )
> all.equal( yExp, as.data.frame( yExp2 ) )
[1] TRUE
> 
> 
> # conditional expectations of dependent variables
> # (assuming that all other dependent variables are one)
> yExpCond <- mvProbitExp( ~ x1 + x2 + x3, coef = c( beta ), 
+    sigma = sigma, data = as.data.frame( xMat ), cond = TRUE )
> print( yExpCond )
          V1         V2          V3         V4           V5
1  0.8656096 0.95757117 0.004552378 1.00012203 4.082664e-02
2  0.7373896 0.57742229 0.467916595 0.95795790 7.936815e-01
3  0.9961018 0.77166934 0.473556615 0.88368867 2.073254e-01
4  0.9988939 0.55107465 0.896528005 0.48720478 5.566702e-01
5  1.0000240 0.28302432 0.998959430 0.15812885 8.477676e-01
6  0.9936659 0.99527546 0.000120083 1.00009298 9.768767e-05
7  0.8791553 0.06346819 0.999207396 0.08832967 9.922100e-01
8  1.0000440 0.01929447 1.000046380 0.06269898 1.000033e+00
9  0.9464858 0.91464773 0.026635678 1.00014977 1.143547e-01
10 0.8012749 0.02274515 0.999898411 0.12317247 9.999700e-01
> yExpCondA <- mvProbitExp( ~ x1 + x2 + x3, coef = allCoef,
+    data = as.data.frame( xMat ), cond = TRUE )
> all.equal( yExpCond, yExpCondA )
[1] TRUE
> yExpCond2 <- matrix( NA, nrow = nObs, ncol = ncol( yMat ) )
> for( i in 1:nObs ) {
+    for( k in 1:ncol( yMat ) ) {
+       set.seed( 123 )
+       numerator <- pmvnorm( upper = yMatLin[ i, ], sigma = sigma )
+       set.seed( 123 )
+       denominator <- pmvnorm( upper = yMatLin[ i, -k ], sigma = sigma[ -k, -k ] )
+       yExpCond2[ i, k ] <- numerator / denominator
+    }
+ }
> all.equal( yExpCond, as.data.frame( yExpCond2 ) )
[1] TRUE
> 
> 
> # conditional expectations of dependent variables
> # (assuming that all other dependent variables are as observed)
> yExpCondObs <- mvProbitExp( cbind( y1, y2, y3, y4, y5 ) ~ x1 + x2 + x3, 
+    coef = c( beta ), sigma = sigma, data = as.data.frame( cbind( xMat, yMat ) ), 
+    cond = TRUE )
> print( yExpCondObs )
           y1          y2          y3         y4          y5
1  0.52214580 0.972572721 0.028339571 0.95756410 0.213546805
2  0.08400213 0.235313145 0.310679153 0.12802299 0.713628125
3  0.73085786 0.731725391 0.452200078 0.12125512 0.106699092
4  0.99020810 0.314897599 0.592735232 0.31911334 0.382726222
5  0.99942843 0.126181454 0.924677272 0.10690591 0.780360195
6  0.89184146 0.986682333 0.007981102 0.87270446 0.006501712
7  0.08488396 0.018757109 0.872798993 0.03378512 0.863879128
8  0.90255615 0.027615316 0.999149862 0.08805280 0.996737149
9  0.79438617 0.925987961 0.095247132 0.88299533 0.332071756
10 0.21364352 0.001567529 1.000238282 0.05247669 0.999084535
> yExpCondObsA <- mvProbitExp( cbind( y1, y2, y3, y4, y5 ) ~ x1 + x2 + x3, 
+    coef = allCoef, data = as.data.frame( cbind( xMat, yMat ) ), 
+    cond = TRUE )
> all.equal( yExpCond, yExpCondA )
[1] TRUE
> yExpCondObs2 <- matrix( NA, nrow = nObs, ncol = ncol( yMat ) )
> for( i in 1:nObs ){
+    for( k in 1:ncol( yMat ) ) {
+       ySign <- 2 * yMat[ i, ] - 1
+       ySign[ k ] <- 1
+       yLinTmp <- yMatLin[ i, ] * ySign
+       sigmaTmp <- diag( ySign ) %*% sigma %*% diag( ySign )
+       set.seed( 123 )
+       numerator <- pmvnorm( upper = yLinTmp, sigma = sigmaTmp )
+       set.seed( 123 )
+       denominator <- pmvnorm( upper = yLinTmp[ -k ], sigma = sigmaTmp[ -k, -k ] )
+       yExpCondObs2[ i, k ] <- numerator / denominator
+    }
+ }
> colnames( yExpCondObs2 ) <- names( yExpCondObs )
> all.equal( yExpCondObs, as.data.frame( yExpCondObs2 ) )
[1] TRUE
> 
> 
> # calculating log likelihood value(s)
> logLikVal <- mvProbitLogLik( cbind( y1, y2, y3, y4, y5 ) ~ x1 + x2 + x3, 
+    coef = c( beta ), sigma = sigma, data = as.data.frame( cbind( xMat, yMat ) ) )
> print( logLikVal )
 [1] -1.1306223 -2.8835781 -2.4997019 -2.3888511 -3.2388258 -0.3424105
 [7] -0.4303804 -0.2160646 -1.0259354 -3.0308173
> logLikValA <- mvProbitLogLik( cbind( y1, y2, y3, y4, y5 ) ~ x1 + x2 + x3, 
+    coef = allCoef, data = as.data.frame( cbind( xMat, yMat ) ) )
> all.equal( logLikVal, logLikValA )
[1] TRUE
> 
> # calculating log likelihood value(s) with one-sided gradients
> logLikValGrad <- mvProbitLogLik( cbind( y1, y2, y3, y4, y5 ) ~ x1 + x2 + x3,
+    coef = c( beta ), sigma = sigma, data = as.data.frame( cbind( xMat, yMat ) ),
+    oneSidedGrad = TRUE )
> print( logLikValGrad )
 [1] -1.1306223 -2.8835781 -2.4997019 -2.3888511 -3.2388258 -0.3424105
 [7] -0.4303804 -0.2160646 -1.0259354 -3.0308173
attr(,"gradient")
             b_1_0        b_1_1        b_1_2        b_1_3       b_2_0
 [1,]  0.829645431  0.000000000  1.015553772 -0.885915845  0.07479024
 [2,] -0.210843581  0.000000000 -0.075864390  0.045958559 -0.48096658
 [3,]  0.541387385  0.541387385  0.216972694 -0.555466606 -1.40881612
 [4,]  0.033934780  0.033934780  0.003755999 -0.024734827  1.25977164
 [5,]  0.003771511  0.003771511 -0.002096367 -0.002357349  1.78318473
 [6,]  0.229643929  0.229643929  0.410353502 -0.387339692  0.03712902
 [7,] -0.185539085 -0.185539085 -0.092370684 -0.155442221 -0.05339755
 [8,]  0.195184004  0.000000000 -0.383853084  0.029935999 -0.06607573
 [9,]  0.415106227  0.000000000  0.291137259 -0.472448397  0.17791536
[10,] -0.420474439  0.000000000  0.198796509 -0.527197214 -0.00565331
            b_2_1       b_2_2        b_2_3         b_3_0       b_3_1
 [1,]  0.00000000  0.09154934 -0.079862980 -7.296645e-02  0.00000000
 [2,]  0.00000000 -0.17305835  0.104838566 -7.277982e-01  0.00000000
 [3,] -1.40881612 -0.56461316  1.445450536 -9.941635e-01 -0.99416353
 [4,]  1.25977164  0.13943499 -0.918237058  8.198403e-01  0.81984027
 [5,]  1.78318473 -0.99116784 -1.114560964  1.725897e-01  0.17258971
 [6,]  0.03712902  0.06634628 -0.062625481 -2.293428e-02 -0.02293428
 [7,] -0.05339755 -0.02658398 -0.044735771  2.517569e-01  0.25175691
 [8,]  0.00000000  0.12994527 -0.010134232  3.901237e-03  0.00000000
 [9,]  0.00000000  0.12478202 -0.202492446 -2.095376e-01  0.00000000
[10,]  0.00000000  0.00267283 -0.007088207  8.131718e-06  0.00000000
              b_3_2         b_3_3       b_4_0       b_4_1       b_4_2
 [1,] -8.931693e-02  7.791514e-02  0.10575660  0.00000000  0.12945469
 [2,] -2.618718e-01  1.586416e-01 -0.35696897  0.00000000 -0.12844229
 [3,] -3.984322e-01  1.020015e+00 -0.33362178 -0.33362178 -0.13370600
 [4,]  9.074220e-02 -5.975750e-01 -0.61922813 -0.61922813 -0.06853781
 [5,] -9.593259e-02 -1.078755e-01 -0.21135463 -0.21135463  0.11747946
 [6,] -4.098160e-02  3.868296e-02  0.25623135  0.25623135  0.45786291
 [7,]  1.253373e-01  2.109187e-01 -0.08556548 -0.08556548 -0.04259880
 [8,] -7.672273e-03  5.983456e-04 -0.17849777  0.00000000  0.35103595
 [9,] -1.469604e-01  2.384821e-01  0.25098465  0.00000000  0.17602961
[10,] -3.844924e-06  1.019629e-05  2.14880542  0.00000000 -1.01593708
            b_4_3        b_5_0       b_5_1        b_5_2       b_5_3
 [1,] -0.11292964 -0.374754684  0.00000000 -0.458730448 0.400171445
 [2,]  0.07781019 -1.317896627  0.00000000 -0.474197324 0.287268283
 [3,]  0.34229673 -0.235116587 -0.23511659 -0.094227969 0.241230260
 [4,]  0.45134945 -0.702249681 -0.70224968 -0.077726866 0.511863178
 [5,]  0.13210478 -1.471345604 -1.47134560  0.817834013 0.919648313
 [6,] -0.43218456 -0.018413872 -0.01841387 -0.032904022 0.031058449
 [7,] -0.07168564  0.258283049  0.25828305  0.128586384 0.216386217
 [8,] -0.02737674  0.009751872  0.00000000 -0.019178276 0.001495677
 [9,] -0.28565539 -0.561014732  0.00000000 -0.393470933 0.638510891
[10,]  2.69420414  0.003719452  0.00000000 -0.001758529 0.004663502
              R_1_2         R_1_3         R_1_4        R_1_5         R_2_3
 [1,]  0.1253095627 -2.974296e-02  1.686612e-01 -0.317886104 -0.0208711564
 [2,]  0.2373436221  2.127181e-01  1.696971e-01  0.246140189  0.2225286910
 [3,] -0.4565641536 -3.776616e-01 -6.772429e-02 -0.159090089  1.0955888663
 [4,]  0.0932491169  5.409154e-02 -2.715220e-03 -0.032249332  0.8408139847
 [5,]  0.0140944278  3.817987e-03 -7.985301e-05 -0.007061590  0.2433483024
 [6,]  0.0296042997 -2.598987e-03  1.382853e-01 -0.004564782 -0.0038689822
 [7,]  0.0380970110 -1.682981e-02  4.928165e-02 -0.048184360 -0.0366696286
 [8,] -0.0008799584  2.860694e-03 -4.381225e-03  0.001581942 -0.0012885881
 [9,]  0.1742684002 -4.091158e-02  2.153006e-01 -0.249286491 -0.0828865914
[10,]  0.0098217501 -2.046363e-06 -6.627940e-01 -0.001926264 -0.0000053344
              R_2_4         R_2_5         R_3_4         R_3_5        R_4_5
 [1,]  0.0003426339 -5.483524e-03 -1.848011e-03  1.008907e-02 -0.032388214
 [2,]  0.1630178854  8.015298e-01  6.566876e-01  7.021440e-01  0.624207085
 [3,]  0.4824577493  4.457555e-01  7.163385e-01  1.268289e-01  0.151695654
 [4,] -0.7549204981 -7.071321e-01 -1.072649e-01 -7.800970e-01  0.559948980
 [5,] -0.3932874630 -2.331606e+00 -1.072564e-03 -3.269655e-01  0.343980675
 [6,]  0.0037047386  9.094581e-05  7.130642e-04 -1.813092e-04 -0.003323427
 [7,]  0.0034465639 -3.419331e-03 -1.683592e-03  2.825673e-02 -0.018517040
 [8,]  0.0079515947  3.547434e-04 -1.092084e-03  1.220149e-03 -0.002013191
 [9,]  0.0243839280 -4.164471e-02 -2.133552e-03  6.008647e-02 -0.113067605
[10,] -0.0164988196  2.513079e-04  5.699752e-05 -3.418155e-06  0.008852964
> logLikValGradA <- mvProbitLogLik( cbind( y1, y2, y3, y4, y5 ) ~ x1 + x2 + x3,
+    coef = allCoef, data = as.data.frame( cbind( xMat, yMat ) ),
+    oneSidedGrad = TRUE )
> all.equal( logLikValGrad, logLikValGradA )
[1] TRUE
> 
> # calculating log likelihood value(s) with two-sided gradients
> llTmp <- function( coef ) {
+    betaTmp <- coef[ 1:20 ]
+    sigmaTmp <- diag( 5 )
+    sigmaTmp[ lower.tri( sigmaTmp ) ] <- coef[ -(1:20) ]
+    sigmaTmp[ upper.tri( sigmaTmp ) ] <- t( sigmaTmp )[ upper.tri( sigmaTmp ) ]
+    result <- mvProbitLogLik( cbind( y1, y2, y3, y4, y5 ) ~ x1 + x2 + x3,
+       coef = betaTmp, sigma = sigmaTmp, 
+       data = as.data.frame( cbind( xMat, yMat ) ) )
+    return( result )
+ }
> logLikValGrad2 <- numericGradient( llTmp, allCoef )
> print( logLikValGrad2 )
              [,1]         [,2]         [,3]         [,4]        [,5]
 [1,]  0.829645787  0.000000000  1.015554306 -0.885915439  0.07479032
 [2,] -0.210843382  0.000000000 -0.075864365  0.045958568 -0.48096627
 [3,]  0.541387742  0.541387742  0.216972751 -0.555466231 -1.40881560
 [4,]  0.033934831  0.033934831  0.003756000 -0.024734800  1.25977208
 [5,]  0.003771518  0.003771518 -0.002096365 -0.002357347  1.78318521
 [6,]  0.229644108  0.229644108  0.410354074 -0.387339182  0.03712907
 [7,] -0.185538931 -0.185538931 -0.092370646 -0.155442113 -0.05339749
 [8,]  0.195184154  0.000000000 -0.383852505  0.029936002 -0.06607566
 [9,]  0.415106501  0.000000000  0.291137394 -0.472448042  0.17791553
[10,] -0.420474161  0.000000000  0.198796571 -0.527196778 -0.00565330
             [,6]         [,7]         [,8]          [,9]       [,10]
 [1,]  0.00000000  0.091549474 -0.079862881 -7.296638e-02  0.00000000
 [2,]  0.00000000 -0.173058313  0.104838581 -7.277977e-01  0.00000000
 [3,] -1.40881560 -0.564613074  1.445451078 -9.941630e-01 -0.99416298
 [4,]  1.25977208  0.139434996 -0.918236822  8.198408e-01  0.81984076
 [5,]  1.78318521 -0.991167690 -1.114560777  1.725899e-01  0.17258986
 [6,]  0.03712907  0.066346421 -0.062625352 -2.293425e-02 -0.02293425
 [7,] -0.05339749 -0.026583966 -0.044735726  2.517571e-01  0.25175709
 [8,]  0.00000000  0.129945530 -0.010134230  3.901242e-03  0.00000000
 [9,]  0.00000000  0.124782104 -0.202492231 -2.095374e-01  0.00000000
[10,]  0.00000000  0.002672832 -0.007088193  8.132162e-06  0.00000000
              [,11]         [,12]      [,13]      [,14]       [,15]       [,16]
 [1,] -8.931681e-02  7.791523e-02  0.1057567  0.0000000  0.12945486 -0.11292952
 [2,] -2.618717e-01  1.586417e-01 -0.3569686  0.0000000 -0.12844224  0.07781020
 [3,] -3.984321e-01  1.020016e+00 -0.3336214 -0.3336214 -0.13370595  0.34229709
 [4,]  9.074220e-02 -5.975747e-01 -0.6192277 -0.6192277 -0.06853781  0.45134966
 [5,] -9.593255e-02 -1.078754e-01 -0.2113545 -0.2113545  0.11747951  0.13210484
 [6,] -4.098151e-02  3.868304e-02  0.2562315  0.2562315  0.45786351 -0.43218403
 [7,]  1.253374e-01  2.109188e-01 -0.0855654 -0.0855654 -0.04259877 -0.07168558
 [8,] -7.672250e-03  5.983456e-04 -0.1784976  0.0000000  0.35103649 -0.02737674
 [9,] -1.469603e-01  2.384823e-01  0.2509849  0.0000000  0.17602971 -0.28565513
[10,] -3.844480e-06  1.019629e-05  2.1488059  0.0000000 -1.01593697  2.69420490
             [,17]       [,18]        [,19]       [,20]         [,21]
 [1,] -0.374754462  0.00000000 -0.458730115 0.400171698  0.1253096387
 [2,] -1.317896170  0.00000000 -0.474197265 0.287268305  0.2373435311
 [3,] -0.235116392 -0.23511639 -0.094227938 0.241230464 -0.4565639489
 [4,] -0.702249319 -0.70224932 -0.077726861 0.511863370  0.0932493380
 [5,] -1.471345146 -1.47134514  0.817834156 0.919648493  0.0140945029
 [6,] -0.018413848 -0.01841385 -0.032903948 0.031058515  0.0296042829
 [7,]  0.258283228  0.25828323  0.128586428 0.216386342  0.0380969803
 [8,]  0.009751885  0.00000000 -0.019178224 0.001495677 -0.0008799655
 [9,] -0.561014446  0.00000000 -0.393470792 0.638511263  0.1742683349
[10,]  0.003719458  0.00000000 -0.001758528 0.004663511  0.0098217581
              [,22]         [,23]        [,24]         [,25]         [,26]
 [1,] -2.974299e-02  0.1686612452 -0.317886056 -0.0208711775  0.0003426259
 [2,]  2.127180e-01  0.1696969316  0.246140337  0.2225285902  0.1630177779
 [3,] -3.776616e-01 -0.0677244549 -0.159090152  1.0955898788  0.4824580824
 [4,]  5.409158e-02 -0.0027152378 -0.032249331  0.8408145913 -0.7549200984
 [5,]  3.817985e-03 -0.0000798539 -0.007061574  0.2433485378 -0.3932870731
 [6,] -2.598991e-03  0.1382851830 -0.004564789 -0.0038689896  0.0037047264
 [7,] -1.682984e-02  0.0492816124 -0.048184397 -0.0366696570  0.0034465556
 [8,]  2.860690e-03 -0.0043812432  0.001581939 -0.0012885915  0.0079515814
 [9,] -4.091164e-02  0.2153004817 -0.249286519 -0.0828866578  0.0243838705
[10,] -2.046363e-06 -0.6627932096 -0.001926267 -0.0000053344 -0.0164987584
              [,27]         [,28]         [,29]        [,30]
 [1,] -0.0054835436 -1.847995e-03  1.008905e-02 -0.032388242
 [2,]  0.8015301858  6.566873e-01  7.021445e-01  0.624207469
 [3,]  0.4457558145  7.163384e-01  1.268288e-01  0.151695541
 [4,] -0.7071316235 -1.072652e-01 -7.800969e-01  0.559949039
 [5,] -2.3316036613 -1.072568e-03 -3.269652e-01  0.343980942
 [6,]  0.0000909457  7.130633e-04 -1.813082e-04 -0.003323434
 [7,] -0.0034193386 -1.683588e-03  2.825669e-02 -0.018517049
 [8,]  0.0003547430 -1.092084e-03  1.220151e-03 -0.002013193
 [9,] -0.0416447714 -2.133556e-03  6.008642e-02 -0.113067650
[10,]  0.0002513065  5.699841e-05 -3.418599e-06  0.008852989
> attr( logLikValGrad, "gradient" ) / logLikValGrad2 - 1
              b_1_0         b_1_1         b_1_2         b_1_3         b_2_0
 [1,] -4.300940e-07           NaN -5.260569e-07  4.584180e-07 -1.154900e-06
 [2,]  9.414945e-07           NaN  3.336624e-07 -2.029191e-07  6.583323e-07
 [3,] -6.586844e-07 -6.586844e-07 -2.640309e-07  6.747688e-07  3.653419e-07
 [4,] -1.491865e-06 -1.491865e-06 -2.364693e-07  1.077241e-06 -3.532206e-07
 [5,] -1.766222e-06 -1.766222e-06  8.473510e-07  9.419258e-07 -2.692151e-07
 [6,] -7.812612e-07 -7.812612e-07 -1.395104e-06  1.315910e-06 -1.230456e-06
 [7,]  8.269576e-07  8.269576e-07  4.104563e-07  6.938800e-07  1.194481e-06
 [8,] -7.683174e-07           NaN  1.509862e-06 -1.168226e-07  1.011078e-06
 [9,] -6.611487e-07           NaN -4.629466e-07  7.529197e-07 -9.322813e-07
[10,]  6.601018e-07           NaN -3.127443e-07  8.263547e-07  1.728187e-06
              b_2_1         b_2_2         b_2_3         b_3_0         b_3_1
 [1,]           NaN -1.411586e-06  1.234463e-06  1.065088e-06           NaN
 [2,]           NaN  2.360835e-07 -1.397858e-07  6.754717e-07           NaN
 [3,]  3.653419e-07  1.455094e-07 -3.751306e-07  5.530104e-07  5.530104e-07
 [4,] -3.532206e-07 -3.503411e-08  2.577761e-07 -6.034286e-07 -6.028869e-07
 [5,] -2.692151e-07  1.496475e-07  1.677446e-07 -8.980083e-07 -8.980083e-07
 [6,] -1.230456e-06 -2.180405e-06  2.059109e-06  1.285258e-06  1.285258e-06
 [7,]  1.194481e-06  5.867685e-07  1.003863e-06 -7.322635e-07 -7.316020e-07
 [8,]           NaN -1.997103e-06  1.287233e-07 -1.522513e-06           NaN
 [9,]           NaN -6.530614e-07  1.060372e-06  8.509306e-07           NaN
[10,]           NaN -6.645973e-07  2.067515e-06 -5.460900e-05           NaN
              b_3_2         b_3_3         b_4_0         b_4_1         b_4_2
 [1,]  1.300196e-06 -1.137079e-06 -1.026694e-06           NaN -1.258977e-06
 [2,]  2.425033e-07 -1.427655e-07  9.753405e-07           NaN  3.526651e-07
 [3,]  2.206892e-07 -5.672935e-07  1.001000e-06  1.002331e-06  3.985664e-07
 [4,] -6.362155e-08  4.399463e-07  6.411466e-07  6.404294e-07  5.831530e-08
 [5,]  4.953225e-07  5.557525e-07  7.480124e-07  7.480124e-07 -4.120355e-07
 [6,]  2.305430e-06 -2.165453e-06 -7.363746e-07 -7.357247e-07 -1.310114e-06
 [7,] -3.627300e-07 -6.129631e-07  1.034119e-06  1.034119e-06  5.147309e-07
 [8,]  2.948391e-06 -4.638720e-08  7.826088e-07           NaN -1.539681e-06
 [9,]  5.998334e-07 -9.701789e-07 -8.024168e-07           NaN -5.638477e-07
[10,]  1.155135e-04  0.000000e+00 -2.273347e-07           NaN  1.079693e-07
              b_4_3         b_5_0         b_5_1         b_5_2         b_5_3
 [1,]  1.085355e-06  5.930994e-07           NaN  7.260629e-07 -6.325556e-07
 [2,] -2.111715e-07  3.464034e-07           NaN  1.245555e-07 -7.574929e-08
 [3,] -1.027525e-06  8.272969e-07  8.272969e-07  3.251918e-07 -8.468293e-07
 [4,] -4.663752e-07  5.153906e-07  5.153906e-07  6.284805e-08 -3.765355e-07
 [5,] -4.672683e-07  3.117855e-07  3.126910e-07 -1.737621e-07 -1.955705e-07
 [6,]  1.237808e-06  1.284237e-06  1.284237e-06  2.231989e-06 -2.125110e-06
 [7,]  8.727148e-07 -6.937733e-07 -6.937733e-07 -3.419088e-07 -5.815699e-07
 [8,]  1.196329e-07 -1.349087e-06           NaN  2.712136e-06 -2.783580e-07
 [9,]  9.125702e-07  5.101749e-07           NaN  3.589094e-07 -5.814441e-07
[10,] -2.849933e-07 -1.432755e-06           NaN  5.050693e-07 -1.904527e-06
              R_1_2         R_1_3         R_1_4         R_1_5         R_2_3
 [1,] -6.060129e-07 -9.107841e-07 -4.660454e-07  1.508768e-07 -1.010687e-06
 [2,]  3.835718e-07  2.505228e-07  7.877034e-07 -6.044108e-07  4.530126e-07
 [3,]  4.484041e-07  3.645265e-08 -2.386855e-06 -3.991747e-07 -9.241810e-07
 [4,] -2.371668e-06 -6.567961e-07 -6.542178e-06  2.754099e-08 -7.214740e-07
 [5,] -5.324847e-06  5.815754e-07 -1.112254e-05  2.263973e-06 -9.672024e-07
 [6,]  5.700320e-07 -1.452394e-06  4.969643e-07 -1.532252e-06 -1.922593e-06
 [7,]  8.043198e-07 -2.242896e-06  7.963697e-07 -7.695738e-07 -7.765881e-07
 [8,] -7.980041e-06  1.630004e-06 -4.054458e-06  2.000163e-06 -2.649355e-06
 [9,]  3.746011e-07 -1.535959e-06  3.382743e-07 -1.095586e-07 -8.009894e-07
[10,] -8.138671e-07  0.000000e+00  1.244910e-06 -1.383264e-06  0.000000e+00
              R_2_4         R_2_5         R_3_4         R_3_5         R_4_5
 [1,]  2.333042e-05 -3.603868e-06  8.891421e-06  1.804694e-06 -8.569646e-07
 [2,]  6.592507e-07 -4.421333e-07  5.552068e-07 -8.241156e-07 -6.153998e-07
 [3,] -6.903541e-07 -6.973828e-07  5.331512e-08  7.913359e-07  7.435859e-07
 [4,]  5.294339e-07  6.236188e-07 -3.229282e-06  1.098700e-07 -1.054808e-07
 [5,]  9.914140e-07  1.100127e-06 -3.312344e-06  9.914973e-07 -7.759081e-07
 [6,]  3.296452e-06  1.220754e-06  1.323430e-06  5.204891e-06 -1.920839e-06
 [7,]  2.415940e-06 -2.353998e-06  1.945344e-06  1.306413e-06 -4.976415e-07
 [8,]  1.675475e-06  1.173620e-06  4.066439e-07 -1.478598e-06 -1.158095e-06
 [9,]  2.358508e-06 -1.476929e-06 -1.769233e-06  8.573377e-07 -3.986556e-07
[10,]  3.714480e-06  5.301365e-06 -1.558251e-05 -1.299039e-04 -2.859270e-06
> range( attr( logLikValGrad, "gradient" ) / logLikValGrad2 - 1, na.rm = TRUE )
[1] -0.0001299039  0.0001155135
> attr( logLikValGrad, "gradient" ) - logLikValGrad2
              b_1_0         b_1_1         b_1_2         b_1_3         b_2_0
 [1,] -3.568257e-07  0.000000e+00 -5.342393e-07 -4.061196e-07 -8.637535e-08
 [2,] -1.985079e-07  0.000000e+00 -2.531308e-08 -9.325873e-09 -3.166356e-07
 [3,] -3.566036e-07 -3.566036e-07 -5.728751e-08 -3.748113e-07 -5.146994e-07
 [4,] -5.062617e-08 -5.062617e-08 -8.881784e-10 -2.664535e-08 -4.449774e-07
 [5,] -6.661338e-09 -6.661338e-09 -1.776357e-09 -2.220446e-09 -4.800604e-07
 [6,] -1.794120e-07 -1.794120e-07 -5.724865e-07 -5.097034e-07 -4.568568e-08
 [7,] -1.534328e-07 -1.534328e-07 -3.791412e-08 -1.078582e-07 -6.378231e-08
 [8,] -1.499634e-07  0.000000e+00 -5.795642e-07 -3.497203e-09 -6.680767e-08
 [9,] -2.744471e-07  0.000000e+00 -1.347811e-07 -3.557155e-07 -1.658673e-07
[10,] -2.775558e-07  0.000000e+00 -6.217249e-08 -4.356515e-07 -9.769963e-09
              b_2_1         b_2_2         b_2_3         b_3_0         b_3_1
 [1,]  0.000000e+00 -1.292300e-07 -9.858780e-08 -7.771561e-08  0.000000e+00
 [2,]  0.000000e+00 -4.085621e-08 -1.465494e-08 -4.916068e-07  0.000000e+00
 [3,] -5.146994e-07 -8.215650e-08 -5.422329e-07 -5.497824e-07 -5.497824e-07
 [4,] -4.449774e-07 -4.884981e-09 -2.366995e-07 -4.947154e-07 -4.942713e-07
 [5,] -4.800604e-07 -1.483258e-07 -1.869616e-07 -1.549871e-07 -1.549871e-07
 [6,] -4.568568e-08 -1.446621e-07 -1.289524e-07 -2.947642e-08 -2.947642e-08
 [7,] -6.378231e-08 -1.559863e-08 -4.490852e-08 -1.843525e-07 -1.841860e-07
 [8,]  0.000000e+00 -2.595146e-07 -1.304512e-09 -5.939693e-09  0.000000e+00
 [9,]  0.000000e+00 -8.149037e-08 -2.147171e-07 -1.783018e-07  0.000000e+00
[10,]  0.000000e+00 -1.776357e-09 -1.465494e-08 -4.440892e-10  0.000000e+00
              b_3_2         b_3_3         b_4_0         b_4_1         b_4_2
 [1,] -1.161293e-07 -8.859580e-08 -1.085798e-07  0.000000e+00 -1.629807e-07
 [2,] -6.350476e-08 -2.264855e-08 -3.481659e-07  0.000000e+00 -4.529710e-08
 [3,] -8.792966e-08 -5.786482e-07 -3.339551e-07 -3.343992e-07 -5.329071e-08
 [4,] -5.773160e-09 -2.629008e-07 -3.970158e-07 -3.965717e-07 -3.996803e-09
 [5,] -4.751755e-08 -5.995204e-08 -1.580958e-07 -1.580958e-07 -4.840572e-08
 [6,] -9.447998e-08 -8.376633e-08 -1.886824e-07 -1.885159e-07 -5.998535e-07
 [7,] -4.546363e-08 -1.292855e-07 -8.848478e-08 -8.848478e-08 -2.192690e-08
 [8,] -2.262079e-08 -2.775558e-11 -1.396938e-07  0.000000e+00 -5.404843e-07
 [9,] -8.815171e-08 -2.313705e-07 -2.013945e-07  0.000000e+00 -9.925394e-08
[10,] -4.440892e-10  0.000000e+00 -4.884981e-07  0.000000e+00 -1.096900e-07
              b_4_3         b_5_0         b_5_1         b_5_2         b_5_3
 [1,] -1.225686e-07 -2.222666e-07  0.000000e+00 -3.330669e-07 -2.531308e-07
 [2,] -1.643130e-08 -4.565237e-07  0.000000e+00 -5.906386e-08 -2.176037e-08
 [3,] -3.517187e-07 -1.945111e-07 -1.945111e-07 -3.064216e-08 -2.042810e-07
 [4,] -2.104983e-07 -3.619327e-07 -3.619327e-07 -4.884981e-09 -1.927347e-07
 [5,] -6.172840e-08 -4.587442e-07 -4.600764e-07 -1.421085e-07 -1.798561e-07
 [6,] -5.349610e-07 -2.364775e-08 -2.364775e-08 -7.344125e-08 -6.600276e-08
 [7,] -6.256107e-08 -1.791900e-07 -1.791900e-07 -4.396483e-08 -1.258438e-07
 [8,] -3.275158e-09 -1.315614e-08  0.000000e+00 -5.201395e-08 -4.163336e-10
 [9,] -2.606804e-07 -2.862155e-07  0.000000e+00 -1.412204e-07 -3.712586e-07
[10,] -7.678302e-07 -5.329071e-09  0.000000e+00 -8.881784e-10 -8.881784e-09
              R_1_2         R_1_3         R_1_4         R_1_5         R_2_3
 [1,] -7.593925e-08  2.708944e-08 -7.860379e-08 -4.796163e-08  2.109424e-08
 [2,]  9.103829e-08  5.329071e-08  1.336709e-07 -1.487699e-07  1.008083e-07
 [3,] -2.047251e-07 -1.376677e-08  1.616485e-07  6.350476e-08 -1.012523e-06
 [4,] -2.211564e-07 -3.552714e-08  1.776357e-08 -8.881784e-10 -6.066259e-07
 [5,] -7.505108e-08  2.220446e-09  8.881784e-10 -1.598721e-08 -2.353673e-07
 [6,]  1.687539e-08  3.774758e-09  6.872281e-08  6.994405e-09  7.438494e-09
 [7,]  3.064216e-08  3.774758e-08  3.924638e-08  3.708145e-08  2.847722e-08
 [8,]  7.022161e-09  4.662937e-09  1.776357e-08  3.164136e-09  3.413936e-09
 [9,]  6.528111e-08  6.283862e-08  7.283063e-08  2.731149e-08  6.639134e-08
[10,] -7.993606e-09  0.000000e+00 -8.251178e-07  2.664535e-09  0.000000e+00
              R_2_4         R_2_5         R_3_4         R_3_5         R_4_5
 [1,]  7.993606e-09  1.976197e-08 -1.643130e-08  1.820766e-08  2.775558e-08
 [2,]  1.074696e-07 -3.543832e-07  3.645972e-07 -5.786482e-07 -3.841372e-07
 [3,] -3.330669e-07 -3.108624e-07  3.819167e-08  1.003642e-07  1.127987e-07
 [4,] -3.996803e-07 -4.409806e-07  3.463896e-07 -8.570922e-08 -5.906386e-08
 [5,] -3.899103e-07 -2.565059e-06  3.552714e-09 -3.241851e-07 -2.668976e-07
 [6,]  1.221245e-08  1.110223e-10  9.436896e-10 -9.436896e-10  6.383782e-09
 [7,]  8.326673e-09  8.049117e-09 -3.275158e-09  3.691492e-08  9.214851e-09
 [8,]  1.332268e-08  4.163336e-10 -4.440892e-10 -1.804112e-09  2.331468e-09
 [9,]  5.750955e-08  6.150636e-08  3.774758e-09  5.151435e-08  4.507505e-08
[10,] -6.128431e-08  1.332268e-09 -8.881784e-10  4.440892e-10 -2.531308e-08
> range( attr( logLikValGrad, "gradient" ) - logLikValGrad2 )
[1] -2.565059e-06  3.645972e-07
> 
> 
> # calculating marginal effects, unconditional
> margEffUnc <- mvProbitMargEff( ~ x1 + x2 + x3, coef = c( beta ), 
+    sigma = sigma, data = as.data.frame( xMat ), vcov = diag( 30 ) )
> print( margEffUnc )
    d_y1_d_x1    d_y2_d_x1   d_y3_d_x1   d_y4_d_x1   d_y5_d_x1   d_y1_d_x2
1  0.30022083 -0.101464519 0.090508176 -0.31221387 -0.12670723 -0.39563009
2  0.31040386 -0.184442138 0.345407165 -0.34949923 -0.21749438 -0.35976963
3  0.18695410 -0.163375245 0.294865734 -0.37440842 -0.20795166 -0.14235062
4  0.20997038 -0.196612386 0.347203750 -0.37835836 -0.23577363 -0.16919883
5  0.11773675 -0.180060628 0.223207950 -0.32841650 -0.19785009 -0.07464373
6  0.26583825 -0.016680228 0.006338897 -0.14686925 -0.02221022 -0.24814991
7  0.08271741 -0.060258824 0.262678215 -0.19276333 -0.08227526 -0.17793370
8  0.07250167 -0.017894540 0.001392156 -0.07179704 -0.01294035 -0.15997331
9  0.21317464 -0.128477305 0.202910999 -0.34725111 -0.16705930 -0.35345887
10 0.14250870 -0.006527405 0.025157157 -0.05629614 -0.00863364 -0.09686617
    d_y2_d_x2    d_y3_d_x2  d_y4_d_x2    d_y5_d_x2  d_y1_d_x3   d_y2_d_x3
1  0.08785548 -0.051907110 0.10104257 -0.197645726 -0.5538821 -0.17571096
2  0.23757488 -0.489141511 0.19917743 -0.217295099 -0.5036775 -0.47514977
3  0.22339075 -0.513436559 0.19186689 -0.201297530 -0.1992909 -0.44678151
4  0.23636169 -0.463736616 0.16026813 -0.268580106 -0.2368784 -0.47272337
5  0.18950852 -0.188545546 0.11158058 -0.266847391 -0.1045012 -0.37901705
6  0.03264279 -0.024408812 0.12789672 -0.012080807 -0.3474099 -0.06528559
7  0.04680676 -0.245497593 0.04534161 -0.140343741 -0.2491072 -0.09361352
8  0.03478922 -0.006129201 0.07423544 -0.006447479 -0.2239626 -0.06957845
9  0.11839276 -0.162800358 0.12567873 -0.240993925 -0.4948424 -0.23678553
10 0.01381998 -0.082469724 0.06099062 -0.004045698 -0.1356126 -0.02763996
     d_y3_d_x3   d_y4_d_x3   d_y5_d_x3
1  0.031942837 -0.16166811 0.310586140
2  0.301010161 -0.31868389 0.341463727
3  0.315960960 -0.30698703 0.316324689
4  0.285376379 -0.25642901 0.422054452
5  0.116028028 -0.17852893 0.419331615
6  0.015020807 -0.20463475 0.018984125
7  0.151075442 -0.07254658 0.220540164
8  0.003771816 -0.11877670 0.010131753
9  0.100184836 -0.20108596 0.378704740
10 0.050750600 -0.09758499 0.006357526
> print( attr( margEffUnc, "vcov" )[ 1:3, , ] )
, , d_y1_d_x1

   d_y1_d_x1 d_y2_d_x1 d_y3_d_x1 d_y4_d_x1 d_y5_d_x1    d_y1_d_x2 d_y2_d_x2
1 0.12309248         0         0         0         0 -0.023002747         0
2 0.14156547         0         0         0         0 -0.001012113         0
3 0.09488643         0         0         0         0 -0.064427162         0
  d_y3_d_x2 d_y4_d_x2 d_y5_d_x2    d_y1_d_x3 d_y2_d_x3 d_y3_d_x3 d_y4_d_x3
1         0         0         0  0.052629931         0         0         0
2         0         0         0 -0.005593997         0         0         0
3         0         0         0 -0.048733710         0         0         0
  d_y5_d_x3
1         0
2         0
3         0

, , d_y2_d_x1

  d_y1_d_x1 d_y2_d_x1 d_y3_d_x1 d_y4_d_x1 d_y5_d_x1 d_y1_d_x2   d_y2_d_x2
1         0 0.1176381         0         0         0         0 -0.03165319
2         0 0.1133502         0         0         0         0 -0.01189123
3         0 0.1605197         0         0         0         0 -0.03430103
  d_y3_d_x2 d_y4_d_x2 d_y5_d_x2 d_y1_d_x3  d_y2_d_x3 d_y3_d_x3 d_y4_d_x3
1         0         0         0         0 0.08675534         0         0
2         0         0         0         0 0.01042278         0         0
3         0         0         0         0 0.06045213         0         0
  d_y5_d_x3
1         0
2         0
3         0

, , d_y3_d_x1

  d_y1_d_x1 d_y2_d_x1 d_y3_d_x1 d_y4_d_x1 d_y5_d_x1 d_y1_d_x2 d_y2_d_x2
1         0         0 0.1089040         0         0         0         0
2         0         0 0.1180167         0         0         0         0
3         0         0 0.2148571         0         0         0         0
     d_y3_d_x2 d_y4_d_x2 d_y5_d_x2 d_y1_d_x3 d_y2_d_x3    d_y3_d_x3 d_y4_d_x3
1 -0.051220515         0         0         0         0  0.029714863         0
2  0.002142509         0         0         0         0 -0.001365406         0
3 -0.029282101         0         0         0         0 -0.032218404         0
  d_y5_d_x3
1         0
2         0
3         0

, , d_y4_d_x1

  d_y1_d_x1 d_y2_d_x1 d_y3_d_x1  d_y4_d_x1 d_y5_d_x1 d_y1_d_x2 d_y2_d_x2
1         0         0         0 0.28808112         0         0         0
2         0         0         0 0.08922879         0         0         0
3         0         0         0 0.16008490         0         0         0
  d_y3_d_x2   d_y4_d_x2 d_y5_d_x2 d_y1_d_x3 d_y2_d_x3 d_y3_d_x3    d_y4_d_x3
1         0 -0.03474284         0         0         0         0  0.089964595
2         0 -0.01869853         0         0         0         0  0.009523263
3         0  0.04120385         0         0         0         0 -0.077257996
  d_y5_d_x3
1         0
2         0
3         0

, , d_y5_d_x1

  d_y1_d_x1 d_y2_d_x1 d_y3_d_x1 d_y4_d_x1  d_y5_d_x1 d_y1_d_x2 d_y2_d_x2
1         0         0         0         0 0.09095774         0         0
2         0         0         0         0 0.16603969         0         0
3         0         0         0         0 0.10605961         0         0
  d_y3_d_x2 d_y4_d_x2   d_y5_d_x2 d_y1_d_x3 d_y2_d_x3 d_y3_d_x3 d_y4_d_x3
1         0         0  0.03508885         0         0         0         0
2         0         0  0.02524779         0         0         0         0
3         0         0 -0.02163941         0         0         0         0
    d_y5_d_x3
1 -0.08878953
2 -0.03036311
3  0.04571887

, , d_y1_d_x2

     d_y1_d_x1 d_y2_d_x1 d_y3_d_x1 d_y4_d_x1 d_y5_d_x1 d_y1_d_x2 d_y2_d_x2
1 -0.023002747         0         0         0         0 0.1165563         0
2 -0.001012113         0         0         0         0 0.1185857         0
3 -0.064427162         0         0         0         0 0.1777834         0
  d_y3_d_x2 d_y4_d_x2 d_y5_d_x2    d_y1_d_x3 d_y2_d_x3 d_y3_d_x3 d_y4_d_x3
1         0         0         0 0.0002303443         0         0         0
2         0         0         0 0.0272418292         0         0         0
3         0         0         0 0.1743706773         0         0         0
  d_y5_d_x3
1         0
2         0
3         0

, , d_y2_d_x2

  d_y1_d_x1   d_y2_d_x1 d_y3_d_x1 d_y4_d_x1 d_y5_d_x1 d_y1_d_x2  d_y2_d_x2
1         0 -0.03165319         0         0         0         0 0.03312624
2         0 -0.01189123         0         0         0         0 0.16604549
3         0 -0.03430103         0         0         0         0 0.13597032
  d_y3_d_x2 d_y4_d_x2 d_y5_d_x2 d_y1_d_x3   d_y2_d_x3 d_y3_d_x3 d_y4_d_x3
1         0         0         0         0 -0.04851421         0         0
2         0         0         0         0 -0.01280892         0         0
3         0         0         0         0  0.01217805         0         0
  d_y5_d_x3
1         0
2         0
3         0

, , d_y3_d_x2

  d_y1_d_x1 d_y2_d_x1    d_y3_d_x1 d_y4_d_x1 d_y5_d_x1 d_y1_d_x2 d_y2_d_x2
1         0         0 -0.051220515         0         0         0         0
2         0         0  0.002142509         0         0         0         0
3         0         0 -0.029282101         0         0         0         0
  d_y3_d_x2 d_y4_d_x2 d_y5_d_x2 d_y1_d_x3 d_y2_d_x3   d_y3_d_x3 d_y4_d_x3
1 0.0358384         0         0         0         0 -0.01967438         0
2 0.1291948         0         0         0         0  0.00736773         0
3 0.1499578         0         0         0         0  0.02611864         0
  d_y5_d_x3
1         0
2         0
3         0

, , d_y4_d_x2

  d_y1_d_x1 d_y2_d_x1 d_y3_d_x1   d_y4_d_x1 d_y5_d_x1 d_y1_d_x2 d_y2_d_x2
1         0         0         0 -0.03474284         0         0         0
2         0         0         0 -0.01869853         0         0         0
3         0         0         0  0.04120385         0         0         0
  d_y3_d_x2  d_y4_d_x2 d_y5_d_x2 d_y1_d_x3 d_y2_d_x3 d_y3_d_x3    d_y4_d_x3
1         0 0.03309815         0         0         0         0 -0.008784706
2         0 0.15572480         0         0         0         0  0.003228043
3         0 0.17287304         0         0         0         0 -0.048903509
  d_y5_d_x3
1         0
2         0
3         0

, , d_y5_d_x2

  d_y1_d_x1 d_y2_d_x1 d_y3_d_x1 d_y4_d_x1   d_y5_d_x1 d_y1_d_x2 d_y2_d_x2
1         0         0         0         0  0.03508885         0         0
2         0         0         0         0  0.02524779         0         0
3         0         0         0         0 -0.02163941         0         0
  d_y3_d_x2 d_y4_d_x2 d_y5_d_x2 d_y1_d_x3 d_y2_d_x3 d_y3_d_x3 d_y4_d_x3
1         0         0 0.0643978         0         0         0         0
2         0         0 0.1586671         0         0         0         0
3         0         0 0.1303623         0         0         0         0
    d_y5_d_x3
1 -0.01557010
2 -0.08132997
3 -0.05637710

, , d_y1_d_x3

     d_y1_d_x1 d_y2_d_x1 d_y3_d_x1 d_y4_d_x1 d_y5_d_x1    d_y1_d_x2 d_y2_d_x2
1  0.052629931         0         0         0         0 0.0002303443         0
2 -0.005593997         0         0         0         0 0.0272418292         0
3 -0.048733710         0         0         0         0 0.1743706773         0
  d_y3_d_x2 d_y4_d_x2 d_y5_d_x2 d_y1_d_x3 d_y2_d_x3 d_y3_d_x3 d_y4_d_x3
1         0         0         0 0.2355878         0         0         0
2         0         0         0 0.2270965         0         0         0
3         0         0         0 0.1997296         0         0         0
  d_y5_d_x3
1         0
2         0
3         0

, , d_y2_d_x3

  d_y1_d_x1  d_y2_d_x1 d_y3_d_x1 d_y4_d_x1 d_y5_d_x1 d_y1_d_x2   d_y2_d_x2
1         0 0.08675534         0         0         0         0 -0.04851421
2         0 0.01042278         0         0         0         0 -0.01280892
3         0 0.06045213         0         0         0         0  0.01217805
  d_y3_d_x2 d_y4_d_x2 d_y5_d_x2 d_y1_d_x3 d_y2_d_x3 d_y3_d_x3 d_y4_d_x3
1         0         0         0         0 0.1688054         0         0
2         0         0         0         0 0.1708036         0         0
3         0         0         0         0 0.1004513         0         0
  d_y5_d_x3
1         0
2         0
3         0

, , d_y3_d_x3

  d_y1_d_x1 d_y2_d_x1    d_y3_d_x1 d_y4_d_x1 d_y5_d_x1 d_y1_d_x2 d_y2_d_x2
1         0         0  0.029714863         0         0         0         0
2         0         0 -0.001365406         0         0         0         0
3         0         0 -0.032218404         0         0         0         0
    d_y3_d_x2 d_y4_d_x2 d_y5_d_x2 d_y1_d_x3 d_y2_d_x3  d_y3_d_x3 d_y4_d_x3
1 -0.01967438         0         0         0         0 0.01284096         0
2  0.00736773         0         0         0         0 0.13718014         0
3  0.02611864         0         0         0         0 0.12609641         0
  d_y5_d_x3
1         0
2         0
3         0

, , d_y4_d_x3

  d_y1_d_x1 d_y2_d_x1 d_y3_d_x1    d_y4_d_x1 d_y5_d_x1 d_y1_d_x2 d_y2_d_x2
1         0         0         0  0.089964595         0         0         0
2         0         0         0  0.009523263         0         0         0
3         0         0         0 -0.077257996         0         0         0
  d_y3_d_x2    d_y4_d_x2 d_y5_d_x2 d_y1_d_x3 d_y2_d_x3 d_y3_d_x3  d_y4_d_x3
1         0 -0.008784706         0         0         0         0 0.08876333
2         0  0.003228043         0         0         0         0 0.15611430
3         0 -0.048903509         0         0         0         0 0.23825901
  d_y5_d_x3
1         0
2         0
3         0

, , d_y5_d_x3

  d_y1_d_x1 d_y2_d_x1 d_y3_d_x1 d_y4_d_x1   d_y5_d_x1 d_y1_d_x2 d_y2_d_x2
1         0         0         0         0 -0.08878953         0         0
2         0         0         0         0 -0.03036311         0         0
3         0         0         0         0  0.04571887         0         0
  d_y3_d_x2 d_y4_d_x2   d_y5_d_x2 d_y1_d_x3 d_y2_d_x3 d_y3_d_x3 d_y4_d_x3
1         0         0 -0.01557010         0         0         0         0
2         0         0 -0.08132997         0         0         0         0
3         0         0 -0.05637710         0         0         0         0
  d_y5_d_x3
1 0.1666258
2 0.1978661
3 0.1421337

> print( drop( attr( margEffUnc, "vcov" )[ nObs, , ] ) )
            d_y1_d_x1    d_y2_d_x1    d_y3_d_x1   d_y4_d_x1     d_y5_d_x1
d_y1_d_x1  0.15708494  0.000000000  0.000000000  0.00000000  0.0000000000
d_y2_d_x1  0.00000000  0.000834004  0.000000000  0.00000000  0.0000000000
d_y3_d_x1  0.00000000  0.000000000  0.008794366  0.00000000  0.0000000000
d_y4_d_x1  0.00000000  0.000000000  0.000000000  0.03172909  0.0000000000
d_y5_d_x1  0.00000000  0.000000000  0.000000000  0.00000000  0.0021055942
d_y1_d_x2 -0.08693992  0.000000000  0.000000000  0.00000000  0.0000000000
d_y2_d_x2  0.00000000 -0.001373323  0.000000000  0.00000000  0.0000000000
d_y3_d_x2  0.00000000  0.000000000 -0.023034011  0.00000000  0.0000000000
d_y4_d_x2  0.00000000  0.000000000  0.000000000 -0.02172697  0.0000000000
d_y5_d_x2  0.00000000  0.000000000  0.000000000  0.00000000  0.0006630807
d_y1_d_x3 -0.08954355  0.000000000  0.000000000  0.00000000  0.0000000000
d_y2_d_x3  0.00000000  0.002626979  0.000000000  0.00000000  0.0000000000
d_y3_d_x3  0.00000000  0.000000000  0.010759543  0.00000000  0.0000000000
d_y4_d_x3  0.00000000  0.000000000  0.000000000  0.02833089  0.0000000000
d_y5_d_x3  0.00000000  0.000000000  0.000000000  0.00000000 -0.0009720850
            d_y1_d_x2    d_y2_d_x2   d_y3_d_x2   d_y4_d_x2     d_y5_d_x2
d_y1_d_x1 -0.08693992  0.000000000  0.00000000  0.00000000  0.0000000000
d_y2_d_x1  0.00000000 -0.001373323  0.00000000  0.00000000  0.0000000000
d_y3_d_x1  0.00000000  0.000000000 -0.02303401  0.00000000  0.0000000000
d_y4_d_x1  0.00000000  0.000000000  0.00000000 -0.02172697  0.0000000000
d_y5_d_x1  0.00000000  0.000000000  0.00000000  0.00000000  0.0006630807
d_y1_d_x2  0.09856223  0.000000000  0.00000000  0.00000000  0.0000000000
d_y2_d_x2  0.00000000  0.002857405  0.00000000  0.00000000  0.0000000000
d_y3_d_x2  0.00000000  0.000000000  0.06443728  0.00000000  0.0000000000
d_y4_d_x2  0.00000000  0.000000000  0.00000000  0.02868620  0.0000000000
d_y5_d_x2  0.00000000  0.000000000  0.00000000  0.00000000  0.0003592029
d_y1_d_x3  0.09461501  0.000000000  0.00000000  0.00000000  0.0000000000
d_y2_d_x3  0.00000000 -0.004419117  0.00000000  0.00000000  0.0000000000
d_y3_d_x3  0.00000000  0.000000000 -0.02751009  0.00000000  0.0000000000
d_y4_d_x3  0.00000000  0.000000000  0.00000000 -0.01640444  0.0000000000
d_y5_d_x3  0.00000000  0.000000000  0.00000000  0.00000000 -0.0004740438
            d_y1_d_x3    d_y2_d_x3   d_y3_d_x3   d_y4_d_x3     d_y5_d_x3
d_y1_d_x1 -0.08954355  0.000000000  0.00000000  0.00000000  0.0000000000
d_y2_d_x1  0.00000000  0.002626979  0.00000000  0.00000000  0.0000000000
d_y3_d_x1  0.00000000  0.000000000  0.01075954  0.00000000  0.0000000000
d_y4_d_x1  0.00000000  0.000000000  0.00000000  0.02833089  0.0000000000
d_y5_d_x1  0.00000000  0.000000000  0.00000000  0.00000000 -0.0009720850
d_y1_d_x2  0.09461501  0.000000000  0.00000000  0.00000000  0.0000000000
d_y2_d_x2  0.00000000 -0.004419117  0.00000000  0.00000000  0.0000000000
d_y3_d_x2  0.00000000  0.000000000 -0.02751009  0.00000000  0.0000000000
d_y4_d_x2  0.00000000  0.000000000  0.00000000 -0.01640444  0.0000000000
d_y5_d_x2  0.00000000  0.000000000  0.00000000  0.00000000 -0.0004740438
d_y1_d_x3  0.09950780  0.000000000  0.00000000  0.00000000  0.0000000000
d_y2_d_x3  0.00000000  0.008900873  0.00000000  0.00000000  0.0000000000
d_y3_d_x3  0.00000000  0.000000000  0.01501614  0.00000000  0.0000000000
d_y4_d_x3  0.00000000  0.000000000  0.00000000  0.03200662  0.0000000000
d_y5_d_x3  0.00000000  0.000000000  0.00000000  0.00000000  0.0007206491
> summary( margEffUnc )
               Estimate Std. error z value Pr(> z)
1: d_y1_d_x1   0.300221   0.350845   0.856   0.392
1: d_y2_d_x1  -0.101465   0.342984  -0.296   0.767
1: d_y3_d_x1   0.090508   0.330006   0.274   0.784
1: d_y4_d_x1  -0.312214   0.536732  -0.582   0.561
1: d_y5_d_x1  -0.126707   0.301592  -0.420   0.674
1: d_y1_d_x2  -0.395630   0.341403  -1.159   0.247
1: d_y2_d_x2   0.087855   0.182006   0.483   0.629
1: d_y3_d_x2  -0.051907   0.189310  -0.274   0.784
1: d_y4_d_x2   0.101043   0.181929   0.555   0.579
1: d_y5_d_x2  -0.197646   0.253767  -0.779   0.436
1: d_y1_d_x3  -0.553882   0.485374  -1.141   0.254
1: d_y2_d_x3  -0.175711   0.410859  -0.428   0.669
1: d_y3_d_x3   0.031943   0.113318   0.282   0.778
1: d_y4_d_x3  -0.161668   0.297932  -0.543   0.587
1: d_y5_d_x3   0.310586   0.408198   0.761   0.447
2: d_y1_d_x1   0.310404   0.376252   0.825   0.409
2: d_y2_d_x1  -0.184442   0.336675  -0.548   0.584
2: d_y3_d_x1   0.345407   0.343536   1.005   0.315
2: d_y4_d_x1  -0.349499   0.298712  -1.170   0.242
2: d_y5_d_x1  -0.217494   0.407480  -0.534   0.594
2: d_y1_d_x2  -0.359770   0.344363  -1.045   0.296
2: d_y2_d_x2   0.237575   0.407487   0.583   0.560
2: d_y3_d_x2  -0.489142   0.359437  -1.361   0.174
2: d_y4_d_x2   0.199177   0.394620   0.505   0.614
2: d_y5_d_x2  -0.217295   0.398330  -0.546   0.585
2: d_y1_d_x3  -0.503677   0.476546  -1.057   0.291
2: d_y2_d_x3  -0.475150   0.413284  -1.150   0.250
2: d_y3_d_x3   0.301010   0.370378   0.813   0.416
2: d_y4_d_x3  -0.318684   0.395113  -0.807   0.420
2: d_y5_d_x3   0.341464   0.444821   0.768   0.443
3: d_y1_d_x1   0.186954   0.308036   0.607   0.544
3: d_y2_d_x1  -0.163375   0.400649  -0.408   0.683
3: d_y3_d_x1   0.294866   0.463527   0.636   0.525
3: d_y4_d_x1  -0.374408   0.400106  -0.936   0.349
3: d_y5_d_x1  -0.207952   0.325668  -0.639   0.523
3: d_y1_d_x2  -0.142351   0.421644  -0.338   0.736
3: d_y2_d_x2   0.223391   0.368742   0.606   0.545
3: d_y3_d_x2  -0.513437   0.387244  -1.326   0.185
3: d_y4_d_x2   0.191867   0.415780   0.461   0.644
3: d_y5_d_x2  -0.201298   0.361057  -0.558   0.577
3: d_y1_d_x3  -0.199291   0.446911  -0.446   0.656
3: d_y2_d_x3  -0.446782   0.316941  -1.410   0.159
3: d_y3_d_x3   0.315961   0.355101   0.890   0.374
3: d_y4_d_x3  -0.306987   0.488118  -0.629   0.529
3: d_y5_d_x3   0.316325   0.377006   0.839   0.401
4: d_y1_d_x1   0.209970   0.281552   0.746   0.456
4: d_y2_d_x1  -0.196612   0.394538  -0.498   0.618
4: d_y3_d_x1   0.347204   0.356841   0.973   0.331
4: d_y4_d_x1  -0.378358   0.328052  -1.153   0.249
4: d_y5_d_x1  -0.235774   0.383731  -0.614   0.539
4: d_y1_d_x2  -0.169199   0.402356  -0.421   0.674
4: d_y2_d_x2   0.236362   0.402699   0.587   0.557
4: d_y3_d_x2  -0.463737   0.516636  -0.898   0.369
4: d_y4_d_x2   0.160268   0.372685   0.430   0.667
4: d_y5_d_x2  -0.268580   0.393823  -0.682   0.495
4: d_y1_d_x3  -0.236878   0.443990  -0.534   0.594
4: d_y2_d_x3  -0.472723   0.461191  -1.025   0.305
4: d_y3_d_x3   0.285376   0.493729   0.578   0.563
4: d_y4_d_x3  -0.256429   0.505198  -0.508   0.612
4: d_y5_d_x3   0.422054   0.341484   1.236   0.216
5: d_y1_d_x1   0.117737   0.221365   0.532   0.595
5: d_y2_d_x1  -0.180061   0.331195  -0.544   0.587
5: d_y3_d_x1   0.223208   0.301778   0.740   0.460
5: d_y4_d_x1  -0.328417   0.318745  -1.030   0.303
5: d_y5_d_x1  -0.197850   0.409870  -0.483   0.629
5: d_y1_d_x2  -0.074644   0.211344  -0.353   0.724
5: d_y2_d_x2   0.189509   0.315506   0.601   0.548
5: d_y3_d_x2  -0.188546   0.414847  -0.454   0.649
5: d_y4_d_x2   0.111581   0.242884   0.459   0.646
5: d_y5_d_x2  -0.266847   0.358758  -0.744   0.457
5: d_y1_d_x3  -0.104501   0.294236  -0.355   0.722
5: d_y2_d_x3  -0.379017   0.618979  -0.612   0.540
5: d_y3_d_x3   0.116028   0.352728   0.329   0.742
5: d_y4_d_x3  -0.178529   0.451020  -0.396   0.692
5: d_y5_d_x3   0.419332   0.498765   0.841   0.400
6: d_y1_d_x1   0.265838   0.457250   0.581   0.561
6: d_y2_d_x1  -0.016680   0.111551  -0.150   0.881
6: d_y3_d_x1   0.006339   0.049889   0.127   0.899
6: d_y4_d_x1  -0.146869   0.577959  -0.254   0.799
6: d_y5_d_x1  -0.022210   0.127420  -0.174   0.862
6: d_y1_d_x2  -0.248150   0.863884  -0.287   0.774
6: d_y2_d_x2   0.032643   0.156197   0.209   0.834
6: d_y3_d_x2  -0.024409   0.159910  -0.153   0.879
6: d_y4_d_x2   0.127897   0.268387   0.477   0.634
6: d_y5_d_x2  -0.012081   0.076151  -0.159   0.874
6: d_y1_d_x3  -0.347410   0.836212  -0.415   0.678
6: d_y2_d_x3  -0.065286   0.339833  -0.192   0.848
6: d_y3_d_x3   0.015021   0.095319   0.158   0.875
6: d_y4_d_x3  -0.204635   0.445032  -0.460   0.646
6: d_y5_d_x3   0.018984   0.125399   0.151   0.880
7: d_y1_d_x1   0.082717   0.255370   0.324   0.746
7: d_y2_d_x1  -0.060259   0.150153  -0.401   0.688
7: d_y3_d_x1   0.262678   0.325443   0.807   0.420
7: d_y4_d_x1  -0.192763   0.316121  -0.610   0.542
7: d_y5_d_x1  -0.082275   0.259199  -0.317   0.751
7: d_y1_d_x2  -0.177934   0.377357  -0.472   0.637
7: d_y2_d_x2   0.046807   0.183712   0.255   0.799
7: d_y3_d_x2  -0.245498   0.598324  -0.410   0.682
7: d_y4_d_x2   0.045342   0.182317   0.249   0.804
7: d_y5_d_x2  -0.140344   0.391109  -0.359   0.720
7: d_y1_d_x3  -0.249107   0.482540  -0.516   0.606
7: d_y2_d_x3  -0.093614   0.261430  -0.358   0.720
7: d_y3_d_x3   0.151075   0.279003   0.541   0.588
7: d_y4_d_x3  -0.072547   0.187742  -0.386   0.699
7: d_y5_d_x3   0.220540   0.388103   0.568   0.570
8: d_y1_d_x1   0.072502   0.269575   0.269   0.788
8: d_y2_d_x1  -0.017895   0.087959  -0.203   0.839
8: d_y3_d_x1   0.001392   0.009953   0.140   0.889
8: d_y4_d_x1  -0.071797   0.280408  -0.256   0.798
8: d_y5_d_x1  -0.012940   0.078846  -0.164   0.870
8: d_y1_d_x2  -0.159973   0.343933  -0.465   0.642
8: d_y2_d_x2   0.034789   0.103019   0.338   0.736
8: d_y3_d_x2  -0.006129   0.036380  -0.168   0.866
8: d_y4_d_x2   0.074235   0.119898   0.619   0.536
8: d_y5_d_x2  -0.006447   0.031230  -0.206   0.836
8: d_y1_d_x3  -0.223963   0.699125  -0.320   0.749
8: d_y2_d_x3  -0.069578   0.303764  -0.229   0.819
8: d_y3_d_x3   0.003772   0.025055   0.151   0.880
8: d_y4_d_x3  -0.118777   0.388414  -0.306   0.760
8: d_y5_d_x3   0.010132   0.061572   0.165   0.869
9: d_y1_d_x1   0.213175   0.347276   0.614   0.539
9: d_y2_d_x1  -0.128477   0.371546  -0.346   0.729
9: d_y3_d_x1   0.202911   0.472726   0.429   0.668
9: d_y4_d_x1  -0.347251   0.468379  -0.741   0.458
9: d_y5_d_x1  -0.167059   0.308478  -0.542   0.588
9: d_y1_d_x2  -0.353459   0.543614  -0.650   0.516
9: d_y2_d_x2   0.118393   0.234620   0.505   0.614
9: d_y3_d_x2  -0.162800   0.378574  -0.430   0.667
9: d_y4_d_x2   0.125679   0.247425   0.508   0.611
9: d_y5_d_x2  -0.240994   0.320972  -0.751   0.453
9: d_y1_d_x3  -0.494842   0.307121  -1.611   0.107
9: d_y2_d_x3  -0.236786   0.364381  -0.650   0.516
9: d_y3_d_x3   0.100185   0.192422   0.521   0.603
9: d_y4_d_x3  -0.201086   0.238168  -0.844   0.399
9: d_y5_d_x3   0.378705   0.274251   1.381   0.167
10: d_y1_d_x1  0.142509   0.396339   0.360   0.719
10: d_y2_d_x1 -0.006527   0.028879  -0.226   0.821
10: d_y3_d_x1  0.025157   0.093778   0.268   0.788
10: d_y4_d_x1 -0.056296   0.178127  -0.316   0.752
10: d_y5_d_x1 -0.008634   0.045887  -0.188   0.851
10: d_y1_d_x2 -0.096866   0.313946  -0.309   0.758
10: d_y2_d_x2  0.013820   0.053455   0.259   0.796
10: d_y3_d_x2 -0.082470   0.253845  -0.325   0.745
10: d_y4_d_x2  0.060991   0.169370   0.360   0.719
10: d_y5_d_x2 -0.004046   0.018953  -0.213   0.831
10: d_y1_d_x3 -0.135613   0.315449  -0.430   0.667
10: d_y2_d_x3 -0.027640   0.094344  -0.293   0.770
10: d_y3_d_x3  0.050751   0.122540   0.414   0.679
10: d_y4_d_x3 -0.097585   0.178904  -0.545   0.585
10: d_y5_d_x3  0.006358   0.026845   0.237   0.813
> margEffUncA <- mvProbitMargEff( ~ x1 + x2 + x3, coef = allCoef,
+    data = as.data.frame( xMat ), vcov = diag( 30 ) )
> all.equal( margEffUnc, margEffUncA )
[1] TRUE
> 
> # calculating marginal effects, conditional
> # (assuming that all other dependent variables are one)
> margEffCond <- mvProbitMargEff( ~ x1 + x2 + x3, coef = c( beta ), 
+    sigma = sigma, data = as.data.frame( xMat ), cond = TRUE )
> print( margEffCond )
      d_y1_d_x1    d_y2_d_x1    d_y3_d_x1     d_y4_d_x1     d_y5_d_x1
1  9.925802e-02 -0.041108025 2.910558e-02 -2.673108e-04 -2.010949e-02
2  2.466377e-01 -0.227709649 4.819333e-01 -6.286228e-01 -1.943769e-02
3  4.212441e-02 -0.072501348 3.795937e-01 -1.163079e-01 -5.231133e-02
4  5.926263e-02 -0.126986939 5.580497e-01 -4.958615e-01 -3.999822e-02
5  7.491067e-03 -0.164543180 1.450556e-01 -5.360900e-01 -6.523680e-02
6  2.497408e-02 -0.002649304 1.138405e-04 -8.950992e-06 -2.173222e-04
7  6.188370e-01 -0.270896703 9.722331e-02 -6.420146e-01 -1.921790e-03
8  1.525634e-05 -0.014876729 1.291687e-05 -5.755765e-02 -3.409305e-05
9  4.516851e-02 -0.051820386 1.452736e-01 -1.210811e-02 -4.254871e-02
10 1.967823e-01 -0.021202557 1.603820e-04 -1.186529e-01  7.608178e-05
       d_y1_d_x2   d_y2_d_x2     d_y3_d_x2     d_y4_d_x2     d_y5_d_x2
1  -1.531435e-01 0.077935542 -1.944982e-02  2.592948e-05 -0.1090486631
2  -4.137112e-01 0.359684281 -6.716675e-01  2.251131e-01 -0.4229615793
3  -1.746198e-02 0.193425397 -9.476729e-01  4.743547e-01 -0.4218206773
4  -9.915758e-03 0.304400468 -4.505573e-01  6.900180e-01 -0.4797086108
5   6.220446e-05 0.274378117 -8.324586e-03  2.080557e-01 -0.2374978845
6  -1.075015e-02 0.009675403 -7.673353e-04 -4.701683e-05 -0.0004797448
7  -4.005841e-01 0.153215835 -6.413457e-03  2.053763e-01 -0.0255627163
8  -2.743938e-05 0.029831622 -4.700906e-06  6.862575e-02 -0.0000652447
9  -8.560854e-02 0.120954713 -9.343223e-02  8.112977e-05 -0.2409295695
10 -5.543774e-01 0.066425617 -8.285252e-04  2.539360e-01 -0.0002282126
       d_y1_d_x3   d_y2_d_x3    d_y3_d_x3     d_y4_d_x3     d_y5_d_x3
1  -3.632295e-01 -0.08943891 1.977093e-02  1.591483e-05  1.420249e-01
2  -3.768491e-01 -0.31931165 6.044471e-01 -1.631424e-01  5.241591e-01
3  -1.135030e-02 -0.41175299 7.904933e-01 -4.635800e-01  5.500869e-01
4  -3.314625e-03 -0.58210715 3.636302e-01 -7.025071e-01  7.061239e-01
5  -1.089353e-04 -0.51893323 6.279868e-03 -2.654331e-01  3.940516e-01
6  -3.301153e-02 -0.01901206 6.541076e-04 -6.812551e-05  5.968163e-04
7  -1.334499e-01 -0.13121740 4.717144e-03 -1.176622e-01  3.699710e-02
8   9.812151e-07 -0.05810581 8.723688e-06 -1.066800e-01  1.091345e-04
9  -1.744345e-01 -0.17772451 8.521228e-02  8.664247e-05  3.140598e-01
10 -1.859217e-01 -0.04826082 3.932131e-04 -1.184161e-01 -6.966039e-05
> margEffCondA <- mvProbitMargEff( ~ x1 + x2 + x3, coef = allCoef,
+    data = as.data.frame( xMat ), cond = TRUE )
> all.equal( margEffCond, margEffCondA )
[1] TRUE
> # now with variance covariance matrix
> margEffCondV <- mvProbitMargEff( ~ x1 + x2 + x3, coef = c( beta ), 
+    sigma = sigma, data = as.data.frame( xMat )[ c(1,5,10), ], cond = TRUE, 
+    vcov = diag( 30 ) )
> print( attr( margEffCondV, "vcov" ) )
, , d_y1_d_x1

     d_y1_d_x1    d_y2_d_x1    d_y3_d_x1    d_y4_d_x1    d_y5_d_x1
1  0.681209658  0.032844571  0.046417164  0.000319013 -0.020617448
5  0.009424934  0.001570433 -0.006289361 -0.012018177 -0.004297131
10 3.544598352 -0.117497119  0.001242507 -0.785882468  0.001406431
       d_y1_d_x2    d_y2_d_x2     d_y3_d_x2    d_y4_d_x2    d_y5_d_x2
1  -1.1170099986 -0.153363371 -0.0284878247 0.0002824941 -0.074562197
5  -0.0003525852  0.005832674  0.0017104969 0.0071225596 -0.004608448
10 -4.2021352220  0.175587394  0.0002986687 0.6978450820 -0.001535983
       d_y1_d_x3   d_y2_d_x3    d_y3_d_x3     d_y4_d_x3    d_y5_d_x3
1  -1.515444e+00  0.31906917  0.020875013  0.0001066799  0.063899927
5  -7.923244e-05 -0.01583947 -0.001202905 -0.0073401196  0.009733010
10 -3.100452e+00 -0.20033565 -0.002451212 -0.1944697181 -0.001137893

, , d_y2_d_x1

      d_y1_d_x1  d_y2_d_x1     d_y3_d_x1     d_y4_d_x1     d_y5_d_x1
1   0.032844571 0.13376346  1.441998e-02 -0.0001593828 -1.836871e-03
5   0.001570433 0.24735075  1.133995e-01 -0.0422548363 -8.146955e-02
10 -0.117497119 0.02083594 -3.859274e-05  0.0606982137 -4.583743e-05
       d_y1_d_x2   d_y2_d_x2     d_y3_d_x2     d_y4_d_x2     d_y5_d_x2
1  -0.0376041694 -0.13975251 -6.133919e-03  0.0001457757  2.409118e-03
5  -0.0002065744  0.09598809 -1.646091e-02  0.0668534844 -8.824679e-02
10  0.1543604560 -0.05363025 -6.815757e-05 -0.0716015017  5.614674e-05
       d_y1_d_x3   d_y2_d_x3    d_y3_d_x3     d_y4_d_x3     d_y5_d_x3
1  -0.1839871588  0.16984714 0.0064428469  0.0000372842 -3.779886e-03
5  -0.0003010291 -0.15283562 0.0125210424 -0.0459898976  1.382236e-01
10  0.1173593109  0.03113327 0.0001387187  0.0133584446  6.167763e-05

, , d_y3_d_x1

      d_y1_d_x1     d_y2_d_x1    d_y3_d_x1     d_y4_d_x1     d_y5_d_x1
1   0.046417164  1.441998e-02 6.675280e-02 -0.0012667456 -3.319975e-02
5  -0.006289361  1.133995e-01 4.966058e-01 -0.0071332395  1.875787e-02
10  0.001242507 -3.859274e-05 7.615531e-06 -0.0007212926  3.307953e-07
      d_y1_d_x2     d_y2_d_x2     d_y3_d_x2    d_y4_d_x2     d_y5_d_x2
1  -0.097189898 -1.547897e-02 -3.534916e-02 5.618262e-05 -1.185257e-01
5   0.001954739 -2.456734e-02 -1.078305e-01 1.404683e-01 -3.526820e-02
10 -0.001547044  5.012529e-05 -5.255816e-05 1.071977e-03 -1.365147e-06
      d_y1_d_x3     d_y2_d_x3    d_y3_d_x3     d_y4_d_x3     d_y5_d_x3
1  -0.109974904  3.411655e-02 3.571407e-02 -0.0001090872  1.661920e-01
5  -0.001263175  4.917071e-02 8.172094e-02 -0.2028263113  5.077968e-02
10 -0.001190609 -6.657929e-05 3.802431e-05 -0.0002341085 -2.149330e-06

, , d_y4_d_x1

      d_y1_d_x1     d_y2_d_x1     d_y3_d_x1    d_y4_d_x1     d_y5_d_x1
1   0.000319013 -0.0001593828 -0.0012667456 9.883137e-05  0.0006512071
5  -0.012018177 -0.0422548363 -0.0071332395 4.199896e-01  0.0019320785
10 -0.785882468  0.0606982137 -0.0007212926 5.208348e-01 -0.0004198399
       d_y1_d_x2     d_y2_d_x2     d_y3_d_x2     d_y4_d_x2    d_y5_d_x2
1  -0.0002012603 -5.475040e-06  0.0006169524  5.657636e-07 0.0022985514
5   0.0006971247 -1.094587e-02 -0.0521479623 -9.785600e-02 0.0011741555
10  1.0208027387 -1.333962e-01  0.0027983441 -7.372827e-01 0.0006391278
       d_y1_d_x3     d_y2_d_x3     d_y3_d_x3    d_y4_d_x3     d_y5_d_x3
1  -9.369496e-04 -0.0001322694 -0.0006330799 6.436267e-06 -0.0033054396
5   3.049561e-06  0.0142029011  0.0368906017 1.493507e-01 -0.0173089223
10  7.721392e-01  0.0967230842 -0.0009182218 1.282003e-01  0.0001785229

, , d_y5_d_x1

      d_y1_d_x1     d_y2_d_x1     d_y3_d_x1     d_y4_d_x1    d_y5_d_x1
1  -0.020617448 -1.836871e-03 -3.319975e-02  0.0006512071 3.615356e-02
5  -0.004297131 -8.146955e-02  1.875787e-02  0.0019320785 2.114720e-01
10  0.001406431 -4.583743e-05  3.307953e-07 -0.0004198399 7.352687e-07
       d_y1_d_x2     d_y2_d_x2     d_y3_d_x2     d_y4_d_x2     d_y5_d_x2
1   0.0460524054 -9.802405e-03  2.154188e-02 -0.0000178370  1.090336e-01
5   0.0004984711 -2.695158e-02 -4.124495e-03  0.0190910706  2.393598e-01
10 -0.0017023636  6.446571e-05  1.430982e-06  0.0004839676 -7.609887e-07
       d_y1_d_x3     d_y2_d_x3     d_y3_d_x3     d_y4_d_x3     d_y5_d_x3
1   3.129019e-02  9.151215e-03 -2.146644e-02  1.785144e-04 -1.550531e-01
5  -4.909891e-05  8.695246e-02  2.788469e-03 -4.923449e-02 -4.241336e-01
10 -1.255879e-03 -7.922065e-05 -2.291922e-06 -9.587962e-05 -2.705166e-07

, , d_y1_d_x2

       d_y1_d_x1     d_y2_d_x1    d_y3_d_x1     d_y4_d_x1     d_y5_d_x1
1  -1.1170099986 -0.0376041694 -0.097189898 -0.0002012603  0.0460524054
5  -0.0003525852 -0.0002065744  0.001954739  0.0006971247  0.0004984711
10 -4.2021352220  0.1543604560 -0.001547044  1.0208027387 -0.0017023636
      d_y1_d_x2     d_y2_d_x2     d_y3_d_x2     d_y4_d_x2    d_y5_d_x2
1  1.974723e+00  0.1871248572  0.0557213457 -0.0003702223 0.1700731634
5  2.825108e-05 -0.0007961948 -0.0005333439  0.0006351994 0.0005126856
10 5.236088e+00 -0.2746820274  0.0002112791 -1.0991677378 0.0020055556
       d_y1_d_x3    d_y2_d_x3     d_y3_d_x3     d_y4_d_x3    d_y5_d_x3
1   2.469054e+00 -0.516112001 -0.0458768834 -0.0001735494 -0.159596754
5  -3.599178e-06  0.001425139  0.0003976599 -0.0009481553 -0.000730855
10  3.766783e+00  0.250320653  0.0031697541  0.2140081906  0.001922799

, , d_y2_d_x2

      d_y1_d_x1   d_y2_d_x1     d_y3_d_x1     d_y4_d_x1     d_y5_d_x1
1  -0.153363371 -0.13975251 -1.547897e-02 -5.475040e-06 -9.802405e-03
5   0.005832674  0.09598809 -2.456734e-02 -1.094587e-02 -2.695158e-02
10  0.175587394 -0.05363025  5.012529e-05 -1.333962e-01  6.446571e-05
       d_y1_d_x2 d_y2_d_x2    d_y3_d_x2     d_y4_d_x2     d_y5_d_x2
1   0.1871248572 0.2683921 0.0102073199 -0.0003528427 -0.0310341216
5  -0.0007961948 0.2356612 0.0079164349  0.0043018973 -0.0670692808
10 -0.2746820274 0.1493931 0.0001814068  0.1748598429 -0.0000909401
       d_y1_d_x3   d_y2_d_x3     d_y3_d_x3     d_y4_d_x3     d_y5_d_x3
1   0.4794858422 -0.35464851 -0.0096880316 -0.0001053869  0.0481493995
5   0.0003065587 -0.29872832 -0.0057132265  0.0082371300  0.0928689459
10 -0.2012653861 -0.07734838 -0.0003229588 -0.0251464104 -0.0002002089

, , d_y3_d_x2

       d_y1_d_x1     d_y2_d_x1     d_y3_d_x1     d_y4_d_x1     d_y5_d_x1
1  -0.0284878247 -6.133919e-03 -3.534916e-02  0.0006169524  2.154188e-02
5   0.0017104969 -1.646091e-02 -1.078305e-01 -0.0521479623 -4.124495e-03
10  0.0002986687 -6.815757e-05 -5.255816e-05  0.0027983441  1.430982e-06
       d_y1_d_x2    d_y2_d_x2   d_y3_d_x2     d_y4_d_x2    d_y5_d_x2
1   0.0557213457 0.0102073199 0.022719902 -4.766734e-05 7.166095e-02
5  -0.0005333439 0.0079164349 0.032171399 -2.481046e-02 8.734120e-03
10  0.0002112791 0.0001814068 0.000391842 -5.597816e-03 7.481853e-06
      d_y1_d_x3     d_y2_d_x3     d_y3_d_x3    d_y4_d_x3     d_y5_d_x3
1  0.0635676138 -2.275592e-02 -0.0230519977 5.309847e-05 -0.0994244408
5  0.0003013202 -1.102040e-02 -0.0240071574 3.485648e-02 -0.0118637531
10 0.0003261077 -9.649833e-05 -0.0002866523 1.024958e-03  0.0000142981

, , d_y4_d_x2

      d_y1_d_x1     d_y2_d_x1    d_y3_d_x1     d_y4_d_x1     d_y5_d_x1
1  0.0002824941  0.0001457757 5.618262e-05  5.657636e-07 -0.0000178370
5  0.0071225596  0.0668534844 1.404683e-01 -9.785600e-02  0.0190910706
10 0.6978450820 -0.0716015017 1.071977e-03 -7.372827e-01  0.0004839676
       d_y1_d_x2     d_y2_d_x2     d_y3_d_x2    d_y4_d_x2     d_y5_d_x2
1  -0.0003702223 -0.0003528427 -4.766734e-05 3.106140e-06 -0.0001160612
5   0.0006351994  0.0043018973 -2.481046e-02 3.203988e-01 -0.0020510445
10 -1.0991677378  0.1748598429 -5.597816e-03 1.251148e+00 -0.0011090938
      d_y1_d_x3     d_y2_d_x3    d_y3_d_x3     d_y4_d_x3     d_y5_d_x3
1  -0.000703516  0.0005126363 4.322962e-05  6.409495e-07  9.497762e-05
5  -0.001049894 -0.0079799536 1.922154e-02 -3.576048e-01  3.434053e-03
10 -0.790915067 -0.1076341029 2.183402e-03 -1.507556e-01 -1.568138e-04

, , d_y5_d_x2

      d_y1_d_x1     d_y2_d_x1     d_y3_d_x1    d_y4_d_x1     d_y5_d_x1
1  -0.074562197  2.409118e-03 -1.185257e-01 0.0022985514  1.090336e-01
5  -0.004608448 -8.824679e-02 -3.526820e-02 0.0011741555  2.393598e-01
10 -0.001535983  5.614674e-05 -1.365147e-06 0.0006391278 -7.609887e-07
      d_y1_d_x2     d_y2_d_x2    d_y3_d_x2     d_y4_d_x2    d_y5_d_x2
1  0.1700731634 -0.0310341216 7.166095e-02 -0.0001160612 3.800835e-01
5  0.0005126856 -0.0670692808 8.734120e-03 -0.0020510445 3.511832e-01
10 0.0020055556 -0.0000909401 7.481853e-06 -0.0011090938 3.685460e-06
     d_y1_d_x3    d_y2_d_x3     d_y3_d_x3     d_y4_d_x3     d_y5_d_x3
1  0.114945502 2.001096e-02 -7.073396e-02  5.159613e-04 -5.234320e-01
5  0.000207643 1.192963e-01 -6.908203e-03 -2.542701e-02 -5.647922e-01
10 0.001482085 8.997328e-05 -1.380507e-06  1.446759e-05  5.176900e-07

, , d_y1_d_x3

       d_y1_d_x1     d_y2_d_x1    d_y3_d_x1     d_y4_d_x1     d_y5_d_x1
1  -1.515444e+00 -0.1839871588 -0.109974904 -9.369496e-04  3.129019e-02
5  -7.923244e-05 -0.0003010291 -0.001263175  3.049561e-06 -4.909891e-05
10 -3.100452e+00  0.1173593109 -0.001190609  7.721392e-01 -1.255879e-03
       d_y1_d_x2     d_y2_d_x2    d_y3_d_x2    d_y4_d_x2   d_y5_d_x2
1   2.469054e+00  0.4794858422 0.0635676138 -0.000703516 0.114945502
5  -3.599178e-06  0.0003065587 0.0003013202 -0.001049894 0.000207643
10  3.766783e+00 -0.2012653861 0.0003261077 -0.790915067 0.001482085
      d_y1_d_x3     d_y2_d_x3     d_y3_d_x3     d_y4_d_x3     d_y5_d_x3
1  3.637207e+00 -0.8582576523 -0.0506684343 -0.0003464332 -0.0847241658
5  1.272038e-05 -0.0004383232 -0.0002270194  0.0011134525 -0.0002726007
10 2.833315e+00  0.1852110001  0.0019909247  0.1436159750  0.0011794210

, , d_y2_d_x3

     d_y1_d_x1   d_y2_d_x1     d_y3_d_x1     d_y4_d_x1     d_y5_d_x1
1   0.31906917  0.16984714  3.411655e-02 -0.0001322694  9.151215e-03
5  -0.01583947 -0.15283562  4.917071e-02  0.0142029011  8.695246e-02
10 -0.20033565  0.03113327 -6.657929e-05  0.0967230842 -7.922065e-05
      d_y1_d_x2   d_y2_d_x2     d_y3_d_x2     d_y4_d_x2    d_y5_d_x2
1  -0.516112001 -0.35464851 -2.275592e-02  0.0005126363 2.001096e-02
5   0.001425139 -0.29872832 -1.102040e-02 -0.0079799536 1.192963e-01
10  0.250320653 -0.07734838 -9.649833e-05 -0.1076341029 8.997328e-05
       d_y1_d_x3  d_y2_d_x3    d_y3_d_x3    d_y4_d_x3     d_y5_d_x3
1  -0.8582576523 0.60859800 0.0233963835 0.0003409112 -6.117913e-02
5  -0.0004383232 0.88562707 0.0083625850 0.0068240228 -3.542473e-01
10  0.1852110001 0.04942294 0.0002271727 0.0270297857  9.826326e-05

, , d_y3_d_x3

      d_y1_d_x1    d_y2_d_x1    d_y3_d_x1     d_y4_d_x1     d_y5_d_x1
1   0.020875013 0.0064428469 3.571407e-02 -0.0006330799 -2.146644e-02
5  -0.001202905 0.0125210424 8.172094e-02  0.0368906017  2.788469e-03
10 -0.002451212 0.0001387187 3.802431e-05 -0.0009182218 -2.291922e-06
       d_y1_d_x2     d_y2_d_x2     d_y3_d_x2    d_y4_d_x2     d_y5_d_x2
1  -0.0458768834 -0.0096880316 -0.0230519977 4.322962e-05 -7.073396e-02
5   0.0003976599 -0.0057132265 -0.0240071574 1.922154e-02 -6.908203e-03
10  0.0031697541 -0.0003229588 -0.0002866523 2.183402e-03 -1.380507e-06
       d_y1_d_x3    d_y2_d_x3    d_y3_d_x3     d_y4_d_x3     d_y5_d_x3
1  -0.0506684343 0.0233963835 0.0241718379 -5.340161e-05  1.004109e-01
5  -0.0002270194 0.0083625850 0.0179845742 -2.886639e-02  9.646068e-03
10  0.0019909247 0.0002271727 0.0002233462 -6.586357e-04 -3.858023e-06

, , d_y4_d_x3

       d_y1_d_x1     d_y2_d_x1     d_y3_d_x1    d_y4_d_x1     d_y5_d_x1
1   0.0001066799  0.0000372842 -0.0001090872 6.436267e-06  1.785144e-04
5  -0.0073401196 -0.0459898976 -0.2028263113 1.493507e-01 -4.923449e-02
10 -0.1944697181  0.0133584446 -0.0002341085 1.282003e-01 -9.587962e-05
       d_y1_d_x2     d_y2_d_x2    d_y3_d_x2     d_y4_d_x2     d_y5_d_x2
1  -0.0001735494 -0.0001053869 5.309847e-05  6.409495e-07  5.159613e-04
5  -0.0009481553  0.0082371300 3.485648e-02 -3.576048e-01 -2.542701e-02
10  0.2140081906 -0.0251464104 1.024958e-03 -1.507556e-01  1.446759e-05
       d_y1_d_x3    d_y2_d_x3     d_y3_d_x3    d_y4_d_x3     d_y5_d_x3
1  -0.0003464332 0.0003409112 -5.340161e-05 4.141520e-06 -9.136381e-04
5   0.0011134525 0.0068240228 -2.886639e-02 5.847638e-01  1.461852e-02
10  0.1436159750 0.0270297857 -6.586357e-04 7.394479e-02 -5.813227e-05

, , d_y5_d_x3

      d_y1_d_x1     d_y2_d_x1     d_y3_d_x1     d_y4_d_x1     d_y5_d_x1
1   0.063899927 -3.779886e-03  1.661920e-01 -0.0033054396 -1.550531e-01
5   0.009733010  1.382236e-01  5.077968e-02 -0.0173089223 -4.241336e-01
10 -0.001137893  6.167763e-05 -2.149330e-06  0.0001785229 -2.705166e-07
      d_y1_d_x2     d_y2_d_x2     d_y3_d_x2     d_y4_d_x2     d_y5_d_x2
1  -0.159596754  0.0481493995 -0.0994244408  9.497762e-05 -5.234320e-01
5  -0.000730855  0.0928689459 -0.0118637531  3.434053e-03 -5.647922e-01
10  0.001922799 -0.0002002089  0.0000142981 -1.568138e-04  5.176900e-07
       d_y1_d_x3     d_y2_d_x3     d_y3_d_x3     d_y4_d_x3    d_y5_d_x3
1  -0.0847241658 -6.117913e-02  1.004109e-01 -9.136381e-04 7.587378e-01
5  -0.0002726007 -3.542473e-01  9.646068e-03  1.461852e-02 1.177016e+00
10  0.0011794210  9.826326e-05 -3.858023e-06 -5.813227e-05 9.811458e-06

> print( drop( attr( margEffCondV, "vcov" )[ 1, , ] ) )
              d_y1_d_x1     d_y2_d_x1     d_y3_d_x1     d_y4_d_x1     d_y5_d_x1
d_y1_d_x1  0.6812096581  0.0328445706  4.641716e-02  3.190130e-04 -0.0206174479
d_y2_d_x1  0.0328445706  0.1337634570  1.441998e-02 -1.593828e-04 -0.0018368715
d_y3_d_x1  0.0464171645  0.0144199770  6.675280e-02 -1.266746e-03 -0.0331997504
d_y4_d_x1  0.0003190130 -0.0001593828 -1.266746e-03  9.883137e-05  0.0006512071
d_y5_d_x1 -0.0206174479 -0.0018368715 -3.319975e-02  6.512071e-04  0.0361535596
d_y1_d_x2 -1.1170099986 -0.0376041694 -9.718990e-02 -2.012603e-04  0.0460524054
d_y2_d_x2 -0.1533633705 -0.1397525080 -1.547897e-02 -5.475040e-06 -0.0098024052
d_y3_d_x2 -0.0284878247 -0.0061339192 -3.534916e-02  6.169524e-04  0.0215418797
d_y4_d_x2  0.0002824941  0.0001457757  5.618262e-05  5.657636e-07 -0.0000178370
d_y5_d_x2 -0.0745621968  0.0024091179 -1.185257e-01  2.298551e-03  0.1090335607
d_y1_d_x3 -1.5154443756 -0.1839871588 -1.099749e-01 -9.369496e-04  0.0312901857
d_y2_d_x3  0.3190691662  0.1698471445  3.411655e-02 -1.322694e-04  0.0091512152
d_y3_d_x3  0.0208750130  0.0064428469  3.571407e-02 -6.330799e-04 -0.0214664382
d_y4_d_x3  0.0001066799  0.0000372842 -1.090872e-04  6.436267e-06  0.0001785144
d_y5_d_x3  0.0638999270 -0.0037798863  1.661920e-01 -3.305440e-03 -0.1550531013
              d_y1_d_x2     d_y2_d_x2     d_y3_d_x2     d_y4_d_x2     d_y5_d_x2
d_y1_d_x1 -1.1170099986 -1.533634e-01 -2.848782e-02  2.824941e-04 -0.0745621968
d_y2_d_x1 -0.0376041694 -1.397525e-01 -6.133919e-03  1.457757e-04  0.0024091179
d_y3_d_x1 -0.0971898976 -1.547897e-02 -3.534916e-02  5.618262e-05 -0.1185257470
d_y4_d_x1 -0.0002012603 -5.475040e-06  6.169524e-04  5.657636e-07  0.0022985514
d_y5_d_x1  0.0460524054 -9.802405e-03  2.154188e-02 -1.783700e-05  0.1090335607
d_y1_d_x2  1.9747234935  1.871249e-01  5.572135e-02 -3.702223e-04  0.1700731634
d_y2_d_x2  0.1871248572  2.683921e-01  1.020732e-02 -3.528427e-04 -0.0310341216
d_y3_d_x2  0.0557213457  1.020732e-02  2.271990e-02 -4.766734e-05  0.0716609451
d_y4_d_x2 -0.0003702223 -3.528427e-04 -4.766734e-05  3.106140e-06 -0.0001160612
d_y5_d_x2  0.1700731634 -3.103412e-02  7.166095e-02 -1.160612e-04  0.3800834730
d_y1_d_x3  2.4690544160  4.794858e-01  6.356761e-02 -7.035160e-04  0.1149455018
d_y2_d_x3 -0.5161120007 -3.546485e-01 -2.275592e-02  5.126363e-04  0.0200109568
d_y3_d_x3 -0.0458768834 -9.688032e-03 -2.305200e-02  4.322962e-05 -0.0707339554
d_y4_d_x3 -0.0001735494 -1.053869e-04  5.309847e-05  6.409495e-07  0.0005159613
d_y5_d_x3 -0.1595967539  4.814940e-02 -9.942444e-02  9.497762e-05 -0.5234319680
              d_y1_d_x3     d_y2_d_x3     d_y3_d_x3     d_y4_d_x3     d_y5_d_x3
d_y1_d_x1 -1.5154443756  0.3190691662  2.087501e-02  1.066799e-04  6.389993e-02
d_y2_d_x1 -0.1839871588  0.1698471445  6.442847e-03  3.728420e-05 -3.779886e-03
d_y3_d_x1 -0.1099749042  0.0341165538  3.571407e-02 -1.090872e-04  1.661920e-01
d_y4_d_x1 -0.0009369496 -0.0001322694 -6.330799e-04  6.436267e-06 -3.305440e-03
d_y5_d_x1  0.0312901857  0.0091512152 -2.146644e-02  1.785144e-04 -1.550531e-01
d_y1_d_x2  2.4690544160 -0.5161120007 -4.587688e-02 -1.735494e-04 -1.595968e-01
d_y2_d_x2  0.4794858422 -0.3546485053 -9.688032e-03 -1.053869e-04  4.814940e-02
d_y3_d_x2  0.0635676138 -0.0227559160 -2.305200e-02  5.309847e-05 -9.942444e-02
d_y4_d_x2 -0.0007035160  0.0005126363  4.322962e-05  6.409495e-07  9.497762e-05
d_y5_d_x2  0.1149455018  0.0200109568 -7.073396e-02  5.159613e-04 -5.234320e-01
d_y1_d_x3  3.6372067073 -0.8582576523 -5.066843e-02 -3.464332e-04 -8.472417e-02
d_y2_d_x3 -0.8582576523  0.6085980039  2.339638e-02  3.409112e-04 -6.117913e-02
d_y3_d_x3 -0.0506684343  0.0233963835  2.417184e-02 -5.340161e-05  1.004109e-01
d_y4_d_x3 -0.0003464332  0.0003409112 -5.340161e-05  4.141520e-06 -9.136381e-04
d_y5_d_x3 -0.0847241658 -0.0611791284  1.004109e-01 -9.136381e-04  7.587378e-01
> summary( margEffCondV )
               Estimate Std. error z value Pr(> z)
1: d_y1_d_x1  9.926e-02  8.254e-01   0.120   0.904
1: d_y2_d_x1 -4.111e-02  3.657e-01  -0.112   0.911
1: d_y3_d_x1  2.911e-02  2.584e-01   0.113   0.910
1: d_y4_d_x1 -2.673e-04  9.941e-03  -0.027   0.979
1: d_y5_d_x1 -2.011e-02  1.901e-01  -0.106   0.916
1: d_y1_d_x2 -1.531e-01  1.405e+00  -0.109   0.913
1: d_y2_d_x2  7.794e-02  5.181e-01   0.150   0.880
1: d_y3_d_x2 -1.945e-02  1.507e-01  -0.129   0.897
1: d_y4_d_x2  2.593e-05  1.762e-03   0.015   0.988
1: d_y5_d_x2 -1.090e-01  6.165e-01  -0.177   0.860
1: d_y1_d_x3 -3.632e-01  1.907e+00  -0.190   0.849
1: d_y2_d_x3 -8.944e-02  7.801e-01  -0.115   0.909
1: d_y3_d_x3  1.977e-02  1.555e-01   0.127   0.899
1: d_y4_d_x3  1.591e-05  2.035e-03   0.008   0.994
1: d_y5_d_x3  1.420e-01  8.711e-01   0.163   0.870
2: d_y1_d_x1  7.491e-03  9.708e-02   0.077   0.938
2: d_y2_d_x1 -1.645e-01  4.973e-01  -0.331   0.741
2: d_y3_d_x1  1.451e-01  7.047e-01   0.206   0.837
2: d_y4_d_x1 -5.361e-01  6.481e-01  -0.827   0.408
2: d_y5_d_x1 -6.524e-02  4.599e-01  -0.142   0.887
2: d_y1_d_x2  6.220e-05  5.315e-03   0.012   0.991
2: d_y2_d_x2  2.744e-01  4.854e-01   0.565   0.572
2: d_y3_d_x2 -8.325e-03  1.794e-01  -0.046   0.963
2: d_y4_d_x2  2.081e-01  5.660e-01   0.368   0.713
2: d_y5_d_x2 -2.375e-01  5.926e-01  -0.401   0.689
2: d_y1_d_x3 -1.089e-04  3.567e-03  -0.031   0.976
2: d_y2_d_x3 -5.189e-01  9.411e-01  -0.551   0.581
2: d_y3_d_x3  6.280e-03  1.341e-01   0.047   0.963
2: d_y4_d_x3 -2.654e-01  7.647e-01  -0.347   0.729
2: d_y5_d_x3  3.941e-01  1.085e+00   0.363   0.716
3: d_y1_d_x1  1.968e-01  1.883e+00   0.105   0.917
3: d_y2_d_x1 -2.120e-02  1.443e-01  -0.147   0.883
3: d_y3_d_x1  1.604e-04  2.760e-03   0.058   0.954
3: d_y4_d_x1 -1.187e-01  7.217e-01  -0.164   0.869
3: d_y5_d_x1  7.608e-05  8.575e-04   0.089   0.929
3: d_y1_d_x2 -5.544e-01  2.288e+00  -0.242   0.809
3: d_y2_d_x2  6.643e-02  3.865e-01   0.172   0.864
3: d_y3_d_x2 -8.285e-04  1.980e-02  -0.042   0.967
3: d_y4_d_x2  2.539e-01  1.119e+00   0.227   0.820
3: d_y5_d_x2 -2.282e-04  1.920e-03  -0.119   0.905
3: d_y1_d_x3 -1.859e-01  1.683e+00  -0.110   0.912
3: d_y2_d_x3 -4.826e-02  2.223e-01  -0.217   0.828
3: d_y3_d_x3  3.932e-04  1.494e-02   0.026   0.979
3: d_y4_d_x3 -1.184e-01  2.719e-01  -0.435   0.663
3: d_y5_d_x3 -6.966e-05  3.132e-03  -0.022   0.982
> 
> # calculating marginal effects, conditional
> # (assuming that all other dependent variables are as observed)
> margEffCondObs <- mvProbitMargEff( cbind( y1, y2, y3, y4, y5 ) ~ x1 + x2 + x3,
+    coef = c( beta ), sigma = sigma, data = as.data.frame( cbind( xMat, yMat ) ), 
+    cond = TRUE )
> print( margEffCondObs )
    d_y1_d_x1    d_y2_d_x1     d_y3_d_x1   d_y4_d_x1    d_y5_d_x1    d_y1_d_x2
1  0.38665968 -0.086982861  1.363019e-01 -0.36712086 -0.106556150 -0.494710060
2  0.25441122 -0.123346802  4.215393e-01 -0.12791370 -0.070388217 -0.236463141
3  0.53174011 -0.176879617  4.216246e-01 -0.73033353  0.024004318 -0.412603092
4  0.17898502 -0.140762172  4.970210e-01 -0.60399264  0.150538333 -0.036229164
5  0.02351233 -0.103909568  2.577994e-01 -0.38625024 -0.038057072 -0.004816663
6  0.30780492 -0.011892250  7.401735e-03 -0.12137112 -0.021925728 -0.237890323
7  0.07992447 -0.029707944  3.315591e-01 -0.31694874 -0.068375725 -0.176741135
8  0.08155087 -0.020508926  3.633985e-04 -0.07978801 -0.012825935 -0.184988432
9  0.19320556 -0.095048431  3.587516e-01 -0.52664682 -0.095601525 -0.393952135
10 0.52244762 -0.001558889 -8.811116e-05 -0.05065797 -0.004324226 -0.406170426
     d_y2_d_x2     d_y3_d_x2  d_y4_d_x2    d_y5_d_x2   d_y1_d_x3    d_y2_d_x3
1  0.064752685 -0.0794618801 0.09748031 -0.231719997 -0.47661967 -0.050278488
2  0.305151591 -0.8072288592 0.50211307 -0.477711823 -0.14726313 -0.374513309
3  0.222294024 -0.7165728464 0.44307519 -0.295276270 -0.37840014 -0.326479320
4  0.236440301 -0.6882505141 0.47040241 -0.599430291 -0.02708360 -0.415869353
5  0.177253207 -0.2179098189 0.13565753 -0.339571429 -0.00249556 -0.321244284
6  0.030011972 -0.0282737934 0.16990098 -0.013512968 -0.22691510 -0.031253663
7  0.034526629 -0.2797232530 0.07204689 -0.189716053 -0.20417044 -0.041758224
8  0.043465496 -0.0039813266 0.09720844 -0.007732507 -0.22971405 -0.071289981
9  0.141375416 -0.2360392806 0.22050272 -0.336321419 -0.31217807 -0.136455242
10 0.006340279  0.0001769029 0.07806165 -0.002740800 -0.33974070 -0.004736787
       d_y3_d_x3   d_y4_d_x3   d_y5_d_x3
1   0.0766180194 -0.03653098 0.343978346
2   0.6998115009 -0.42115012 0.616908811
3   0.5898997978 -0.34928550 0.356894349
4   0.5314965845 -0.51916055 0.775034274
5   0.1453066487 -0.19712872 0.511189076
6   0.0201361727 -0.11025144 0.020705656
7   0.2078920661 -0.05152273 0.272450182
8   0.0029102992 -0.11236499 0.011243764
9   0.1997825314 -0.12718212 0.473423879
10 -0.0002166247 -0.07032604 0.004095378
> margEffCondObsA <- mvProbitMargEff( cbind( y1, y2, y3, y4, y5 ) ~ x1 + x2 + x3,
+    coef = allCoef, data = as.data.frame( cbind( xMat, yMat ) ), cond = TRUE )
> all.equal( margEffCondObs, margEffCondObsA )
[1] TRUE
> # now with variance covariance matrix
> margEffCondObsV <- mvProbitMargEff( cbind( y1, y2, y3, y4, y5 ) ~ x1 + x2 + x3, 
+    coef = allCoef, data = as.data.frame( cbind( xMat, yMat ) )[ c(1,5,10), ], 
+    cond = TRUE, vcov = diag( 30 ) )
> print( attr( margEffCondObsV, "vcov" ) )
, , d_y1_d_x1

    d_y1_d_x1    d_y2_d_x1     d_y3_d_x1     d_y4_d_x1    d_y5_d_x1  d_y1_d_x2
1  0.30295427 -0.017218365 -0.0068724138 -0.0007987828 -0.016039859 -0.1383134
5  0.09454287 -0.049296237 -0.0580552882 -0.0343232969 -0.007904557 -0.0214042
10 0.62644588  0.004432102 -0.0003387511  0.0276848048  0.002067240 -0.6896848
     d_y2_d_x2     d_y3_d_x2    d_y4_d_x2     d_y5_d_x2   d_y1_d_x3   d_y2_d_x3
1  -0.05255557 -0.0172556978 -0.076886370  0.0178037257  0.04538994  0.06386493
5   0.02953443  0.0593663979  0.005981976 -0.0250309641 -0.01740497 -0.05094591
10 -0.01036359  0.0003472886  0.008987026  0.0008742556 -0.32562771  0.01393068
       d_y3_d_x3   d_y4_d_x3     d_y5_d_x3
1   0.0322194091  0.06918336  0.0401822598
5  -0.0153669580 -0.01134939  0.0321590474
10  0.0002210352  0.07239984 -0.0004507591

, , d_y2_d_x1

      d_y1_d_x1    d_y2_d_x1    d_y3_d_x1    d_y4_d_x1     d_y5_d_x1
1  -0.017218365 0.1950255753 6.227196e-02  0.040139738 -1.099614e-02
5  -0.049296237 0.2929895650 3.153824e-01 -0.201184137 -4.192393e-02
10  0.004432102 0.0005037651 7.202316e-06  0.000641001  2.136184e-05
      d_y1_d_x2    d_y2_d_x2     d_y3_d_x2    d_y4_d_x2    d_y5_d_x2
1   0.039189147 -0.093972676 -0.0294064984 -0.005908228 1.655352e-02
5   0.008993618 -0.068282327 -0.1955487152  0.088124027 6.722108e-02
10 -0.009250886 -0.001511076 -0.0000133452 -0.000132677 1.901698e-05
      d_y1_d_x3   d_y2_d_x3    d_y3_d_x3    d_y4_d_x3     d_y5_d_x3
1  -0.046847515 0.082683245 3.570318e-02 -0.004980139 -1.809210e-02
5   0.006179826 0.136272296 9.527944e-02 -0.081240920 -9.552820e-02
10 -0.004928011 0.001376734 5.782277e-06  0.001039106 -2.920672e-05

, , d_y3_d_x1

       d_y1_d_x1    d_y2_d_x1    d_y3_d_x1     d_y4_d_x1     d_y5_d_x1
1  -0.0068724138 6.227196e-02 3.451190e-01 -2.529480e-01  2.723144e-02
5  -0.0580552882 3.153824e-01 1.139623e+00 -7.595576e-01 -1.068731e-01
10 -0.0003387511 7.202316e-06 9.808412e-07 -1.692167e-06 -1.967879e-05
      d_y1_d_x2     d_y2_d_x2     d_y3_d_x2     d_y4_d_x2     d_y5_d_x2
1  0.0150414590 -3.107830e-02 -1.382929e-01  0.0641579423 -2.966109e-02
5  0.0204099285 -1.531142e-01 -7.162734e-01  0.2431820092  1.529955e-01
10 0.0004251417 -2.559588e-05 -1.928570e-06 -0.0000236681 -5.097736e-06
       d_y1_d_x3    d_y2_d_x3    d_y3_d_x3     d_y4_d_x3     d_y5_d_x3
1  -0.0193473530 2.738655e-02 1.391779e-01 -2.736740e-02  3.706396e-02
5   0.0083304744 1.866326e-01 3.859441e-01 -2.914875e-01 -1.064646e-01
10  0.0001785728 1.698416e-05 6.994238e-08 -3.559623e-05  9.113142e-06

, , d_y4_d_x1

       d_y1_d_x1    d_y2_d_x1     d_y3_d_x1  d_y4_d_x1    d_y5_d_x1
1  -0.0007987828  0.040139738 -2.529480e-01 0.70425495 -0.039872968
5  -0.0343232969 -0.201184137 -7.595576e-01 0.84867619  0.128251461
10  0.0276848048  0.000641001 -1.692167e-06 0.03302969  0.000348983
       d_y1_d_x2    d_y2_d_x2    d_y3_d_x2   d_y4_d_x2     d_y5_d_x2
1   0.0262985718 -0.018205401 5.555802e-02 -0.21516084  0.0307721818
5  -0.0004637922  0.096464455 4.065317e-01 -0.23189259 -0.0994806489
10 -0.0987152264 -0.001783926 3.517187e-05 -0.03199315  0.0001512361
      d_y1_d_x3    d_y2_d_x3     d_y3_d_x3  d_y4_d_x3     d_y5_d_x3
1  -0.024073840  0.010967174 -4.830068e-02 0.07237543 -0.0311413870
5   0.003832679 -0.113534048 -2.461694e-01 0.31587511  0.0934604174
10 -0.037074916  0.001745078  4.167755e-05 0.02670624 -0.0001607756

, , d_y5_d_x1

      d_y1_d_x1     d_y2_d_x1     d_y3_d_x1    d_y4_d_x1   d_y5_d_x1
1  -0.016039859 -1.099614e-02  2.723144e-02 -0.039872968 0.126154409
5  -0.007904557 -4.192393e-02 -1.068731e-01  0.128251461 0.278130639
10  0.002067240  2.136184e-05 -1.967879e-05  0.000348983 0.003461298
      d_y1_d_x2     d_y2_d_x2    d_y3_d_x2     d_y4_d_x2   d_y5_d_x2
1  -0.039278177 -6.280071e-03 2.545784e-03  0.0181405886 0.016853304
5   0.002339349 -3.530401e-02 9.741155e-02 -0.0419062682 0.027912583
10 -0.003346591 -5.731697e-05 6.905089e-05 -0.0001565397 0.001152417
      d_y1_d_x3    d_y2_d_x3     d_y3_d_x3     d_y4_d_x3   d_y5_d_x3
1   0.053119568 1.005290e-02 -6.942153e-03 -0.0101508211 -0.16659335
5   0.002820686 8.698162e-02 -3.092974e-02  0.0187493443 -0.07408516
10 -0.001296716 6.654553e-05 -9.539643e-06  0.0003777283 -0.00193953

, , d_y1_d_x2

    d_y1_d_x1    d_y2_d_x1    d_y3_d_x1     d_y4_d_x1    d_y5_d_x1   d_y1_d_x2
1  -0.1383134  0.039189147 0.0150414590  0.0262985718 -0.039278177 0.291177977
5  -0.0214042  0.008993618 0.0204099285 -0.0004637922  0.002339349 0.005552077
10 -0.6896848 -0.009250886 0.0004251417 -0.0987152264 -0.003346591 1.574437745
      d_y2_d_x2     d_y3_d_x2   d_y4_d_x2    d_y5_d_x2    d_y1_d_x3   d_y2_d_x3
1   0.005107012 -0.0144643544 0.005528855  0.014607384 -0.056782048 -0.04874884
5  -0.010760839 -0.0213118539 0.001324393  0.006266058  0.004307612  0.01611268
10  0.022492513 -0.0008757589 0.008220044 -0.001732095  0.666558255 -0.02772171
      d_y3_d_x3    d_y4_d_x3    d_y5_d_x3
1   0.004042485 -0.048487373  0.087555709
5   0.007533227 -0.000744412 -0.006807944
10 -0.001011739 -0.167891457  0.001135488

, , d_y2_d_x2

     d_y1_d_x1    d_y2_d_x1     d_y3_d_x1    d_y4_d_x1     d_y5_d_x1
1  -0.05255557 -0.093972676 -3.107830e-02 -0.018205401 -6.280071e-03
5   0.02953443 -0.068282327 -1.531142e-01  0.096464455 -3.530401e-02
10 -0.01036359 -0.001511076 -2.559588e-05 -0.001783926 -5.731697e-05
      d_y1_d_x2   d_y2_d_x2    d_y3_d_x2     d_y4_d_x2     d_y5_d_x2
1   0.005107012 0.110244618 2.749941e-02  0.0194138669 -2.588727e-02
5  -0.010760839 0.180714382 1.599455e-01 -0.0346698278 -1.066783e-01
10  0.022492513 0.004642658 5.677637e-05  0.0006731947 -4.957895e-05
      d_y1_d_x3    d_y2_d_x3     d_y3_d_x3   d_y4_d_x3    d_y5_d_x3
1   0.006476203 -0.113906067 -3.534361e-02 -0.01057415 3.539023e-02
5  -0.006070839 -0.284445214 -8.144089e-02  0.02866755 1.340898e-01
10  0.012966345 -0.004066292 -1.049699e-05 -0.00266565 9.241127e-05

, , d_y3_d_x2

       d_y1_d_x1     d_y2_d_x1     d_y3_d_x1    d_y4_d_x1    d_y5_d_x1
1  -0.0172556978 -0.0294064984 -1.382929e-01 5.555802e-02 2.545784e-03
5   0.0593663979 -0.1955487152 -7.162734e-01 4.065317e-01 9.741155e-02
10  0.0003472886 -0.0000133452 -1.928570e-06 3.517187e-05 6.905089e-05
       d_y1_d_x2    d_y2_d_x2    d_y3_d_x2     d_y4_d_x2    d_y5_d_x2
1  -0.0144643544 2.749941e-02 9.381961e-02 -9.770203e-03 2.211705e-02
5  -0.0213118539 1.599455e-01 7.965913e-01 -1.864026e-01 1.441386e-02
10 -0.0008757589 5.677637e-05 7.691394e-06  7.102213e-05 2.406026e-05
       d_y1_d_x3     d_y2_d_x3     d_y3_d_x3    d_y4_d_x3     d_y5_d_x3
1   0.0154917683 -0.0249230226 -9.456790e-02 6.043181e-03 -4.177701e-02
5  -0.0081072591 -0.1928801059 -4.446130e-01 1.907910e-01 -5.918194e-02
10 -0.0002265818 -0.0000282544 -1.479114e-07 5.433588e-05 -3.781602e-05

, , d_y4_d_x2

      d_y1_d_x1    d_y2_d_x1     d_y3_d_x1   d_y4_d_x1     d_y5_d_x1
1  -0.076886370 -0.005908228  0.0641579423 -0.21516084  0.0181405886
5   0.005981976  0.088124027  0.2431820092 -0.23189259 -0.0419062682
10  0.008987026 -0.000132677 -0.0000236681 -0.03199315 -0.0001565397
     d_y1_d_x2     d_y2_d_x2     d_y3_d_x2 d_y4_d_x2     d_y5_d_x2
1  0.005528855  0.0194138669 -9.770203e-03 0.1382782 -2.172822e-02
5  0.001324393 -0.0346698278 -1.864026e-01 0.1677309 -1.245736e-02
10 0.008220044  0.0006731947  7.102213e-05 0.0472930 -1.424803e-05
       d_y1_d_x3     d_y2_d_x3    d_y3_d_x3   d_y4_d_x3    d_y5_d_x3
1   6.804295e-04 -0.0165184515 4.516680e-03 -0.06986311 6.527183e-03
5  -2.813429e-04  0.0459561259 1.175557e-01 -0.20154730 1.635767e-02
10 -1.857328e-05 -0.0001786847 8.978994e-05 -0.01834024 9.522645e-05

, , d_y5_d_x2

       d_y1_d_x1    d_y2_d_x1     d_y3_d_x1     d_y4_d_x1   d_y5_d_x1
1   0.0178037257 1.655352e-02 -2.966109e-02  0.0307721818 0.016853304
5  -0.0250309641 6.722108e-02  1.529955e-01 -0.0994806489 0.027912583
10  0.0008742556 1.901698e-05 -5.097736e-06  0.0001512361 0.001152417
      d_y1_d_x2     d_y2_d_x2    d_y3_d_x2     d_y4_d_x2   d_y5_d_x2
1   0.014607384 -2.588727e-02 2.211705e-02 -2.172822e-02 0.100109038
5   0.006266058 -1.066783e-01 1.441386e-02 -1.245736e-02 0.406324786
10 -0.001732095 -4.957895e-05 2.406026e-05 -1.424803e-05 0.000505327
       d_y1_d_x3    d_y2_d_x3     d_y3_d_x3   d_y4_d_x3     d_y5_d_x3
1  -0.0214617714 2.393200e-02 -1.915727e-02 0.012718829 -0.0263552897
5   0.0056383587 1.720444e-01 -5.640484e-02 0.028653454 -0.5080844782
10 -0.0007196538 5.815172e-05 -3.475918e-06 0.000194237 -0.0007682026

, , d_y1_d_x3

     d_y1_d_x1    d_y2_d_x1     d_y3_d_x1    d_y4_d_x1    d_y5_d_x1
1   0.04538994 -0.046847515 -0.0193473530 -0.024073840  0.053119568
5  -0.01740497  0.006179826  0.0083304744  0.003832679  0.002820686
10 -0.32562771 -0.004928011  0.0001785728 -0.037074916 -0.001296716
      d_y1_d_x2    d_y2_d_x2     d_y3_d_x2     d_y4_d_x2     d_y5_d_x2
1  -0.056782048  0.006476203  0.0154917683  6.804295e-04 -0.0214617714
5   0.004307612 -0.006070839 -0.0081072591 -2.813429e-04  0.0056383587
10  0.666558255  0.012966345 -0.0002265818 -1.857328e-05 -0.0007196538
     d_y1_d_x3    d_y2_d_x3    d_y3_d_x3     d_y4_d_x3     d_y5_d_x3
1  0.260357551 -0.004047559 -0.026712748 -1.487848e-02 -0.1120454180
5  0.003732015  0.010155647  0.001616746 -7.774748e-05 -0.0068923394
10 0.346480611 -0.014655095 -0.000476133 -7.828416e-02  0.0005046399

, , d_y2_d_x3

     d_y1_d_x1   d_y2_d_x1    d_y3_d_x1    d_y4_d_x1    d_y5_d_x1   d_y1_d_x2
1   0.06386493 0.082683245 2.738655e-02  0.010967174 1.005290e-02 -0.04874884
5  -0.05094591 0.136272296 1.866326e-01 -0.113534048 8.698162e-02  0.01611268
10  0.01393068 0.001376734 1.698416e-05  0.001745078 6.654553e-05 -0.02772171
      d_y2_d_x2     d_y3_d_x2     d_y4_d_x2    d_y5_d_x2    d_y1_d_x3
1  -0.113906067 -0.0249230226 -0.0165184515 2.393200e-02 -0.004047559
5  -0.284445214 -0.1928801059  0.0459561259 1.720444e-01  0.010155647
10 -0.004066292 -0.0000282544 -0.0001786847 5.815172e-05 -0.014655095
     d_y2_d_x3    d_y3_d_x3    d_y4_d_x3     d_y5_d_x3
1  0.146711525 3.946040e-02  0.012910818 -4.709638e-02
5  0.689288356 1.129715e-01 -0.024984847 -3.679245e-01
10 0.003821778 1.873285e-05  0.003089451 -8.208465e-05

, , d_y3_d_x3

       d_y1_d_x1    d_y2_d_x1    d_y3_d_x1     d_y4_d_x1     d_y5_d_x1
1   0.0322194091 3.570318e-02 1.391779e-01 -4.830068e-02 -6.942153e-03
5  -0.0153669580 9.527944e-02 3.859441e-01 -2.461694e-01 -3.092974e-02
10  0.0002210352 5.782277e-06 6.994238e-08  4.167755e-05 -9.539643e-06
      d_y1_d_x2     d_y2_d_x2     d_y3_d_x2    d_y4_d_x2     d_y5_d_x2
1   0.004042485 -3.534361e-02 -9.456790e-02 4.516680e-03 -1.915727e-02
5   0.007533227 -8.144089e-02 -4.446130e-01 1.175557e-01 -5.640484e-02
10 -0.001011739 -1.049699e-05 -1.479114e-07 8.978994e-05 -3.475918e-06
      d_y1_d_x3    d_y2_d_x3    d_y3_d_x3     d_y4_d_x3    d_y5_d_x3
1  -0.026712748 3.946040e-02 1.139371e-01 -0.0036014358 5.524575e-02
5   0.001616746 1.129715e-01 3.208902e-01 -0.1402377306 1.161786e-01
10 -0.000476133 1.873285e-05 4.289431e-06  0.0001262501 7.223008e-06

, , d_y4_d_x3

     d_y1_d_x1    d_y2_d_x1     d_y3_d_x1  d_y4_d_x1     d_y5_d_x1    d_y1_d_x2
1   0.06918336 -0.004980139 -2.736740e-02 0.07237543 -0.0101508211 -0.048487373
5  -0.01134939 -0.081240920 -2.914875e-01 0.31587511  0.0187493443 -0.000744412
10  0.07239984  0.001039106 -3.559623e-05 0.02670624  0.0003777283 -0.167891457
     d_y2_d_x2    d_y3_d_x2   d_y4_d_x2   d_y5_d_x2     d_y1_d_x3    d_y2_d_x3
1  -0.01057415 6.043181e-03 -0.06986311 0.012718829 -1.487848e-02  0.012910818
5   0.02866755 1.907910e-01 -0.20154730 0.028653454 -7.774748e-05 -0.024984847
10 -0.00266565 5.433588e-05 -0.01834024 0.000194237 -7.828416e-02  0.003089451
       d_y3_d_x3  d_y4_d_x3     d_y5_d_x3
1  -0.0036014358 0.07351530 -0.0034511247
5  -0.1402377306 0.35747536 -0.0627441167
10  0.0001262501 0.03369666 -0.0001214137

, , d_y5_d_x3

       d_y1_d_x1     d_y2_d_x1     d_y3_d_x1     d_y4_d_x1   d_y5_d_x1
1   0.0401822598 -1.809210e-02  3.706396e-02 -0.0311413870 -0.16659335
5   0.0321590474 -9.552820e-02 -1.064646e-01  0.0934604174 -0.07408516
10 -0.0004507591 -2.920672e-05  9.113142e-06 -0.0001607756 -0.00193953
      d_y1_d_x2    d_y2_d_x2     d_y3_d_x2    d_y4_d_x2     d_y5_d_x2
1   0.087555709 3.539023e-02 -4.177701e-02 6.527183e-03 -0.0263552897
5  -0.006807944 1.340898e-01 -5.918194e-02 1.635767e-02 -0.5080844782
10  0.001135488 9.241127e-05 -3.781602e-05 9.522645e-05 -0.0007682026
       d_y1_d_x3     d_y2_d_x3    d_y3_d_x3     d_y4_d_x3   d_y5_d_x3
1  -0.1120454180 -4.709638e-02 5.524575e-02 -0.0034511247 0.472196160
5  -0.0068923394 -3.679245e-01 1.161786e-01 -0.0627441167 1.016385006
10  0.0005046399 -8.208465e-05 7.223008e-06 -0.0001214137 0.001254498

> print( drop( attr( margEffCondObsV, "vcov" )[ 1, , ] ) )
              d_y1_d_x1    d_y2_d_x1    d_y3_d_x1     d_y4_d_x1    d_y5_d_x1
d_y1_d_x1  0.3029542699 -0.017218365 -0.006872414 -0.0007987828 -0.016039859
d_y2_d_x1 -0.0172183652  0.195025575  0.062271955  0.0401397379 -0.010996137
d_y3_d_x1 -0.0068724138  0.062271955  0.345119008 -0.2529480002  0.027231435
d_y4_d_x1 -0.0007987828  0.040139738 -0.252948000  0.7042549520 -0.039872968
d_y5_d_x1 -0.0160398590 -0.010996137  0.027231435 -0.0398729677  0.126154409
d_y1_d_x2 -0.1383134335  0.039189147  0.015041459  0.0262985718 -0.039278177
d_y2_d_x2 -0.0525555653 -0.093972676 -0.031078304 -0.0182054011 -0.006280071
d_y3_d_x2 -0.0172556978 -0.029406498 -0.138292937  0.0555580205  0.002545784
d_y4_d_x2 -0.0768863695 -0.005908228  0.064157942 -0.2151608363  0.018140589
d_y5_d_x2  0.0178037257  0.016553523 -0.029661093  0.0307721818  0.016853304
d_y1_d_x3  0.0453899384 -0.046847515 -0.019347353 -0.0240738398  0.053119568
d_y2_d_x3  0.0638649296  0.082683245  0.027386554  0.0109671744  0.010052904
d_y3_d_x3  0.0322194091  0.035703177  0.139177856 -0.0483006821 -0.006942153
d_y4_d_x3  0.0691833645 -0.004980139 -0.027367402  0.0723754277 -0.010150821
d_y5_d_x3  0.0401822598 -0.018092098  0.037063960 -0.0311413870 -0.166593351
             d_y1_d_x2    d_y2_d_x2    d_y3_d_x2     d_y4_d_x2   d_y5_d_x2
d_y1_d_x1 -0.138313434 -0.052555565 -0.017255698 -0.0768863695  0.01780373
d_y2_d_x1  0.039189147 -0.093972676 -0.029406498 -0.0059082278  0.01655352
d_y3_d_x1  0.015041459 -0.031078304 -0.138292937  0.0641579423 -0.02966109
d_y4_d_x1  0.026298572 -0.018205401  0.055558021 -0.2151608363  0.03077218
d_y5_d_x1 -0.039278177 -0.006280071  0.002545784  0.0181405886  0.01685330
d_y1_d_x2  0.291177977  0.005107012 -0.014464354  0.0055288549  0.01460738
d_y2_d_x2  0.005107012  0.110244618  0.027499411  0.0194138669 -0.02588727
d_y3_d_x2 -0.014464354  0.027499411  0.093819610 -0.0097702029  0.02211705
d_y4_d_x2  0.005528855  0.019413867 -0.009770203  0.1382781832 -0.02172822
d_y5_d_x2  0.014607384 -0.025887266  0.022117050 -0.0217282245  0.10010904
d_y1_d_x3 -0.056782048  0.006476203  0.015491768  0.0006804295 -0.02146177
d_y2_d_x3 -0.048748843 -0.113906067 -0.024923023 -0.0165184515  0.02393200
d_y3_d_x3  0.004042485 -0.035343609 -0.094567898  0.0045166801 -0.01915727
d_y4_d_x3 -0.048487373 -0.010574150  0.006043181 -0.0698631118  0.01271883
d_y5_d_x3  0.087555709  0.035390229 -0.041777013  0.0065271830 -0.02635529
              d_y1_d_x3    d_y2_d_x3    d_y3_d_x3    d_y4_d_x3    d_y5_d_x3
d_y1_d_x1  0.0453899384  0.063864930  0.032219409  0.069183365  0.040182260
d_y2_d_x1 -0.0468475147  0.082683245  0.035703177 -0.004980139 -0.018092098
d_y3_d_x1 -0.0193473530  0.027386554  0.139177856 -0.027367402  0.037063960
d_y4_d_x1 -0.0240738398  0.010967174 -0.048300682  0.072375428 -0.031141387
d_y5_d_x1  0.0531195682  0.010052904 -0.006942153 -0.010150821 -0.166593351
d_y1_d_x2 -0.0567820477 -0.048748843  0.004042485 -0.048487373  0.087555709
d_y2_d_x2  0.0064762029 -0.113906067 -0.035343609 -0.010574150  0.035390229
d_y3_d_x2  0.0154917683 -0.024923023 -0.094567898  0.006043181 -0.041777013
d_y4_d_x2  0.0006804295 -0.016518452  0.004516680 -0.069863112  0.006527183
d_y5_d_x2 -0.0214617714  0.023932000 -0.019157273  0.012718829 -0.026355290
d_y1_d_x3  0.2603575514 -0.004047559 -0.026712748 -0.014878484 -0.112045418
d_y2_d_x3 -0.0040475590  0.146711525  0.039460398  0.012910818 -0.047096383
d_y3_d_x3 -0.0267127485  0.039460398  0.113937145 -0.003601436  0.055245755
d_y4_d_x3 -0.0148784837  0.012910818 -0.003601436  0.073515304 -0.003451125
d_y5_d_x3 -0.1120454180 -0.047096383  0.055245755 -0.003451125  0.472196160
> summary( margEffCondObsV )
               Estimate Std. error z value Pr(> z)
1: d_y1_d_x1  3.867e-01  5.504e-01   0.702   0.482
1: d_y2_d_x1 -8.698e-02  4.416e-01  -0.197   0.844
1: d_y3_d_x1  1.363e-01  5.875e-01   0.232   0.817
1: d_y4_d_x1 -3.671e-01  8.392e-01  -0.437   0.662
1: d_y5_d_x1 -1.066e-01  3.552e-01  -0.300   0.764
1: d_y1_d_x2 -4.947e-01  5.396e-01  -0.917   0.359
1: d_y2_d_x2  6.475e-02  3.320e-01   0.195   0.845
1: d_y3_d_x2 -7.946e-02  3.063e-01  -0.259   0.795
1: d_y4_d_x2  9.748e-02  3.719e-01   0.262   0.793
1: d_y5_d_x2 -2.317e-01  3.164e-01  -0.732   0.464
1: d_y1_d_x3 -4.766e-01  5.103e-01  -0.934   0.350
1: d_y2_d_x3 -5.028e-02  3.830e-01  -0.131   0.896
1: d_y3_d_x3  7.662e-02  3.375e-01   0.227   0.820
1: d_y4_d_x3 -3.653e-02  2.711e-01  -0.135   0.893
1: d_y5_d_x3  3.440e-01  6.872e-01   0.501   0.617
2: d_y1_d_x1  2.351e-02  3.075e-01   0.076   0.939
2: d_y2_d_x1 -1.039e-01  5.413e-01  -0.192   0.848
2: d_y3_d_x1  2.578e-01  1.068e+00   0.241   0.809
2: d_y4_d_x1 -3.863e-01  9.212e-01  -0.419   0.675
2: d_y5_d_x1 -3.806e-02  5.274e-01  -0.072   0.942
2: d_y1_d_x2 -4.817e-03  7.451e-02  -0.065   0.948
2: d_y2_d_x2  1.773e-01  4.251e-01   0.417   0.677
2: d_y3_d_x2 -2.179e-01  8.925e-01  -0.244   0.807
2: d_y4_d_x2  1.357e-01  4.095e-01   0.331   0.740
2: d_y5_d_x2 -3.396e-01  6.374e-01  -0.533   0.594
2: d_y1_d_x3 -2.496e-03  6.109e-02  -0.041   0.967
2: d_y2_d_x3 -3.212e-01  8.302e-01  -0.387   0.699
2: d_y3_d_x3  1.453e-01  5.665e-01   0.257   0.798
2: d_y4_d_x3 -1.971e-01  5.979e-01  -0.330   0.742
2: d_y5_d_x3  5.112e-01  1.008e+00   0.507   0.612
3: d_y1_d_x1  5.224e-01  7.915e-01   0.660   0.509
3: d_y2_d_x1 -1.559e-03  2.244e-02  -0.069   0.945
3: d_y3_d_x1 -8.811e-05  9.904e-04  -0.089   0.929
3: d_y4_d_x1 -5.066e-02  1.817e-01  -0.279   0.780
3: d_y5_d_x1 -4.324e-03  5.883e-02  -0.074   0.941
3: d_y1_d_x2 -4.062e-01  1.255e+00  -0.324   0.746
3: d_y2_d_x2  6.340e-03  6.814e-02   0.093   0.926
3: d_y3_d_x2  1.769e-04  2.773e-03   0.064   0.949
3: d_y4_d_x2  7.806e-02  2.175e-01   0.359   0.720
3: d_y5_d_x2 -2.741e-03  2.248e-02  -0.122   0.903
3: d_y1_d_x3 -3.397e-01  5.886e-01  -0.577   0.564
3: d_y2_d_x3 -4.737e-03  6.182e-02  -0.077   0.939
3: d_y3_d_x3 -2.166e-04  2.071e-03  -0.105   0.917
3: d_y4_d_x3 -7.033e-02  1.836e-01  -0.383   0.702
3: d_y5_d_x3  4.095e-03  3.542e-02   0.116   0.908
> 
> 
